(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     95446,       2324]
NotebookOptionsPosition[     86821,       2205]
NotebookOutlinePosition[     87198,       2221]
CellTagsIndexPosition[     87155,       2218]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "Data", " ", "fetch", " "}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395617607210855`*^9, 
  3.7395617659792604`*^9}},ExpressionUUID->"4a199865-ad68-48b2-81f8-\
86651ddafa89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prepareData", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tx", ",", " ", "tt", ",", " ", "ty", ",", "txT", ",", " ", "ttT", ",", 
       " ", "tyT", ",", " ", "i", ",", " ", "training", ",", " ", "testing"}],
       "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"training", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], 
          ",", "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testing", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", " ", "\"\<MNIST\>\""}], 
           "}"}], ",", " ", "\"\<TestData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"txT", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"testing", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ttT", " ", "=", " ", 
       RowBox[{"testing", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tyT", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "10000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"tyT", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"ttT", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tx", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"training", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "  ", "=", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ty", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ty", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"tt", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"tx", ",", " ", "ty", ",", " ", "txT", ",", " ", "tyT"}], 
        "}"}], "]"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "}"}], " ", "=", " ", 
   RowBox[{"prepareData", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7395617677082987`*^9, 3.7395617699307814`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"529ea0e3-52f7-42db-8042-f3e86c514a8f"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Xavier", " ", "Initialization", " ", "of", " ", "network", " "}], 
  "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561781963962*^9, 
  3.7395617819659567`*^9}},ExpressionUUID->"48868ed5-26c5-4f8b-96a7-\
b27fd0a1a145"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initializeWeights", "[", 
    RowBox[{
    "hiddennodes1_", ",", " ", "hiddennodes2_", ",", " ", "outputnodes_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mininet", ",", " ", "netinit", ",", " ", "w0", ",", " ", "w1", ",", 
       " ", "w2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mininet", " ", "=", " ", 
       RowBox[{"NetChain", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LinearLayer", "[", "hiddennodes1", "]"}], ",", " ", 
           "Ramp", ",", 
           RowBox[{"LinearLayer", "[", "hiddennodes2", "]"}], ",", " ", 
           "Ramp", ",", " ", 
           RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
           "LogisticSigmoid"}], "}"}], ",", " ", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "784"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"netinit", " ", "=", " ", 
       RowBox[{"NetInitialize", "[", 
        RowBox[{"mininet", ",", " ", 
         RowBox[{"Method", " ", "\[Rule]", 
          RowBox[{"{", "\"\<Xavier\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739568987034275*^9, 3.7395689878151846`*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"a7d24f0e-bf08-4162-809b-f7d4b2ad4eb3"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Define", " ", "network", " ", "variables"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561787772089*^9, 
  3.7395617877750673`*^9}},ExpressionUUID->"51044e44-a945-4edf-b266-\
3587b70a19d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningrate", " ", "=", " ", "0.00003"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes1", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes2", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputnodes", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchsize", " ", "=", " ", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"60000", "/", "batchsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilon", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputdim", "  ", "=", " ", "784"}], ";"}]}], "Input",
 CellChangeTimes->{{3.739565612420392*^9, 3.7395656140133944`*^9}, {
   3.7395677842786617`*^9, 3.7395677880326242`*^9}, {3.739567891451046*^9, 
   3.7395678991753798`*^9}, {3.739569188082343*^9, 3.739569191183061*^9}, {
   3.739569346106138*^9, 3.7395693463983707`*^9}, {3.7395696706401925`*^9, 
   3.739569673519461*^9}, {3.7395702306050615`*^9, 3.7395702308244915`*^9}, {
   3.7395704593427057`*^9, 3.7395704750327263`*^9}, {3.7395711703499002`*^9, 
   3.7395711735293837`*^9}, 3.7395767074858584`*^9},
 CellLabel->
  "In[446]:=",ExpressionUUID->"dc1c30b2-a0d7-468c-8efe-2cbccefe6d17"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Binarization", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561826627942*^9, 
  3.7395618309775496`*^9}},ExpressionUUID->"f95bcc4f-6bfe-464a-a552-\
a4e43ce86171"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bGradForward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "*", 
     RowBox[{"Sign", "[", "x", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bForward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "*", 
     RowBox[{"Sign", "[", "x", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bBackward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"Clip", "[", 
     RowBox[{"x", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0"}], "}"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7395618323377304`*^9, 3.7395618540661335`*^9}, {
  3.73956188930412*^9, 3.7395619082766542`*^9}, {3.739561960447143*^9, 
  3.7395619785341015`*^9}, {3.7395620336076946`*^9, 3.739562042142571*^9}, {
  3.7395621821157913`*^9, 3.739562212240314*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"2b04c139-2f94-48b8-8d61-34d9b95dd5aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"5", ",", " ", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"bForward", "[", 
   RowBox[{"bForward", "[", "k", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"bBackward", "@", "k"}], "]"}]}], "Input",
 CellChangeTimes->{{3.73956221459525*^9, 3.739562267032261*^9}, {
  3.7395623936666355`*^9, 3.7395624086265697`*^9}, {3.7395650396950006`*^9, 
  3.739565051160205*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"96a91b3d-cbf7-437a-8ff9-c72ba8eb071f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`"},
     {
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      "0.7801600269900612`", "0.7801600269900612`", "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}]},
     {"0.7801600269900612`", "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`"},
     {"0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      "0.7801600269900612`", "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}]},
     {
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}], "0.7801600269900612`", 
      RowBox[{"-", "0.7801600269900612`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395622299331093`*^9, 3.739562233698399*^9}, 
   3.739562267338441*^9, {3.739562394591077*^9, 3.739562408983615*^9}, {
   3.7395650257531652`*^9, 3.739565054514078*^9}, 3.7395675687646837`*^9, 
   3.7395676535458574`*^9, 3.739569226032625*^9, 3.739569360950058*^9, {
   3.7395696834239645`*^9, 3.7395696865855045`*^9}, 3.7395702394135103`*^9, 
   3.7395711830050325`*^9, 3.739572382862486*^9, 3.739573044947708*^9, 
   3.73957671681989*^9},
 CellLabel->
  "Out[461]//MatrixForm=",ExpressionUUID->"d01f208c-bf7b-4d86-90b7-\
f42f8904a74d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.47151305938194427`", 
      RowBox[{"-", "0.45659350522390074`"}], "0.3623742266209813`", 
      "0.02295654862181486`", "0.`", "0.5315883765449194`"},
     {
      RowBox[{"-", "0.15495037738073356`"}], "0.`", "0.`", 
      "0.8716783419664288`", "0.10023146488928107`", 
      RowBox[{"-", "0.44242287526963564`"}]},
     {"0.5795101687310567`", "0.`", 
      RowBox[{"-", "0.2713873983088318`"}], "0.18608558851665358`", "0.`", 
      "0.81366748327573`"},
     {"0.`", 
      RowBox[{"-", "0.07696526887626376`"}], "0.4192898441380953`", "0.`", 
      "0.`", "0.`"},
     {
      RowBox[{"-", "0.5090894640431666`"}], "0.5614287630063058`", 
      "0.8609727471695985`", "0.`", "0.7688219953919689`", 
      RowBox[{"-", "0.13748729624091355`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395622299331093`*^9, 3.739562233698399*^9}, 
   3.739562267338441*^9, {3.739562394591077*^9, 3.739562408983615*^9}, {
   3.7395650257531652`*^9, 3.739565054514078*^9}, 3.7395675687646837`*^9, 
   3.7395676535458574`*^9, 3.739569226032625*^9, 3.739569360950058*^9, {
   3.7395696834239645`*^9, 3.7395696865855045`*^9}, 3.7395702394135103`*^9, 
   3.7395711830050325`*^9, 3.739572382862486*^9, 3.739573044947708*^9, 
   3.739576716833851*^9},
 CellLabel->
  "Out[462]//MatrixForm=",ExpressionUUID->"00e63ce2-3f7c-4c57-8e33-\
5520fdabd752"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Derivative", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561793934884*^9, 
  3.7395617939369063`*^9}},ExpressionUUID->"870bd94f-dc36-421d-9319-\
812fabbde2e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sigmDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"x", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"UnitStep", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[463]:=",ExpressionUUID->"1c58304f-276a-4fff-a464-3fb29f6917c0"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Layer", " ", "evaluator", " ", "function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395618014661584`*^9, 
  3.7395618014681544`*^9}},ExpressionUUID->"1df6e341-2d38-4c91-826a-\
3c1d1eea106e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "layer_Association"}], "]"}], ":=", 
   RowBox[{"layerEval", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", " ", "\"\<LayerType\>\""}], "]"}], ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Sigmoid\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Ramp\>\"", ",", " ", "param_"}], "]"}], " ", 
   ":=", " ", 
   RowBox[{
    RowBox[{"Abs", "[", "x", "]"}], "*", 
    RowBox[{"UnitStep", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<LinearLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<BinLayer\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"bForward", "[", "x", "]"}], ",", " ", 
     RowBox[{"bForward", "[", 
      RowBox[{"param", "[", "\"\<Weights\>\"", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<BinarizeLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"bForward", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Training\>\""}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"FoldList", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Test\>\""}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Fold", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.739561809908105*^9, 3.7395618154083767`*^9}, {
   3.7395623342328377`*^9, 3.7395623869812956`*^9}, 3.739562722525852*^9},
 CellLabel->
  "In[465]:=",ExpressionUUID->"eaece362-9924-4902-ad27-cb64d3b2e085"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Test", "  ", "net", " ", "unroll"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395651673457117`*^9, 3.739565170036276*^9}, {
  3.739567660468338*^9, 
  3.739567673552924*^9}},ExpressionUUID->"da419ad2-19a0-47b3-b179-\
9a0e53f16796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "net", " ", "weights"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
     RowBox[{"initializeWeights", "[", 
      RowBox[{
      "hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "outputnodes"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"net", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",",
          " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], "|>"}]}]}],
         "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
        "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
         " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",",
          " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}],
       "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iteration", " ", "=", " ", "5"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.739565102836887*^9, 3.7395651321725073`*^9}, 
   3.7395675574439697`*^9, {3.73956938844948*^9, 3.7395694078914824`*^9}, {
   3.739571191083436*^9, 3.7395711924238386`*^9}, 3.73957155329235*^9, 
   3.739572359227727*^9},
 CellLabel->
  "In[473]:=",ExpressionUUID->"2dc1f03b-9776-42d0-af25-a5cb88f80a28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullnet", " ", "=", " ", 
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net", ",", " ", 
     RowBox[{"input", "[", 
      RowBox[{"[", 
       RowBox[{"iteration", ";;", 
        RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", " ", 
     "\"\<Training\>\""}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[476]:=",ExpressionUUID->"b3bf015d-c58c-402b-8f4d-3d8bb0dad5b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "@", "fullnet"}]], "Input",
 CellChangeTimes->{{3.739565135971985*^9, 3.7395651496759014`*^9}, {
  3.739565214148263*^9, 3.7395652661566544`*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"94e6e790-6ca4-45ca-8e79-dd56f00a7dd1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "17"}], "}"}]], "Output",
 CellChangeTimes->{{3.7395652424706345`*^9, 3.7395652664100184`*^9}, 
   3.739567561323603*^9, 3.7395676829118595`*^9, 3.73956941465635*^9, 
   3.739569697139269*^9, 3.7395702517026157`*^9, 3.7395712038901563`*^9, 
   3.7395715569735255`*^9, 3.739572391459509*^9, 3.7395730703178406`*^9, 
   3.7395767264511514`*^9},
 CellLabel->
  "Out[477]=",ExpressionUUID->"cfc0a5ed-525b-438d-a804-058a11d7d250"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Back", " ", "Propagation", " ", 
   RowBox[{"algorithm", " ", ":", " ", 
    StyleBox[
     RowBox[{
      StyleBox[
       StyleBox["A", "Subtitle",
        FontWeight->"Bold"], "Subtitle",
       FontWeight->"Bold"], "GGRESSIVE"}]], " "}]}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395624454383483`*^9, 3.7395624454403872`*^9}, {
  3.739565576577035*^9, 
  3.739565580333019*^9}},ExpressionUUID->"61c9a279-14aa-4315-be02-\
34ce40644024"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"backProp", "[", 
    RowBox[{
    "fullnet_", ",", " ", "w0_", ",", " ", "w1_", ",", " ", "w2_", ",", " ", 
     "input_", ",", " ", "target_", ",", " ", "l3M_", ",", " ", "l3V_", ",", 
     "  ", "l2M_", ",", " ", "l1M_", ",", " ", "l2V_", ",", " ", "l1V_", " ", 
     ",", " ", "iteration_", ",", " ", "lr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l3Error", ",", " ", "l3Delta", ",", " ", "l2Error", ",", " ", 
       "l2Delta", ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g2", 
       ",", " ", "g1", ",", " ", "g0", ",", " ", "l0", ",", " ", "l1", ",", 
       " ", "l2", ",", " ", "l3", ",", " ", "l1MC", ",", " ", "l1VC", ",", 
       " ", "l2MC", ",", " ", "l2VC", ",", " ", "l3MC", ",", " ", "l3VC", ",",
        " ", "l3MT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l3VT", 
       ",", " ", "l2VT", ",", " ", "l1VT", ",", " ", "w2T", ",", " ", "w1T", 
       ",", " ", "w0T", ",", " ", "w2UDT", ",", "  ", "w1UDT", ",", " ", 
       "w0UDT"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l3MT", " ", "=", " ", "l3M"}], ";", " ", 
      RowBox[{"l3VT", " ", "=", " ", "l3V"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", "l2M"}], ";", " ", 
      RowBox[{"l2VT", " ", "=", " ", "l2V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", "l1M"}], ";", " ", 
      RowBox[{"l1VT", " ", "=", " ", "l1V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "=", " ", "w2"}], ";", " ", 
      RowBox[{"w1T", " ", "=", " ", "w1"}], ";", " ", 
      RowBox[{"w0T", " ", "=", " ", "w0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Error", " ", "=", " ", 
       RowBox[{
        RowBox[{"fullnet", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", "target"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Delta", " ", "=", " ", 
       RowBox[{"l3Error", "*", 
        RowBox[{"sigmDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2Error", " ", "=", " ", 
       RowBox[{"bBackward", "@", 
        RowBox[{"Dot", "[", 
         RowBox[{"l3Delta", ",", " ", 
          RowBox[{"Transpose", "@", 
           RowBox[{"bForward", "[", "w2", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2Delta", " ", "=", " ", 
       RowBox[{"l2Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1Error", " ", "=", " ", 
       RowBox[{"bBackward", "@", 
        RowBox[{"Dot", "[", 
         RowBox[{"l2Delta", ",", " ", 
          RowBox[{"Transpose", "@", 
           RowBox[{"bForward", "[", "w1", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1Delta", " ", "=", " ", 
       RowBox[{"l1Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", " ", "l3Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", " ", "l2Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g0", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "input", "]"}], ",", " ", "l1Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"l3MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g2", "*", "g2"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l1MC", " ", "=", " ", 
       RowBox[{"l1MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l1VC", " ", "=", " ", 
       RowBox[{"l1VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l2MC", " ", "=", " ", 
       RowBox[{"l2MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l2VC", " ", "=", " ", 
       RowBox[{"l2VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l3MC", " ", "=", " ", 
       RowBox[{"l3MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l3VC", " ", "=", " ", 
       RowBox[{"l3VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"w2UDT", " ", "=", " ", 
       RowBox[{"l3MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l3VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w1UDT", " ", "=", " ", 
       RowBox[{"l2MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0UDT", " ", "=", " ", 
       RowBox[{"l1MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w2UDT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w1UDT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w0T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w0UDT"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "w0T", ",", " ", "w1T", ",", " ", "w2T", ",", " ", "l3MT", ",", " ", 
         "l3VT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l2VT", ",", 
         " ", "l1VT"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7395624500862284`*^9, 3.739562554732466*^9}, {
   3.739564362084696*^9, 3.7395646830462513`*^9}, {3.7395647383609943`*^9, 
   3.7395648889763565`*^9}, {3.7395649336872797`*^9, 3.73956496497505*^9}, {
   3.7395653560975943`*^9, 3.7395653586654463`*^9}, {3.7395654534098997`*^9, 
   3.739565453684158*^9}, {3.739565494539566*^9, 3.739565497811923*^9}, {
   3.7395674786434183`*^9, 3.7395675163349547`*^9}, {3.739567596114509*^9, 
   3.7395676015569487`*^9}, {3.739567642051608*^9, 3.7395676422939596`*^9}, {
   3.739567749980448*^9, 3.739567751769636*^9}, {3.7395697169652257`*^9, 
   3.7395697374454412`*^9}, {3.739570032342909*^9, 3.7395700388036165`*^9}, {
   3.7395702806810875`*^9, 3.739570310079441*^9}, {3.7395705972427616`*^9, 
   3.739570626519433*^9}, {3.739571209798349*^9, 3.7395712460573425`*^9}, {
   3.7395715388479953`*^9, 3.739571544652464*^9}, {3.7395722847579594`*^9, 
   3.7395722919367523`*^9}, {3.739572326004605*^9, 3.7395723311997213`*^9}, 
   3.7395727115982656`*^9, {3.739572757806614*^9, 3.7395727826980376`*^9}, {
   3.7395729033916187`*^9, 3.739572932979473*^9}, {3.739573152498469*^9, 
   3.739573158495435*^9}, {3.739573477433138*^9, 3.739573478329731*^9}, {
   3.7395741289553223`*^9, 3.739574152787404*^9}, {3.739574635841178*^9, 
   3.7395746432880635`*^9}, {3.739574762989523*^9, 3.739574767413004*^9}, {
   3.739574959702689*^9, 3.7395749657674627`*^9}, {3.7395766949045253`*^9, 
   3.7395767012355833`*^9}, {3.739576824480877*^9, 
   3.7395768677371187`*^9}},ExpressionUUID->"c6adda7b-8a80-4281-beaf-\
7c3c90b47bdc"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Accuracy", " ", "Testing", " ", "Function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739562563352662*^9, 
  3.7395625633546567`*^9}},ExpressionUUID->"a41b5cfc-5af9-496c-8ed5-\
4384788014ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "testnum_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
          "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"netEvaluate", "[", 
           RowBox[{"net", ",", " ", 
            RowBox[{"input", "[", 
             RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}],
            "]"}], "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"target", "[", 
          RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "1"}], "]"}], " ", 
       "-", " ", "1"}]}], "}"}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"accTest", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "numTest_"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"y", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", " ", 
        RowBox[{"x", "\[LessEqual]", "numTest"}], ",", " ", 
        RowBox[{"x", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"netEvaluate", "[", 
              RowBox[{"net", ",", " ", 
               RowBox[{"input", "[", 
                RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
              "]"}], ",", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"netEvaluate", "[", 
               RowBox[{"net", ",", " ", 
                RowBox[{"input", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
               "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"target", "[", 
              RowBox[{"[", "x", "]"}], "]"}], ",", " ", "1"}], "]"}]}], " ", 
          ",", 
          RowBox[{"y", "++"}]}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"y", "/", "numTest"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.7395625622936754`*^9},
 CellLabel->
  "In[479]:=",ExpressionUUID->"bd95f968-bfba-4ab0-ba08-0476279d678a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"Network", " ", "run", " ", "function", " "}], "Subtitle",
   FontWeight->"Bold"]}]], "Input",
 CellChangeTimes->{{3.739562565606951*^9, 
  3.739562567423723*^9}},ExpressionUUID->"218e8cea-5e9c-4471-b73e-\
c9c738235ee3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runNet", "[", 
   RowBox[{
   "input_", ",", " ", "target_", ",", " ", "testinp_", ",", " ", "testtar_", 
    ",", " ", "import_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iteration", ",", " ", "fullnet", ",", " ", "w0", ",", " ", "w1", ",", 
      " ", "w2", ",", "l3M", ",", " ", "l3V", ",", " ", "l2M", ",", " ", 
      "l1M", ",", " ", "l2V", ",", " ", "l1V", ",", "\[IndentingNewLine]", 
      "l3Error", ",", " ", "l3Delta", ",", "l2Error", ",", " ", "l2Delta", 
      ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g1", ",", " ", 
      "g0", ",", " ", "l0", ",", " ", "l1", ",", " ", "l2", ",", "l3", ",", 
      " ", "l1MC", ",", " ", "l1VC", ",", " ", "l2MC", ",", " ", "l2VC", ",", 
      " ", "l3MC", ",", " ", "l3VC", ",", " ", "w2UDT", ",", " ", "w1UDT", 
      ",", " ", "w0UDT", ",", " ", "epoch", ",", " ", "lr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"import", " ", "\[Equal]", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
        RowBox[{"initializeWeights", "[", 
         RowBox[{"hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "10"}], 
         "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", 
         " ", 
         RowBox[{"Import", "[", "\"\<MNISTweightsAggressive.dat\>\"", "]"}]}],
         ";", " ", 
        RowBox[{"w0", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"784", ",", " ", "hiddennodes1"}], "]"}]}], ";", " ", 
        RowBox[{"w1", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"hiddennodes1", ",", " ", "hiddennodes2"}], "]"}]}], ";", 
        " ", 
        RowBox[{"w2", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"hiddennodes2", ",", " ", "outputnodes"}], "]"}]}], ";"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"epoch", " ", "=", " ", "epochs"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"l3M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l3V", " ", "=", " ", "0"}], ";", 
     RowBox[{"l2M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l2V", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1V", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Iterator", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iteration", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"iteration", "\[LessEqual]", " ", "iterations"}], ",", " ", 
       RowBox[{"iteration", "+=", "batchsize"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "iteration", " ", "ends", " ", "and", " ", "epoch", " ", 
          "isnt", " ", "0"}], ",", " ", 
         RowBox[{"reset", " ", "iteration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"iteration", " ", "\[GreaterEqual]", " ", 
             RowBox[{"iterations", " ", "-", " ", "32"}]}], ",", " ", 
            RowBox[{"epoch", "\[GreaterEqual]", "1"}]}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"iteration", "=", "1"}], ";", " ", 
           RowBox[{"epoch", "-=", "1"}], ";", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<epoch \>\"", "epoch"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Training acc\>\"", " ", 
             StyleBox[
              RowBox[{"N", "[", 
               RowBox[{"accTest", "[", 
                RowBox[{
                "net", ",", " ", "input", ",", " ", "target", ",", " ", 
                 "600"}], "]"}], "]"}],
              FontWeight->"Bold"]}], 
            StyleBox["]",
             FontWeight->"Bold"]}], 
           StyleBox[";",
            FontWeight->"Bold"], 
           StyleBox["\[IndentingNewLine]",
            FontWeight->"Bold"], 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Test acc\>\"", " ", 
             RowBox[{"N", "[", 
              RowBox[{"accTest", "[", 
               RowBox[{
               "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", 
                "100"}], "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "net", " ", "weights"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"net", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], 
               "|>"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}],
             "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], 
            "|>"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Evaluate", " ", "the", " ", "net"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"fullnet", " ", "=", " ", 
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "\"\<Training\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Back", " ", "prop"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lr", " ", "=", " ", 
         RowBox[{"learningrate", "*", 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"0.1", "*", "epoch"}]}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "w0", ",", " ", "w1", ",", "w2", ",", " ", "l3M", ",", " ", "l3V", 
           ",", " ", "l2M", ",", " ", "l1M", ",", " ", "l2V", ",", " ", 
           "l1V"}], "}"}], " ", "=", " ", 
         RowBox[{"backProp", "[", 
          RowBox[{
          "fullnet", ",", " ", "w0", ",", " ", "w1", ",", " ", "w2", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"target", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "l3M", ",", " ", "l3V", ",", "  ", "l2M", ",", " ", "l1M", 
           ",", " ", "l2V", ",", " ", "l1V", ",", " ", "iteration", ",", " ", 
           "lr"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7395625861297393`*^9, 3.73956263052021*^9}, {
   3.739562661362663*^9, 3.7395626648009043`*^9}, {3.739562698886861*^9, 
   3.7395628175642104`*^9}, {3.7395628580197864`*^9, 
   3.7395628830116644`*^9}, {3.739565287707942*^9, 3.7395653136146135`*^9}, {
   3.7395653694401464`*^9, 3.7395653712669187`*^9}, 3.7395675100617385`*^9, {
   3.7395687061205344`*^9, 3.7395687439675574`*^9}, {3.7395687949511795`*^9, 
   3.7395688222052383`*^9}, {3.7395694260329103`*^9, 
   3.7395694972739954`*^9}, {3.739570004627472*^9, 3.7395700193488555`*^9}, {
   3.7395701508105946`*^9, 3.739570222099818*^9}, {3.7395703844570923`*^9, 
   3.739570384543826*^9}, {3.739570560724471*^9, 3.739570561260044*^9}, 
   3.739571562562572*^9, 3.7395723727315903`*^9, {3.739572888796667*^9, 
   3.739572890036351*^9}},
 CellLabel->
  "In[481]:=",ExpressionUUID->"36468c58-a035-49a6-a4de-3bb47bc777bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
    RowBox[{"runNet", "[", 
     RowBox[{
     "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar", 
      ",", " ", "0"}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7395678812433558`*^9, 3.7395678815515313`*^9}, 
   3.7395679197932253`*^9, {3.7395687861936026`*^9, 3.739568789543648*^9}, {
   3.7395688759873476`*^9, 3.73956887770176*^9}, 3.739568912577813*^9, {
   3.7395695067925415`*^9, 3.739569508267585*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"05937a87-855a-463a-a9dc-a1521677c725"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"49", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576740923399*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"8d3d60f8-1a54-4c31-b162-566bcddf93a3"],

Cell[BoxData[
 RowBox[{"0.05`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576742355567*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"da833ddf-24f4-43f8-baba-13287c2ef74e"],

Cell[BoxData[
 RowBox[{"0.06`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576742591934*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"9a7276f5-6bb6-41b8-b999-ac20166e37a7"],

Cell[BoxData[
 RowBox[{"48", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767473871074`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"e44df20a-918b-4c88-bd26-a3ada882ac28"],

Cell[BoxData[
 RowBox[{"0.04666666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767487315087`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"0d8c74cf-7911-414e-ad2f-bc1ad0d301dd"],

Cell[BoxData[
 RowBox[{"0.05`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576748966879*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"85e63d75-4e18-4673-b0c4-893042e1619d"],

Cell[BoxData[
 RowBox[{"47", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576753678273*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"1f974585-acf8-439f-9421-a49978725eb5"],

Cell[BoxData[
 RowBox[{"0.07833333333333334`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767550406294`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"959ad664-a5b7-4ef2-a3cb-396157a66e8b"],

Cell[BoxData[
 RowBox[{"0.1`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767552680206`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"0c8a7f56-5ba9-47e1-9332-d1c6f498e3f9"],

Cell[BoxData[
 RowBox[{"46", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767598348026`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"62640d81-d8c8-49e2-8081-55d53cc75c8e"],

Cell[BoxData[
 RowBox[{"0.051666666666666666`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.73957676111837*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"7129b30d-5e79-41de-af5c-e0fb61a36770"],

Cell[BoxData[
 RowBox[{"0.08`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576761343766*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"ebeb9b92-ec14-47c6-8a9e-33e9bec96877"],

Cell[BoxData[
 RowBox[{"45", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767659993095`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"2290edb3-eee6-47f1-982d-adb943e6f3b5"],

Cell[BoxData[
 RowBox[{"0.08666666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767673217716`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"4f3d5013-174a-4ae5-a38b-991c7cd29887"],

Cell[BoxData[
 RowBox[{"0.09`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576767553153*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"06b2518b-c8de-4d91-985e-315d41775f36"],

Cell[BoxData[
 RowBox[{"44", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576772190745*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"b4dd6ab5-bc31-4eb9-b2aa-164061c88f2d"],

Cell[BoxData[
 RowBox[{"0.065`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767734842834`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"af9207c7-ac7a-47da-9e4d-1cc7ab843ee7"],

Cell[BoxData[
 RowBox[{"0.08`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767737166624`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"fe616fd5-3f11-4daf-9ad9-0cd0bb78a92b"],

Cell[BoxData[
 RowBox[{"43", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576778506847*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"7dfb41b1-1c9a-4e26-8f35-1c6620a4c5e5"],

Cell[BoxData[
 RowBox[{"0.09`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576779794402*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"ef018560-74ba-4940-b3ae-a00312fb1eee"],

Cell[BoxData[
 RowBox[{"0.08`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767800347595`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"734d6ec6-649c-4ad8-b9c6-63c2373003cb"],

Cell[BoxData[
 RowBox[{"42", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576784649412*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"8a3f3417-b7cb-4fb3-afc6-5a4fcbb9bee1"],

Cell[BoxData[
 RowBox[{"0.1`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767859419546`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"ce1aa329-ab21-4f44-9d57-3f3d918c76f7"],

Cell[BoxData[
 RowBox[{"0.11`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576786165357*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"efb7789b-6445-41db-8ae3-c45efeeb2013"],

Cell[BoxData[
 RowBox[{"41", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767909056745`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"4e31b9f1-fb10-4c59-9cce-b894558a1e29"],

Cell[BoxData[
 RowBox[{"0.105`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576792226142*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"7d91e90e-e6f0-4f94-87b0-b9356caa62a4"],

Cell[BoxData[
 RowBox[{"0.08`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767924555264`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"ef675657-f9e6-4c29-9685-200300d19299"],

Cell[BoxData[
 RowBox[{"40", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767972706466`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"cc5e44ed-49f0-4379-8643-0800926a2593"],

Cell[BoxData[
 RowBox[{"0.1`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767985671763`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"feea9999-05c8-4e0f-932e-624219fa9b0e"],

Cell[BoxData[
 RowBox[{"0.11`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395767987955647`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"c34d4a13-9124-4f46-9e20-b46639a71b93"],

Cell[BoxData[
 RowBox[{"39", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576803432161*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"e6aaa8e2-894d-405e-b717-34cc31fdcb07"],

Cell[BoxData[
 RowBox[{"0.07166666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.739576804734675*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"b6a73f98-1a35-45c9-986b-3ca08c39d422"],

Cell[BoxData[
 RowBox[{"0.03`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.73957499161604*^9, 3.7395768049720407`*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"c7ab9472-fc04-42b5-b0af-d41306b4b1fb"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.7395749724954634`*^9, 3.7395749751782837`*^9}, 
   3.7395750695236034`*^9, 3.7395768094979305`*^9},
 CellLabel->
  "Out[482]=",ExpressionUUID->"653acebc-bcb5-4e31-8205-29cbc3b50f38"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Net", " ", "accuracy", " ", "testing"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395660841464415`*^9, 
  3.7395660841484365`*^9}},ExpressionUUID->"76509af4-f972-48f3-8a24-\
2d303027df43"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"net", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], "|>"}]}]}], 
      "|>"}], ",", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
      "|>"}], ",", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
     ",", " ", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"N", "[", 
   RowBox[{"accTest", "[", 
    RowBox[{"net", ",", " ", "input", ",", " ", "target", ",", " ", "60000"}],
     "]"}], "]"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"accTest", "[", 
   RowBox[{
   "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", "10000"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.739566091021245*^9, 3.739566092125001*^9}, {
   3.73956955863483*^9, 3.739569561230888*^9}, 3.7395717586279864`*^9, 
   3.739572365479014*^9, 3.739573353934563*^9},
 CellLabel->
  "In[429]:=",ExpressionUUID->"132d33cb-410c-4157-80c3-5a6126d28bd9"],

Cell[BoxData["0.81925`"], "Output",
 CellChangeTimes->{3.739571818267424*^9, 3.739572609457514*^9, 
  3.739573004621518*^9, 3.739573411551388*^9, 3.7395744008397436`*^9},
 CellLabel->
  "Out[430]=",ExpressionUUID->"bfdf7e30-a004-4992-ad65-72e200105097"],

Cell[BoxData["0.8253`"], "Output",
 CellChangeTimes->{3.739571818267424*^9, 3.739572609457514*^9, 
  3.739573004621518*^9, 3.739573411551388*^9, 3.739574411347893*^9},
 CellLabel->
  "Out[431]=",ExpressionUUID->"a90cab40-7948-4280-b159-629f4f30fd9c"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "weight", " ", "saver"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395660953908577`*^9, 
  3.7395660953938513`*^9}},ExpressionUUID->"b8a2612e-6c83-43f5-a790-\
051a11948a70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<MNISTweightsBNN.dat\>\"", ",", " ", 
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73956610191183*^9, 3.73956610347484*^9}, {
  3.7395695796436224`*^9, 3.7395695817539763`*^9}, {3.739572630227945*^9, 
  3.7395726338243217`*^9}, {3.739572665797782*^9, 3.739572666508888*^9}, {
  3.739573053692313*^9, 3.739573054919036*^9}, {3.73957442999238*^9, 
  3.739574432616332*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"2fd6b94c-9b4b-4da4-9e1f-dd02ef6f734c"],

Cell[BoxData["\<\"MNISTweightsBNN.dat\"\>"], "Output",
 CellChangeTimes->{3.7395687503185654`*^9, 3.739572672350273*^9, 
  3.739573060424301*^9, 3.7395744376942644`*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"c22ca41d-f86f-46ec-919b-4e540fb7f9e7"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "weight", " ", "importer"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.73956610744728*^9, 
  3.7395661074493027`*^9}},ExpressionUUID->"d5ee46f5-e995-4b1b-841d-\
af2abfc087e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{
   "Import", "[", "\"\<MNISTweightsAggressive256,512.dat\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"w0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"784", ",", " ", "hiddennodes1"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"w1", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"w1", ",", " ", 
     RowBox[{"{", 
      RowBox[{"hiddennodes1", ",", " ", "hiddennodes2"}], "}"}]}], "]"}]}], 
  ";", " ", 
  RowBox[{"w2", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"w2", ",", " ", 
     RowBox[{"{", 
      RowBox[{"hiddennodes2", ",", " ", "outputnodes"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.739568735511192*^9, {3.739569062931749*^9, 3.7395690747371807`*^9}, {
   3.7395691353576393`*^9, 3.7395692072530603`*^9}, {3.7395695993708415`*^9, 
   3.739569629043454*^9}},ExpressionUUID->"e03a02b0-5cd4-456c-8e85-\
03a6bad442cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SeedRandom", "[", "3", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"4", ",", " ", "16"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", "k"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Sign", "[", "k", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7395775304555044`*^9, 3.7395775445857*^9}, {
  3.7395776993831635`*^9, 3.73957770201612*^9}, {3.7395777724028015`*^9, 
  3.739577850239352*^9}, {3.7395778864305277`*^9, 3.739577934446863*^9}, {
  3.7395780958483987`*^9, 3.7395781563824096`*^9}, {3.7395784430006037`*^9, 
  3.739578446960985*^9}, {3.7395785088502507`*^9, 3.739578530826999*^9}, {
  3.739578693711234*^9, 3.7395787005339804`*^9}, {3.739578807367158*^9, 
  3.739578879133935*^9}, {3.739578940952713*^9, 3.739578949256361*^9}, {
  3.739580046874996*^9, 3.7395800553842325`*^9}, {3.73958341939892*^9, 
  3.739583421006612*^9}},
 CellLabel->
  "In[786]:=",ExpressionUUID->"3e32d8d0-8b42-461e-9c7e-80272f38b549"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.2122608346964594`", "0.06630920617080979`", "0.9324420219026058`", 
      "1.1168008021486746`", 
      RowBox[{"-", "1.8201092471672258`"}], 
      RowBox[{"-", "0.3318344417898914`"}], "0.06797740039638474`", 
      RowBox[{"-", "1.0438929771730057`"}], "1.1070044742785832`", 
      RowBox[{"-", "0.7653416890160656`"}], 
      RowBox[{"-", "0.16066166421393624`"}], 
      RowBox[{"-", "0.1515567133481668`"}], "2.1412054102392086`", 
      RowBox[{"-", "0.24654549300003017`"}], "0.5059775659979555`", 
      "0.5647038569804349`"},
     {"0.5986637272451603`", "1.3220927743947215`", 
      RowBox[{"-", "0.6355979932026578`"}], "0.6808272445768163`", 
      "0.10789891245145777`", "0.8971841626275918`", "0.36312365804534946`", 
      RowBox[{"-", "1.0164671422474911`"}], 
      RowBox[{"-", "2.55180148797337`"}], "0.6701997084610983`", 
      RowBox[{"-", "1.0869644286638558`"}], 
      RowBox[{"-", "0.2845123729917042`"}], 
      RowBox[{"-", "1.319441498542277`"}], 
      RowBox[{"-", "0.6850089383888169`"}], 
      RowBox[{"-", "0.7079503985906768`"}], "0.7366655612927107`"},
     {
      RowBox[{"-", "0.8938340752664604`"}], 
      RowBox[{"-", "0.6540994132049356`"}], 
      RowBox[{"-", "1.5357570434998016`"}], "1.3423424908912256`", 
      RowBox[{"-", "1.6353295170327502`"}], "0.7686085172104047`", 
      "0.32063660497373003`", "0.27564703594904955`", "0.05901857333242857`", 
      RowBox[{"-", "0.04494102022021888`"}], "0.532530818722854`", 
      RowBox[{"-", "0.9382538434250499`"}], 
      RowBox[{"-", "1.6732127693634866`"}], 
      RowBox[{"-", "2.17400910304632`"}], "1.928183015425993`", 
      "0.9508580310970153`"},
     {"1.3708567886738452`", 
      RowBox[{"-", "1.6169556342327438`"}], 
      RowBox[{"-", "2.020552643785877`"}], "0.017914868849258688`", 
      RowBox[{"-", "0.73583106081347`"}], 
      RowBox[{"-", "2.327186453214273`"}], 
      RowBox[{"-", "0.27418988974780145`"}], 
      RowBox[{"-", "1.1792813848564285`"}], "0.8385057821303568`", 
      RowBox[{"-", "1.6623035481448332`"}], "0.33563145577707276`", 
      "0.5339014879988897`", "1.0988125437584702`", 
      RowBox[{"-", "0.16890128907753013`"}], "0.24937910701347474`", 
      "0.6271304196567724`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395834058556695`*^9, 3.7395834219204774`*^9}},
 CellLabel->
  "Out[788]//MatrixForm=",ExpressionUUID->"08c26d9c-52a8-4301-a5b1-\
316e49d6fa6d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "1"},
     {"1", "1", 
      RowBox[{"-", "1"}], "1", "1", "1", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1"},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "1", "1", "1", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "1"},
     {"1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "1", "1", 
      RowBox[{"-", "1"}], "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395834058556695`*^9, 3.73958342198505*^9}},
 CellLabel->
  "Out[789]//MatrixForm=",ExpressionUUID->"677506b8-398b-4729-8f88-\
433ee72d7c4f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"forwardPass", "[", 
     RowBox[{"x_", ",", " ", "hBL_"}], "]"}], ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Mean", ",", " ", 
      RowBox[{"Abs", "@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", 
             RowBox[{"#", ";;", 
              RowBox[{"#", "+", "hBL", "-", "1"}]}]}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "@", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", "hBL", "+", "1"}], ",",
              " ", "hBL"}], "]"}], "]"}], ")"}]}], "]"}]}], ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.739582358881873*^9, {3.7395827746813526`*^9, 3.7395827859156284`*^9}, {
   3.7395828210487194`*^9, 3.739582849874645*^9}, {3.7395834584797945`*^9, 
   3.7395834677122345`*^9}, {3.73958355301208*^9, 3.7395835686763334`*^9}, {
   3.7395836395018387`*^9, 3.7395836400347357`*^9}},
 CellLabel->
  "In[810]:=",ExpressionUUID->"e3960859-381d-4cb6-93f9-d0d9a66d0b42"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739583982215005*^9, 3.7395839910553026`*^9}, {
  3.7395841130695324`*^9, 3.73958414794075*^9}, {3.739584217581053*^9, 
  3.739584255602778*^9}},ExpressionUUID->"53a07b0a-cbb3-4dc0-bad1-\
04c367b0d5c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"(", 
   RowBox[{"maker", "[", 
    RowBox[{"k", ",", " ", "8"}], "]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7395841507278185`*^9, 3.7395841628072953`*^9}, {
  3.7395842025252075`*^9, 3.7395842238590565`*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"b483b664-3cb9-4710-99a8-76ef2882c4bb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.823953366430632`", "0.823953366430632`", "0.823953366430632`", 
      "0.823953366430632`", 
      RowBox[{"-", "0.823953366430632`"}], 
      RowBox[{"-", "0.823953366430632`"}], "0.823953366430632`", 
      RowBox[{"-", "0.823953366430632`"}], "0.7053746083842977`", 
      RowBox[{"-", "0.7053746083842977`"}], 
      RowBox[{"-", "0.7053746083842977`"}], 
      RowBox[{"-", "0.7053746083842977`"}], "0.7053746083842977`", 
      RowBox[{"-", "0.7053746083842977`"}], "0.7053746083842977`", 
      "0.7053746083842977`"},
     {"0.7027319518489057`", "0.7027319518489057`", 
      RowBox[{"-", "0.7027319518489057`"}], "0.7027319518489057`", 
      "0.7027319518489057`", "0.7027319518489057`", "0.7027319518489057`", 
      RowBox[{"-", "0.7027319518489057`"}], 
      RowBox[{"-", "1.0053180493630638`"}], "1.0053180493630638`", 
      RowBox[{"-", "1.0053180493630638`"}], 
      RowBox[{"-", "1.0053180493630638`"}], 
      RowBox[{"-", "1.0053180493630638`"}], 
      RowBox[{"-", "1.0053180493630638`"}], 
      RowBox[{"-", "1.0053180493630638`"}], "1.0053180493630638`"},
     {
      RowBox[{"-", "0.9282818372535447`"}], 
      RowBox[{"-", "0.9282818372535447`"}], 
      RowBox[{"-", "0.9282818372535447`"}], "0.9282818372535447`", 
      RowBox[{"-", "0.9282818372535447`"}], "0.9282818372535447`", 
      "0.9282818372535447`", "0.9282818372535447`", "1.0376258968291707`", 
      RowBox[{"-", "1.0376258968291707`"}], "1.0376258968291707`", 
      RowBox[{"-", "1.0376258968291707`"}], 
      RowBox[{"-", "1.0376258968291707`"}], 
      RowBox[{"-", "1.0376258968291707`"}], "1.0376258968291707`", 
      "1.0376258968291707`"},
     {"1.1928460905217124`", 
      RowBox[{"-", "1.1928460905217124`"}], 
      RowBox[{"-", "1.1928460905217124`"}], "1.1928460905217124`", 
      RowBox[{"-", "1.1928460905217124`"}], 
      RowBox[{"-", "1.1928460905217124`"}], 
      RowBox[{"-", "1.1928460905217124`"}], 
      RowBox[{"-", "1.1928460905217124`"}], "0.689320704194675`", 
      RowBox[{"-", "0.689320704194675`"}], "0.689320704194675`", 
      "0.689320704194675`", "0.689320704194675`", 
      RowBox[{"-", "0.689320704194675`"}], "0.689320704194675`", 
      "0.689320704194675`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.739584153948964*^9, 3.739584163117866*^9}, {
  3.7395842070104036`*^9, 3.739584252774807*^9}},
 CellLabel->
  "Out[848]//MatrixForm=",ExpressionUUID->"d302619b-9e97-4e90-8478-\
0f6a8e5edd29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"forwardPass", "[", 
           RowBox[{"k", ",", " ", "4"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", ";;"}], "]"}], "]"}], ",", " ", "4"}], "]"}]}]}],
      "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Dimensions", "[", "k", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7395834277388577`*^9, 3.739583473298113*^9}, {
  3.7395837745792046`*^9, 3.7395840304742785`*^9}, {3.739584067275663*^9, 
  3.7395840967448473`*^9}},
 CellLabel->
  "In[837]:=",ExpressionUUID->"e5630171-a2cd-472a-b23e-d845665ceac4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8319532162296374`", "0.8319532162296374`", "0.8319532162296374`", 
      "0.8319532162296374`", "0.815953516631627`", "0.815953516631627`", 
      "0.815953516631627`", "0.815953516631627`", "0.546141135214188`", 
      "0.546141135214188`", "0.546141135214188`", "0.546141135214188`", 
      "0.8646080815544073`", "0.8646080815544073`", "0.8646080815544073`", 
      "0.8646080815544073`"},
     {"0.809295434854839`", "0.809295434854839`", "0.809295434854839`", 
      "0.809295434854839`", "0.5961684688429725`", "0.5961684688429725`", 
      "0.5961684688429725`", "0.5961684688429725`", "1.148369499522507`", 
      "1.148369499522507`", "1.148369499522507`", "1.148369499522507`", 
      "0.8622665992036205`", "0.8622665992036205`", "0.8622665992036205`", 
      "0.8622665992036205`"},
     {"1.1065082557156058`", "1.1065082557156058`", "1.1065082557156058`", 
      "1.1065082557156058`", "0.7500554187914837`", "0.7500554187914837`", 
      "0.7500554187914837`", "0.7500554187914837`", "0.39368606392513783`", 
      "0.39368606392513783`", "0.39368606392513783`", "0.39368606392513783`", 
      "1.6815657297332036`", "1.6815657297332036`", "1.6815657297332036`", 
      "1.6815657297332036`"},
     {"1.2565699838854312`", "1.2565699838854312`", "1.2565699838854312`", 
      "1.2565699838854312`", "1.1291221971579932`", "1.1291221971579932`", 
      "1.1291221971579932`", "1.1291221971579932`", "0.8425855685127881`", 
      "0.8425855685127881`", "0.8425855685127881`", "0.8425855685127881`", 
      "0.5360558398765618`", "0.5360558398765618`", "0.5360558398765618`", 
      "0.5360558398765618`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395834033096466`*^9, 3.739583473674021*^9}, {
   3.739583555606203*^9, 3.739583571296874*^9}, 3.7395836421681056`*^9, {
   3.7395837646602807`*^9, 3.739583841370408*^9}, 3.739583886352565*^9, {
   3.739583916951523*^9, 3.739584030693741*^9}, {3.739584071964114*^9, 
   3.7395840976457906`*^9}},
 CellLabel->
  "Out[837]//MatrixForm=",ExpressionUUID->"33cbe359-d5b4-4935-922d-\
c6e5ed96dcfe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"forwardTPass", "[", 
     RowBox[{"x_", ",", " ", "hBL_"}], "]"}], ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Mean", ",", " ", 
      RowBox[{"Abs", "@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", 
             RowBox[{"#", ";;", 
              RowBox[{"#", "+", "hBL", "-", "1"}]}]}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "@", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", "hBL", "+", "1"}], ",",
              " ", "hBL"}], "]"}], "]"}], ")"}]}], "]"}]}], ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.739583592057624*^9, 3.739583598498042*^9}, {
  3.7395836325543547`*^9, 3.739583632729571*^9}, {3.7395836911734624`*^9, 
  3.739583691388548*^9}, {3.7395837565715885`*^9, 3.739583759134919*^9}},
 CellLabel->
  "In[809]:=",ExpressionUUID->"561e578d-9f73-4565-b4e5-fc2d1e02273a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"forwardTPass", "[", 
   RowBox[{"k", ",", " ", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{3.739583605026616*^9},
 CellLabel->
  "In[808]:=",ExpressionUUID->"e6cb8467-13fb-4e8d-a582-b294c2848523"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.8319532162296374`"},
          {"0.815953516631627`"},
          {"0.546141135214188`"},
          {"0.8646080815544073`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.809295434854839`"},
          {"0.5961684688429725`"},
          {"1.148369499522507`"},
          {"0.8622665992036205`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1.1065082557156058`"},
          {"0.7500554187914837`"},
          {"0.39368606392513783`"},
          {"1.6815657297332036`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1.2565699838854312`"},
          {"1.1291221971579932`"},
          {"0.8425855685127881`"},
          {"0.5360558398765618`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.8319532162296374`"},
          {"0.815953516631627`"},
          {"0.546141135214188`"},
          {"0.8646080815544073`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.809295434854839`"},
          {"0.5961684688429725`"},
          {"1.148369499522507`"},
          {"0.8622665992036205`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1.1065082557156058`"},
          {"0.7500554187914837`"},
          {"0.39368606392513783`"},
          {"1.6815657297332036`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1.2565699838854312`"},
          {"1.1291221971579932`"},
          {"0.8425855685127881`"},
          {"0.5360558398765618`"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7395836064840946`*^9, 3.7395836939050364`*^9},
 CellLabel->
  "Out[808]//MatrixForm=",ExpressionUUID->"e2d75929-1f0e-44c7-b9b3-\
cc672044ae27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"Map", "[", 
   RowBox[{"Flatten", ",", " ", 
    RowBox[{"forwardPass", "[", 
     RowBox[{"k", ",", " ", "4"}], "]"}], ",", " ", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7395834822106686`*^9, 3.7395834968609657`*^9}},
 CellLabel->
  "In[796]:=",ExpressionUUID->"7b8a8813-05b5-4d7d-ad0b-991ea2e87615"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8319532162296374`", "0.815953516631627`", "0.546141135214188`", 
      "0.8646080815544073`", "0.809295434854839`", "0.5961684688429725`", 
      "1.148369499522507`", "0.8622665992036205`", "1.1065082557156058`", 
      "0.7500554187914837`", "0.39368606392513783`", "1.6815657297332036`", 
      "1.2565699838854312`", "1.1291221971579932`", "0.8425855685127881`", 
      "0.5360558398765618`"},
     {"0.8319532162296374`", "0.815953516631627`", "0.546141135214188`", 
      "0.8646080815544073`", "0.809295434854839`", "0.5961684688429725`", 
      "1.148369499522507`", "0.8622665992036205`", "1.1065082557156058`", 
      "0.7500554187914837`", "0.39368606392513783`", "1.6815657297332036`", 
      "1.2565699838854312`", "1.1291221971579932`", "0.8425855685127881`", 
      "0.5360558398765618`"},
     {"0.8319532162296374`", "0.815953516631627`", "0.546141135214188`", 
      "0.8646080815544073`", "0.809295434854839`", "0.5961684688429725`", 
      "1.148369499522507`", "0.8622665992036205`", "1.1065082557156058`", 
      "0.7500554187914837`", "0.39368606392513783`", "1.6815657297332036`", 
      "1.2565699838854312`", "1.1291221971579932`", "0.8425855685127881`", 
      "0.5360558398765618`"},
     {"0.8319532162296374`", "0.815953516631627`", "0.546141135214188`", 
      "0.8646080815544073`", "0.809295434854839`", "0.5961684688429725`", 
      "1.148369499522507`", "0.8622665992036205`", "1.1065082557156058`", 
      "0.7500554187914837`", "0.39368606392513783`", "1.6815657297332036`", 
      "1.2565699838854312`", "1.1291221971579932`", "0.8425855685127881`", 
      "0.5360558398765618`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7395834970744257`*^9},
 CellLabel->
  "Out[796]//MatrixForm=",ExpressionUUID->"04f409d2-76ca-4c06-8bd8-\
74e0e298b0cb"]
}, Open  ]]
},
WindowSize->{958, 1028},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 7, 2018)",
StyleDefinitions->"ReverseColor.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 252, 6, 48, "Input",ExpressionUUID->"4a199865-ad68-48b2-81f8-86651ddafa89"],
Cell[816, 28, 4324, 112, 275, "Input",ExpressionUUID->"529ea0e3-52f7-42db-8042-f3e86c514a8f"],
Cell[5143, 142, 277, 7, 48, "Input",ExpressionUUID->"48868ed5-26c5-4f8b-96a7-b27fd0a1a145"],
Cell[5423, 151, 2566, 63, 187, "Input",ExpressionUUID->"a7d24f0e-bf08-4162-809b-f7d4b2ad4eb3"],
Cell[7992, 216, 253, 6, 48, "Input",ExpressionUUID->"51044e44-a945-4edf-b266-3587b70a19d6"],
Cell[8248, 224, 1644, 38, 253, "Input",ExpressionUUID->"dc1c30b2-a0d7-468c-8efe-2cbccefe6d17"],
Cell[9895, 264, 243, 6, 48, "Input",ExpressionUUID->"f95bcc4f-6bfe-464a-a552-a4e43ce86171"],
Cell[10141, 272, 1363, 35, 77, "Input",ExpressionUUID->"2b04c139-2f94-48b8-8d61-34d9b95dd5aa"],
Cell[CellGroupData[{
Cell[11529, 311, 736, 18, 77, "Input",ExpressionUUID->"96a91b3d-cbf7-437a-8ff9-c72ba8eb071f"],
Cell[12268, 331, 2106, 45, 126, "Output",ExpressionUUID->"d01f208c-bf7b-4d86-90b7-f42f8904a74d"],
Cell[14377, 378, 1873, 42, 126, "Output",ExpressionUUID->"00e63ce2-3f7c-4c57-8e33-5520fdabd752"]
}, Open  ]],
Cell[16265, 423, 241, 6, 48, "Input",ExpressionUUID->"870bd94f-dc36-421d-9319-812fabbde2e2"],
Cell[16509, 431, 501, 14, 55, "Input",ExpressionUUID->"1c58304f-276a-4fff-a464-3fb29f6917c0"],
Cell[17013, 447, 255, 6, 48, "Input",ExpressionUUID->"1df6e341-2d38-4c91-826a-3c1d1eea106e"],
Cell[17271, 455, 2679, 75, 209, "Input",ExpressionUUID->"eaece362-9924-4902-ad27-cb64d3b2e085"],
Cell[19953, 532, 294, 7, 48, "Input",ExpressionUUID->"da419ad2-19a0-47b3-b179-9a0e53f16796"],
Cell[20250, 541, 2501, 61, 253, "Input",ExpressionUUID->"2dc1f03b-9776-42d0-af25-a5cb88f80a28"],
Cell[22754, 604, 417, 11, 32, "Input",ExpressionUUID->"b3bf015d-c58c-402b-8f4d-3d8bb0dad5b8"],
Cell[CellGroupData[{
Cell[23196, 619, 266, 5, 32, "Input",ExpressionUUID->"94e6e790-6ca4-45ca-8e79-dd56f00a7dd1"],
Cell[23465, 626, 474, 9, 36, "Output",ExpressionUUID->"cfc0a5ed-525b-438d-a804-058a11d7d250"]
}, Open  ]],
Cell[23954, 638, 503, 14, 48, "Input",ExpressionUUID->"61c9a279-14aa-4315-be02-34ce40644024"],
Cell[24460, 654, 9923, 223, 957, "Input",ExpressionUUID->"c6adda7b-8a80-4281-beaf-7c3c90b47bdc"],
Cell[34386, 879, 254, 6, 48, "Input",ExpressionUUID->"a41b5cfc-5af9-496c-8ed5-4384788014ad"],
Cell[34643, 887, 2725, 73, 209, "Input",ExpressionUUID->"bd95f968-bfba-4ab0-ba08-0476279d678a"],
Cell[37371, 962, 290, 7, 61, "Input",ExpressionUUID->"218e8cea-5e9c-4471-b73e-c9c738235ee3"],
Cell[37664, 971, 9558, 209, 781, "Input",ExpressionUUID->"36468c58-a035-49a6-a4de-3bb47bc777bd"],
Cell[CellGroupData[{
Cell[47247, 1184, 669, 15, 32, "Input",ExpressionUUID->"05937a87-855a-463a-a9dc-a1521677c725"],
Cell[CellGroupData[{
Cell[47941, 1203, 232, 5, 23, "Print",ExpressionUUID->"8d3d60f8-1a54-4c31-b162-566bcddf93a3"],
Cell[48176, 1210, 241, 5, 23, "Print",ExpressionUUID->"da833ddf-24f4-43f8-baba-13287c2ef74e"],
Cell[48420, 1217, 237, 5, 23, "Print",ExpressionUUID->"9a7276f5-6bb6-41b8-b999-ac20166e37a7"],
Cell[48660, 1224, 234, 5, 23, "Print",ExpressionUUID->"e44df20a-918b-4c88-bd26-a3ada882ac28"],
Cell[48897, 1231, 258, 5, 23, "Print",ExpressionUUID->"0d8c74cf-7911-414e-ad2f-bc1ad0d301dd"],
Cell[49158, 1238, 237, 5, 23, "Print",ExpressionUUID->"85e63d75-4e18-4673-b0c4-893042e1619d"],
Cell[49398, 1245, 232, 5, 23, "Print",ExpressionUUID->"1f974585-acf8-439f-9421-a49978725eb5"],
Cell[49633, 1252, 258, 5, 23, "Print",ExpressionUUID->"959ad664-a5b7-4ef2-a3cb-396157a66e8b"],
Cell[49894, 1259, 238, 5, 23, "Print",ExpressionUUID->"0c8a7f56-5ba9-47e1-9332-d1c6f498e3f9"],
Cell[50135, 1266, 234, 5, 23, "Print",ExpressionUUID->"62640d81-d8c8-49e2-8081-55d53cc75c8e"],
Cell[50372, 1273, 256, 5, 23, "Print",ExpressionUUID->"7129b30d-5e79-41de-af5c-e0fb61a36770"],
Cell[50631, 1280, 237, 5, 23, "Print",ExpressionUUID->"ebeb9b92-ec14-47c6-8a9e-33e9bec96877"],
Cell[50871, 1287, 234, 5, 23, "Print",ExpressionUUID->"2290edb3-eee6-47f1-982d-adb943e6f3b5"],
Cell[51108, 1294, 258, 5, 23, "Print",ExpressionUUID->"4f3d5013-174a-4ae5-a38b-991c7cd29887"],
Cell[51369, 1301, 237, 5, 23, "Print",ExpressionUUID->"06b2518b-c8de-4d91-985e-315d41775f36"],
Cell[51609, 1308, 232, 5, 23, "Print",ExpressionUUID->"b4dd6ab5-bc31-4eb9-b2aa-164061c88f2d"],
Cell[51844, 1315, 244, 5, 23, "Print",ExpressionUUID->"af9207c7-ac7a-47da-9e4d-1cc7ab843ee7"],
Cell[52091, 1322, 239, 5, 23, "Print",ExpressionUUID->"fe616fd5-3f11-4daf-9ad9-0cd0bb78a92b"],
Cell[52333, 1329, 232, 5, 23, "Print",ExpressionUUID->"7dfb41b1-1c9a-4e26-8f35-1c6620a4c5e5"],
Cell[52568, 1336, 241, 5, 23, "Print",ExpressionUUID->"ef018560-74ba-4940-b3ae-a00312fb1eee"],
Cell[52812, 1343, 239, 5, 23, "Print",ExpressionUUID->"734d6ec6-649c-4ad8-b9c6-63c2373003cb"],
Cell[53054, 1350, 232, 5, 23, "Print",ExpressionUUID->"8a3f3417-b7cb-4fb3-afc6-5a4fcbb9bee1"],
Cell[53289, 1357, 242, 5, 23, "Print",ExpressionUUID->"ce1aa329-ab21-4f44-9d57-3f3d918c76f7"],
Cell[53534, 1364, 237, 5, 23, "Print",ExpressionUUID->"efb7789b-6445-41db-8ae3-c45efeeb2013"],
Cell[53774, 1371, 234, 5, 23, "Print",ExpressionUUID->"4e31b9f1-fb10-4c59-9cce-b894558a1e29"],
Cell[54011, 1378, 242, 5, 23, "Print",ExpressionUUID->"7d91e90e-e6f0-4f94-87b0-b9356caa62a4"],
Cell[54256, 1385, 239, 5, 23, "Print",ExpressionUUID->"ef675657-f9e6-4c29-9685-200300d19299"],
Cell[54498, 1392, 234, 5, 23, "Print",ExpressionUUID->"cc5e44ed-49f0-4379-8643-0800926a2593"],
Cell[54735, 1399, 242, 5, 23, "Print",ExpressionUUID->"feea9999-05c8-4e0f-932e-624219fa9b0e"],
Cell[54980, 1406, 239, 5, 23, "Print",ExpressionUUID->"c34d4a13-9124-4f46-9e20-b46639a71b93"],
Cell[55222, 1413, 232, 5, 23, "Print",ExpressionUUID->"e6aaa8e2-894d-405e-b717-34cc31fdcb07"],
Cell[55457, 1420, 256, 5, 23, "Print",ExpressionUUID->"b6a73f98-1a35-45c9-986b-3ca08c39d422"],
Cell[55716, 1427, 239, 5, 23, "Print",ExpressionUUID->"c7ab9472-fc04-42b5-b0af-d41306b4b1fb"]
}, Open  ]],
Cell[55970, 1435, 240, 4, 36, "Output",ExpressionUUID->"653acebc-bcb5-4e31-8205-29cbc3b50f38"]
}, Open  ]],
Cell[56225, 1442, 251, 6, 48, "Input",ExpressionUUID->"76509af4-f972-48f3-8a24-2d303027df43"],
Cell[CellGroupData[{
Cell[56501, 1452, 2202, 54, 231, "Input",ExpressionUUID->"132d33cb-410c-4157-80c3-5a6126d28bd9"],
Cell[58706, 1508, 253, 4, 36, "Output",ExpressionUUID->"bfdf7e30-a004-4992-ad65-72e200105097"],
Cell[58962, 1514, 250, 4, 36, "Output",ExpressionUUID->"a90cab40-7948-4280-b159-629f4f30fd9c"]
}, Open  ]],
Cell[59227, 1521, 249, 6, 48, "Input",ExpressionUUID->"b8a2612e-6c83-43f5-a790-051a11948a70"],
Cell[CellGroupData[{
Cell[59501, 1531, 579, 11, 32, "Input",ExpressionUUID->"2fd6b94c-9b4b-4da4-9e1f-dd02ef6f734c"],
Cell[60083, 1544, 252, 4, 36, "Output",ExpressionUUID->"c22ca41d-f86f-46ec-919b-4e540fb7f9e7"]
}, Open  ]],
Cell[60350, 1551, 249, 6, 48, "Input",ExpressionUUID->"d5ee46f5-e995-4b1b-841d-af2abfc087e1"],
Cell[60602, 1559, 1114, 30, 77, "Input",ExpressionUUID->"e03a02b0-5cd4-456c-8e85-03a6bad442cb"],
Cell[CellGroupData[{
Cell[61741, 1593, 1237, 25, 121, "Input",ExpressionUUID->"3e32d8d0-8b42-461e-9c7e-80272f38b549"],
Cell[62981, 1620, 2954, 61, 107, "Output",ExpressionUUID->"08c26d9c-52a8-4301-a5b1-316e49d6fa6d"],
Cell[65938, 1683, 1745, 54, 107, "Output",ExpressionUUID->"677506b8-398b-4729-8f88-433ee72d7c4f"]
}, Open  ]],
Cell[67698, 1740, 1319, 33, 77, "Input",ExpressionUUID->"e3960859-381d-4cb6-93f9-d0d9a66d0b42"],
Cell[69020, 1775, 250, 4, 32, "Input",ExpressionUUID->"53a07b0a-cbb3-4dc0-bad1-04c367b0d5c4"],
Cell[CellGroupData[{
Cell[69295, 1783, 350, 8, 32, "Input",ExpressionUUID->"b483b664-3cb9-4710-99a8-76ef2882c4bb"],
Cell[69648, 1793, 2980, 62, 107, "Output",ExpressionUUID->"d302619b-9e97-4e90-8478-0f6a8e5edd29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72665, 1860, 848, 23, 32, "Input",ExpressionUUID->"e5630171-a2cd-472a-b23e-d845665ceac4"],
Cell[73516, 1885, 2594, 47, 107, "Output",ExpressionUUID->"33cbe359-d5b4-4935-922d-c6e5ed96dcfe"]
}, Open  ]],
Cell[76125, 1935, 1234, 31, 77, "Input",ExpressionUUID->"561e578d-9f73-4565-b4e5-fc2d1e02273a"],
Cell[CellGroupData[{
Cell[77384, 1970, 251, 6, 32, "Input",ExpressionUUID->"e6cb8467-13fb-4e8d-a582-b294c2848523"],
Cell[77638, 1978, 6420, 165, 185, "Output",ExpressionUUID->"e2d75929-1f0e-44c7-b9b3-cc672044ae27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84095, 2148, 387, 9, 32, "Input",ExpressionUUID->"7b8a8813-05b5-4d7d-ad0b-991ea2e87615"],
Cell[84485, 2159, 2320, 43, 107, "Output",ExpressionUUID->"04f409d2-76ca-4c06-8bd8-74e0e298b0cb"]
}, Open  ]]
}
]
*)

