(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    133189,       3242]
NotebookOptionsPosition[    125918,       3131]
NotebookOutlinePosition[    126297,       3147]
CellTagsIndexPosition[    126254,       3144]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.740182016817232*^9},ExpressionUUID->"15eb761f-cbea-4d70-86a6-\
89af875bb7de"],

Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "Data", " ", "fetch", " "}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395617607210855`*^9, 
  3.7395617659792604`*^9}},ExpressionUUID->"6333c42e-87f7-4bf2-9c52-\
ef4b9536a477"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prepareData", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tx", ",", " ", "tt", ",", " ", "ty", ",", "txT", ",", " ", "ttT", ",", 
       " ", "tyT", ",", " ", "i", ",", " ", "training", ",", " ", "testing"}],
       "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"training", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], 
          ",", "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testing", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", " ", "\"\<MNIST\>\""}], 
           "}"}], ",", " ", "\"\<TestData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"txT", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"testing", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ttT", " ", "=", " ", 
       RowBox[{"testing", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tyT", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "10000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"tyT", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"ttT", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tx", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"training", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "  ", "=", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ty", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ty", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"tt", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"tx", ",", " ", "ty", ",", " ", "txT", ",", " ", "tyT"}], 
        "}"}], "]"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "}"}], " ", "=", " ", 
   RowBox[{"prepareData", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7395617677082987`*^9, 3.7395617699307814`*^9}, {
  3.7396334647553473`*^9, 
  3.739633465297883*^9}},ExpressionUUID->"8229eef7-ddc5-47a6-a2f7-\
97999efcea5e"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7396724699152308`*^9, 3.739672474209296*^9}, 
   3.73967817822902*^9},ExpressionUUID->"16595a9d-7c8e-4ee3-b2be-\
71badbaafc40"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Xavier", " ", "Initialization", " ", "of", " ", "network", " "}], 
  "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561781963962*^9, 
  3.7395617819659567`*^9}},ExpressionUUID->"2d85b99e-e859-45fe-aa2a-\
950054761b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initializeWeights", "[", 
    RowBox[{
    "hiddennodes1_", ",", " ", "hiddennodes2_", ",", " ", "outputnodes_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mininet", ",", " ", "netinit", ",", " ", "w0", ",", " ", "w1", ",", 
       " ", "w2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mininet", " ", "=", " ", 
       RowBox[{"NetChain", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LinearLayer", "[", "hiddennodes1", "]"}], ",", " ", 
           "Ramp", ",", 
           RowBox[{"LinearLayer", "[", "hiddennodes2", "]"}], ",", " ", 
           "Ramp", ",", " ", 
           RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
           "LogisticSigmoid"}], "}"}], ",", " ", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "784"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"netinit", " ", "=", " ", 
       RowBox[{"NetInitialize", "[", 
        RowBox[{"mininet", ",", " ", 
         RowBox[{"Method", " ", "\[Rule]", 
          RowBox[{"{", "\"\<Xavier\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739568987034275*^9, 
  3.7395689878151846`*^9}},ExpressionUUID->"2981b838-8492-4e60-a8e1-\
78f57677bf64"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739733427344356*^9, 
  3.7397334298621454`*^9}},ExpressionUUID->"9eaa1ee8-58ef-4f58-85af-\
66d828901335"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Define", " ", "network", " ", "variables"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561787772089*^9, 
  3.7395617877750673`*^9}},ExpressionUUID->"05e424f5-5bc8-4626-b94a-\
30e25d2d6108"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningrate", " ", "=", " ", "0.00003"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binAggression", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes1", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes2", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputnodes", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchsize", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"60000", "/", "batchsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilon", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputdim", "  ", "=", " ", "784"}], ";"}]}], "Input",
 CellChangeTimes->{{3.739565612420392*^9, 3.7395656140133944`*^9}, {
   3.7395677842786617`*^9, 3.7395677880326242`*^9}, {3.739567891451046*^9, 
   3.7395678991753798`*^9}, {3.739569188082343*^9, 3.739569191183061*^9}, {
   3.739569346106138*^9, 3.7395693463983707`*^9}, {3.7395696706401925`*^9, 
   3.739569673519461*^9}, {3.7395702306050615`*^9, 3.7395702308244915`*^9}, {
   3.7395704593427057`*^9, 3.7395704750327263`*^9}, {3.7395711703499002`*^9, 
   3.7395711735293837`*^9}, 3.7395767074858584`*^9, 3.7395884852711544`*^9, {
   3.7395888596784735`*^9, 3.7395888598061347`*^9}, {3.739636260203949*^9, 
   3.7396362617769036`*^9}, 3.739636863549868*^9, {3.739651826704251*^9, 
   3.7396518295426702`*^9}, {3.7396778222610264`*^9, 
   3.7396778241479883`*^9}, {3.739732144111354*^9, 3.7397321534114704`*^9}, {
   3.73973343514388*^9, 3.739733438455596*^9}, {3.7397339995675793`*^9, 
   3.7397340024738054`*^9}},ExpressionUUID->"a3598894-949b-4a67-b2de-\
57863b0c499b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{"H", 
     StyleBox["a", "Subtitle",
      FontWeight->"Bold"], "damard"}]], 
   StyleBox[" ", "Subtitle",
    FontWeight->"Bold"], "Binarization", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561826627942*^9, 3.7395618309775496`*^9}, {
  3.7395845310096846`*^9, 
  3.7395845324873695`*^9}},ExpressionUUID->"343c3ee5-345a-40f1-8669-\
79e0ae084770"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"hbGradForward", "[", 
      RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Join", "@@@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"1", ";;", 
               RowBox[{"hBL", "*", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"Dimensions", "@", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "hBL"}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], "]"}], "]"}], 
          "*", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Max", ",", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"#", ";;", 
                    RowBox[{"#", "+", "hBL", "-", "1"}]}]}], "]"}], "]"}], 
                    "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", " ", 
                    RowBox[{
                    RowBox[{"Dimensions", "@", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "-", "hBL", "+", "1"}], 
                    ",", " ", "hBL"}], "]"}], "]"}], ")"}]}], "]"}]}], ",", 
                    " ", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", ";;"}], "]"}], "]"}], ",", " ", "hBL"}], 
                "]"}]}]}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Dimensions", "[", "x", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"hBL", "*", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "@", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "hBL"}], "]"}], 
                   "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], ";;"}]}], "]"}],
             "]"}], "]"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"hBL", "*", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "@", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "hBL"}], "]"}], 
                   "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], ";;"}]}], "]"}],
             "]"}], "]"}]}]}], "}"}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"hbGradForward", "[", 
      RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", 
         " ", "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x2", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"col", " ", "\[LessEqual]", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"col", "++"}], ",", 
          RowBox[{
           RowBox[{"matCreate", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"ArrayReshape", "[", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Ceiling", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
                 "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tempMat", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"Max", ",", " ", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
              " ", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
              "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{"Max", "[", 
                RowBox[{"matCreate", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], 
                "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{"Max", "[", 
                RowBox[{"matCreate", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], 
                "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"row", " ", "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
             RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", 
               " ", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"x2", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
                RowBox[{"tempMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "x2", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hbBackward", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"Clip", "[", 
       RowBox[{"x", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hbWForward", "[", 
      RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", 
         " ", "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x2", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"col", " ", "\[LessEqual]", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"col", "++"}], ",", 
          RowBox[{
           RowBox[{"matCreate", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"ArrayReshape", "[", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Ceiling", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
                 "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tempMat", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"Mean", ",", " ", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
              " ", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
              "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"matCreate", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}],
                 "/", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], 
                 "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{"matCreate", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], 
                "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"row", " ", "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
             RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", 
               " ", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"x2", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
                RowBox[{"tempMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "x2", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hbActForward", "[", 
      RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", 
         " ", "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x2", " ", "=", " ", 
         RowBox[{"Transpose", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"col", " ", "\[LessEqual]", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"col", "++"}], ",", 
          RowBox[{
           RowBox[{"matCreate", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"ArrayReshape", "[", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Ceiling", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
                 "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tempMat", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"Mean", ",", " ", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
              " ", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
              "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"matCreate", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}],
                 "/", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], 
                 "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tempMat", ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{"matCreate", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], 
                "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"row", " ", "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
             RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", 
               " ", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"x2", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
                RowBox[{"tempMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Transpose", "[", "x2", "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"intere", "[", 
       RowBox[{"tempMat_", ",", " ", "x_", ",", " ", "row_"}], "]"}], ":=", 
      " ", 
      RowBox[{
       RowBox[{"tempMat", "[", 
        RowBox[{"[", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"row", "/", "4"}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"Sign", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hbWForwardParallel", "[", 
       RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", 
          " ", "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"col", " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"col", "++"}], ",", 
           RowBox[{
            RowBox[{"matCreate", " ", "=", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"ArrayReshape", "[", 
               RowBox[{
                RowBox[{"x2", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Ceiling", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
                  "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tempMat", " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"Mean", ",", " ", 
               RowBox[{"matCreate", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{";;", 
                   RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
               " ", 
               RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
               "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tempMat", ",", " ", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"matCreate", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}],
                  "/", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], 
                  "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tempMat", ",", " ", 
                RowBox[{"Mean", "[", 
                 RowBox[{"matCreate", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], 
                 "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], "=", " ", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"intere", "[", 
                 RowBox[{"tempMat", ",", " ", "#1", ",", " ", "#2"}], "]"}], 
                "&"}], ",", " ", 
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", " ", "col"}], "]"}], "]"}]}], "]"}]}], 
            " ", ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{"x2", ",", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
       "]"}]}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7395618323377304`*^9, 3.7395618540661335`*^9}, {
   3.73956188930412*^9, 3.7395619082766542`*^9}, {3.739561960447143*^9, 
   3.7395619785341015`*^9}, {3.7395620336076946`*^9, 3.739562042142571*^9}, {
   3.7395621821157913`*^9, 3.739562212240314*^9}, {3.739584269959426*^9, 
   3.739584288751565*^9}, {3.739584393010781*^9, 3.7395844416051097`*^9}, {
   3.739584616853136*^9, 3.73958461845186*^9}, {3.739584777572684*^9, 
   3.7395847777242765`*^9}, {3.73958729539404*^9, 3.739587300790635*^9}, {
   3.7395876852761974`*^9, 3.739587691565344*^9}, {3.739587768519455*^9, 
   3.7395877704423127`*^9}, {3.739587885664836*^9, 3.7395879021086473`*^9}, {
   3.739588070185936*^9, 3.739588077897309*^9}, 3.739633128853849*^9, {
   3.7396333314109635`*^9, 3.7396333572011366`*^9}, {3.7396333879534116`*^9, 
   3.739633396281217*^9}, {3.7396339127839766`*^9, 3.739633948500042*^9}, {
   3.7396344044639034`*^9, 3.7396344765088215`*^9}, {3.7396345801173544`*^9, 
   3.739634595098478*^9}, {3.739635347892541*^9, 3.739635373035454*^9}, {
   3.7396384297686787`*^9, 3.7396384587950315`*^9}, {3.739639210056527*^9, 
   3.739639214076029*^9}, {3.7396733085427265`*^9, 3.739673316347684*^9}, {
   3.7396735297477417`*^9, 3.739673562310857*^9}, {3.7396736348760085`*^9, 
   3.739673672510892*^9}, {3.7396737328157854`*^9, 3.7396737565639153`*^9}, {
   3.7396757046939917`*^9, 3.739675710423674*^9}, {3.739675755019536*^9, 
   3.739675778050513*^9}, {3.739676248414256*^9, 3.739676258844063*^9}, 
   3.739693812640529*^9, {3.7397315907595973`*^9, 3.7397315954719887`*^9}, 
   3.739732053488866*^9},ExpressionUUID->"f6633890-c759-4ccb-88de-\
5f880763ddc6"],

Cell[BoxData[{
 RowBox[{"SeedRandom", "[", "4", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tester", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"11", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tester", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbWForward", "[", 
    RowBox[{"tester", ",", " ", "4"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbActForward", "[", 
    RowBox[{"tester", ",", "4"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbBackward", "[", "tester", "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbGradForward", "[", 
    RowBox[{"tester", ",", " ", "4"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.73958814548086*^9, 3.739588189101438*^9}, {
  3.7395888116469765`*^9, 3.7395888118225102`*^9}, {3.739588851956133*^9, 
  3.7395888521067324`*^9}, {3.739588888082312*^9, 3.7395888956470428`*^9}, {
  3.7395889549633455`*^9, 3.7395889841043806`*^9}, {3.739633134724843*^9, 
  3.73963313520555*^9}, {3.7396339527870784`*^9, 3.7396339623885403`*^9}, {
  3.7396340002549143`*^9, 3.739634081621363*^9}, {3.739634130651366*^9, 
  3.7396341430760837`*^9}, {3.7396342609639025`*^9, 3.7396342738956633`*^9}, {
  3.7396343531156497`*^9, 3.739634357063486*^9}, {3.739634393920173*^9, 
  3.7396343942779093`*^9}, {3.739634576409425*^9, 3.739634634772709*^9}, {
  3.7396387677629657`*^9, 3.7396387950635767`*^9}, {3.7396388262152157`*^9, 
  3.7396388611557245`*^9}, {3.7396507671011515`*^9, 
  3.7396507906060424`*^9}},ExpressionUUID->"0c819410-cf50-4d93-9f66-\
11fa5c112620"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Derivative", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",ExpressionUUID->"53fda235-5223-4e36-9c0b-\
ec505edc1d68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sigmDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"x", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"UnitStep", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739649865713952*^9, 
  3.739649867584631*^9}},ExpressionUUID->"408f5822-b3e1-499a-a1db-\
fd9de3c7095f"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Layer", " ", "evaluator", " ", "function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",ExpressionUUID->"18e0cb9c-f3b5-4b17-ac12-\
f994bd644d9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "layer_Association"}], "]"}], ":=", 
   RowBox[{"layerEval", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", " ", "\"\<LayerType\>\""}], "]"}], ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Sigmoid\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Ramp\>\"", ",", " ", "param_"}], "]"}], " ", 
   ":=", " ", 
   RowBox[{
    RowBox[{"Abs", "[", "x", "]"}], "*", 
    RowBox[{"UnitStep", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<LinearLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<BinLayer\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"hbActForward", "[", 
      RowBox[{"x", ",", " ", "binAggression"}], "]"}], ",", " ", 
     RowBox[{"hbWForward", "[", 
      RowBox[{
       RowBox[{"param", "[", "\"\<Weights\>\"", "]"}], ",", " ", 
       "binAggression"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<BinarizeLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"hbActForward", "[", 
    RowBox[{"x", ",", " ", "binAggression"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Training\>\""}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"FoldList", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Test\>\""}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Fold", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7395847492105637`*^9, 3.7395847618836575`*^9}, 
   3.7395885007537317`*^9, {3.7396347646190033`*^9, 
   3.739634784497941*^9}},ExpressionUUID->"b8b92af7-5dbe-417a-a655-\
801b6a2f9623"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{"initializeWeights", "[", 
    RowBox[{
    "hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "outputnodes"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.740253540170004*^9, 
  3.7402535538271437`*^9}},ExpressionUUID->"afe9369f-9a6d-4c96-803e-\
1aa7f11c50a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"net", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], "|>"}]}]}], 
      "|>"}], ",", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
      "|>"}], ",", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", " ", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
     ",", " ", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",ExpressionUUID->"9807674e-\
f639-4051-b7a3-30bdf8348839"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"netEvaluate", "[", 
   RowBox[{"net", ",", " ", 
    RowBox[{"input", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", " ", "\"\<Test\>\""}], " ",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.7402534438184395`*^9, 3.74025345966739*^9}, {
  3.7402535633671484`*^9, 
  3.7402535842348943`*^9}},ExpressionUUID->"3c931bdf-f65d-4006-8c4a-\
52a47693008b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0013864971935326521`", "0.0015961387729487029`", 
      "0.003646354328123438`", "0.9309853105001306`", 
      "0.0016560295069998538`", "0.018460087116932374`", 
      "0.000011395810026514705`", "0.28606155848939346`", 
      "0.00012903983691902305`", "0.0001148350485886839`"},
     {"0.001777493058158336`", "0.001610279435951827`", 
      "0.02212343386180679`", "0.006786027236700563`", "0.8549996028460822`", 
      "0.028725560588410238`", "0.023022021655160752`", 
      "0.001505240265171648`", "0.013667749378843408`", 
      "0.038985086077031494`"},
     {"0.011637353091149454`", "0.09148927764030475`", "0.06282175647315283`",
       "0.09786509773659254`", "0.10436642759096885`", "0.12271948410520883`",
       "0.024307014878196805`", "0.05676418455848272`", 
      "0.04292199896695365`", "0.3814861902242508`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.740253584737262*^9, 
  3.740254166642826*^9},ExpressionUUID->"04ec23fc-0b93-44a7-887f-\
6e386e2139c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.740253450835905*^9, 
  3.7402534509845324`*^9}},ExpressionUUID->"172787d8-63e3-4217-aa80-\
90430516d281"],

Cell[BoxData[
 RowBox[{"layerEval", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"LinearLayer\"\>"}], ",", 
      RowBox[{"\<\"Parameters\"\>", "\[Rule]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"Weights\"\>", "\[Rule]", "w0"}], 
        "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"Ramp\"\>"}], 
     "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"BinarizeLayer\"\>"}], 
     "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"BinLayer\"\>"}], ",", 
      RowBox[{"\<\"Parameters\"\>", "\[Rule]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"Weights\"\>", "\[Rule]", "w1"}], 
        "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"Ramp\"\>"}], 
     "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"BinLayer\"\>"}], ",", 
      RowBox[{"\<\"Parameters\"\>", "\[Rule]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"Weights\"\>", "\[Rule]", "w2"}], 
        "\[RightAssociation]"}]}]}], "\[RightAssociation]"}], ",", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"Sigmoid\"\>"}], 
     "\[RightAssociation]"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{
  3.7402534474053574`*^9},ExpressionUUID->"ee46ae1b-a99c-4e7f-b17b-\
8ba2f7227a8f"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Back", " ", "Propagation", " ", "algorithm", " "}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{
  3.739584835633086*^9},ExpressionUUID->"0a449b43-c3d4-4daf-b7b4-\
33579ede53ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"backProp", "[", 
    RowBox[{
    "fullnet_", ",", " ", "w0_", ",", " ", "w1_", ",", " ", "w2_", ",", " ", 
     "input_", ",", " ", "target_", ",", " ", "l3M_", ",", " ", "l3V_", ",", 
     "  ", "l2M_", ",", " ", "l1M_", ",", " ", "l2V_", ",", " ", "l1V_", " ", 
     ",", " ", "iteration_", ",", " ", "lr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l3Error", ",", " ", "l3Delta", ",", " ", "l2Error", ",", " ", 
       "l2Delta", ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g2", 
       ",", " ", "g1", ",", " ", "g0", ",", " ", "l0", ",", " ", "l1", ",", 
       " ", "l2", ",", " ", "l3", ",", " ", "l1MC", ",", " ", "l1VC", ",", 
       " ", "l2MC", ",", " ", "l2VC", ",", " ", "l3MC", ",", " ", "l3VC", ",",
        " ", "l3MT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l3VT", 
       ",", " ", "l2VT", ",", " ", "l1VT", ",", " ", "w2T", ",", " ", "w1T", 
       ",", " ", "w0T", ",", " ", "w2UDT", ",", "  ", "w1UDT", ",", " ", 
       "w0UDT"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l3MT", " ", "=", " ", "l3M"}], ";", " ", 
      RowBox[{"l3VT", " ", "=", " ", "l3V"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", "l2M"}], ";", " ", 
      RowBox[{"l2VT", " ", "=", " ", "l2V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", "l1M"}], ";", " ", 
      RowBox[{"l1VT", " ", "=", " ", "l1V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "=", " ", "w2"}], ";", " ", 
      RowBox[{"w1T", " ", "=", " ", "w1"}], ";", " ", 
      RowBox[{"w0T", " ", "=", " ", "w0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Error", " ", "=", " ", 
       RowBox[{
        RowBox[{"fullnet", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", "target"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Delta", " ", "=", " ", 
       RowBox[{"l3Error", "*", 
        RowBox[{"sigmDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"l2Error", " ", "=", " ", 
       RowBox[{"hbBackward", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"hbActForward", "[", "l3Delta", "]"}], ",", " ", 
          RowBox[{"Transpose", "@", 
           RowBox[{"hbWForward", "[", 
            RowBox[{"w2", ",", " ", "binAggression"}], "]"}]}]}], "]"}], 
        "]"}]}], ";", "          ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"l2Delta", " ", "=", " ", 
       RowBox[{"l2Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"l1Error", " ", "=", " ", 
       RowBox[{"hbBackward", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"hbActForward", "[", "l2Delta", "]"}], ",", " ", 
          RowBox[{"Transpose", "@", 
           RowBox[{"hbWForward", "[", 
            RowBox[{"w1", ",", " ", "binAggression"}], "]"}]}]}], "]"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"l1Delta", " ", "=", " ", 
       RowBox[{"l1Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", " ", "l3Delta"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", " ", "l2Delta"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g0", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", "l1Delta"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", "Works", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l3MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g2", "*", "g2"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l1MC", " ", "=", " ", 
       RowBox[{"l1MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l1VC", " ", "=", " ", 
       RowBox[{"l1VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l2MC", " ", "=", " ", 
       RowBox[{"l2MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l2VC", " ", "=", " ", 
       RowBox[{"l2VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l3MC", " ", "=", " ", 
       RowBox[{"l3MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l3VC", " ", "=", " ", 
       RowBox[{"l3VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"w2UDT", " ", "=", " ", 
       RowBox[{"l3MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l3VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w1UDT", " ", "=", " ", 
       RowBox[{"l2MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0UDT", " ", "=", " ", 
       RowBox[{"l1MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w2UDT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w1UDT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w0T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w0UDT"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "w0T", ",", " ", "w1T", ",", " ", "w2T", ",", " ", "l3MT", ",", " ", 
         "l3VT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l2VT", ",", 
         " ", "l1VT"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7395848417399826`*^9, 3.739584898375646*^9}, {
   3.7395883812874994`*^9, 3.739588390980565*^9}, {3.7396348724506025`*^9, 
   3.7396348829634295`*^9}, 3.73963543628629*^9, {3.739635526460492*^9, 
   3.739635551492106*^9}, {3.739635840616089*^9, 3.739635857990718*^9}, {
   3.7396359407126255`*^9, 3.739635985550721*^9}, {3.7396361212079225`*^9, 
   3.739636130229994*^9}, {3.739636165645355*^9, 3.739636222050232*^9}, {
   3.73963627805686*^9, 3.7396362812768927`*^9}, {3.7396369757214284`*^9, 
   3.7396369912954392`*^9}, {3.7396370357849216`*^9, 3.739637077546963*^9}, {
   3.7396371142981353`*^9, 3.739637115694554*^9}, {3.7396396838927794`*^9, 
   3.739639687444704*^9}, {3.7396398906200423`*^9, 3.7396399119961004`*^9}, {
   3.739649949281593*^9, 3.7396499540743556`*^9}, {3.739650009620364*^9, 
   3.7396500418613644`*^9}, {3.7396508294580154`*^9, 
   3.7396508552865677`*^9}, {3.7396777934520884`*^9, 
   3.7396778057182693`*^9}},ExpressionUUID->"de1e4a2d-a305-4f3e-b1c0-\
5ecad2be69f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{"initializeWeights", "[", 
    RowBox[{
    "hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "outputnodes"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"w0", "//", "Dimensions"}]}], "Input",
 CellChangeTimes->{
  3.7396362788668876`*^9, {3.7396498958217835`*^9, 3.7396499148443565`*^9}, {
   3.739732367320259*^9, 
   3.7397323776621075`*^9}},ExpressionUUID->"28e6a493-2a32-48c8-bc7a-\
4efaec9e36d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"784", ",", "128"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7397323777738085`*^9},ExpressionUUID->"f02b2f89-2882-42d1-b4dc-\
61eefac76a63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"hbActForward", "[", 
   RowBox[{"w1", ",", " ", "binAggression"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7396499200842705`*^9, 3.7396499418939543`*^9}, {
  3.7396502582403793`*^9, 3.739650280913554*^9}, {3.739733466578742*^9, 
  3.739733473590092*^9}},ExpressionUUID->"6b20eb6d-f711-4723-9040-\
0a4a52ec41b2"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"1\\\", \\\"}\\\"}]\\) does not exist.\"",2,43,2,30268110263912331034,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7397334635309954`*^9, 
  3.7397334749896984`*^9}},ExpressionUUID->"33874020-da51-4b5e-94fb-\
bbf0b01ca2cc"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Accuracy", " ", "Testing", " ", "Function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739635433855397*^9, 
  3.7396354409796667`*^9}},ExpressionUUID->"42fed18f-ef9b-49b9-8fe0-\
6fc993c0c59e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "testnum_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
          "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"netEvaluate", "[", 
           RowBox[{"net", ",", " ", 
            RowBox[{"input", "[", 
             RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}],
            "]"}], "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"target", "[", 
          RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "1"}], "]"}], " ", 
       "-", " ", "1"}]}], "}"}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"accTest", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "numTest_"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y", ",", " ", "pred", ",", "l"}], "}"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"y", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", " ", 
        RowBox[{"x", "\[LessEqual]", 
         RowBox[{"numTest", "-", "4"}]}], ",", " ", 
        RowBox[{"x", "+=", "4"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pred", "=", 
          RowBox[{"netEvaluate", "[", 
           RowBox[{"net", ",", " ", 
            RowBox[{"input", "[", 
             RowBox[{"[", 
              RowBox[{"x", ";;", 
               RowBox[{"x", "+", "4"}]}], "]"}], "]"}], ",", " ", 
            "\"\<Test\>\""}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"l", " ", "=", "1"}], ",", " ", 
           RowBox[{"l", "\[LessEqual]", " ", "4"}], ",", " ", 
           RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"pred", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], ",", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"pred", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}], "==", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"target", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", "+", "l", "-", "1"}], "]"}], "]"}], ",", " ", 
                "1"}], "]"}]}], " ", ",", 
             RowBox[{"y", "++"}]}], "]"}]}], "]"}], ";"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"y", "/", 
        RowBox[{"(", 
         RowBox[{"numTest", "-", "4"}], ")"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.7395848558484273`*^9, 3.739584902077775*^9, {3.739651103902723*^9, 
   3.7396511184459486`*^9}, {3.739651424168208*^9, 3.7396515704747744`*^9}, {
   3.739676429793722*^9, 
   3.739676431373847*^9}},ExpressionUUID->"277b590c-4871-469f-93ef-\
a7ddbc9cdee3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"Network", " ", "run", " ", "function", " "}], "Subtitle",
   FontWeight->"Bold"]}]], "Input",
 CellChangeTimes->{{3.7396512264619436`*^9, 
  3.73965123084533*^9}},ExpressionUUID->"2e022dc5-dbec-46fa-a7dd-\
e38d1d7f6e93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runNet", "[", 
   RowBox[{
   "input_", ",", " ", "target_", ",", " ", "testinp_", ",", " ", "testtar_", 
    ",", " ", "import_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iteration", ",", " ", "fullnet", ",", " ", "w0", ",", " ", "w1", ",", 
      " ", "w2", ",", "l3M", ",", " ", "l3V", ",", " ", "l2M", ",", " ", 
      "l1M", ",", " ", "l2V", ",", " ", "l1V", ",", "\[IndentingNewLine]", 
      "l3Error", ",", " ", "l3Delta", ",", "l2Error", ",", " ", "l2Delta", 
      ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g1", ",", " ", 
      "g0", ",", " ", "l0", ",", " ", "l1", ",", " ", "l2", ",", "l3", ",", 
      " ", "l1MC", ",", " ", "l1VC", ",", " ", "l2MC", ",", " ", "l2VC", ",", 
      " ", "l3MC", ",", " ", "l3VC", ",", " ", "w2UDT", ",", " ", "w1UDT", 
      ",", " ", "w0UDT", ",", " ", "epoch", ",", " ", "lr", ",", " ", "net"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"import", " ", "\[Equal]", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
        RowBox[{"initializeWeights", "[", 
         RowBox[{"hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "10"}], 
         "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", 
         " ", 
         RowBox[{"Import", "[", "\"\<HBNNamaze.dat\>\"", "]"}]}], ";", " ", 
        RowBox[{"w0", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"w0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"784", ",", " ", "hiddennodes1"}], "}"}]}], "]"}]}], ";", 
        " ", 
        RowBox[{"w1", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"w1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"hiddennodes1", ",", " ", "hiddennodes2"}], "}"}]}], 
          "]"}]}], ";", " ", 
        RowBox[{"w2", " ", "=", " ", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"w2", ",", " ", 
           RowBox[{"{", 
            RowBox[{"hiddennodes2", ",", " ", "outputnodes"}], "}"}]}], 
          "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"epoch", " ", "=", " ", "epochs"}], ";", "\[IndentingNewLine]", 
     RowBox[{"net", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
          ",", " ", 
          RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], 
            "|>"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
        ",", "\[IndentingNewLine]", " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
         "|>"}], ",", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
          " ", 
          RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
          " ", 
          RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
        ",", " ", "\[IndentingNewLine]", " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], 
         "|>"}]}], "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"l3M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l3V", " ", "=", " ", "0"}], ";", 
     RowBox[{"l2M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l2V", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1V", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Iterator", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<started\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iteration", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"iteration", "\[LessEqual]", " ", "iterations"}], ",", " ", 
       RowBox[{"iteration", "+=", "batchsize"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "iteration", " ", "ends", " ", "and", " ", "epoch", " ", 
          "isnt", " ", "0"}], ",", " ", 
         RowBox[{"reset", " ", "iteration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"iteration", " ", "\[GreaterEqual]", " ", 
             RowBox[{"iterations", " ", "-", " ", "32"}]}], ",", " ", 
            RowBox[{"epoch", "\[GreaterEqual]", "1"}]}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"iteration", "=", "1"}], ";", " ", 
           RowBox[{"epoch", "-=", "1"}], ";", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<epoch \>\"", "epoch"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Training acc\>\"", " ", 
             StyleBox[
              RowBox[{"N", "[", 
               RowBox[{"accTest", "[", 
                RowBox[{
                "net", ",", " ", "input", ",", " ", "target", ",", " ", 
                 "100"}], "]"}], "]"}],
              FontWeight->"Bold"]}], 
            StyleBox["]",
             FontWeight->"Bold"]}], 
           StyleBox[";",
            FontWeight->"Bold"], 
           StyleBox["\[IndentingNewLine]",
            FontWeight->"Bold"], 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Test acc\>\"", " ", 
             RowBox[{"N", "[", 
              RowBox[{"accTest", "[", 
               RowBox[{
               "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", 
                "100"}], "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "net", " ", "weights"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"net", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], 
               "|>"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}],
             "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], 
            "|>"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Evaluate", " ", "the", " ", "net"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"fullnet", " ", "=", " ", 
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "\"\<Training\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Back", " ", "prop"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lr", " ", "=", " ", 
         RowBox[{"learningrate", "*", 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"0.1", "*", "epoch"}]}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "w0", ",", " ", "w1", ",", "w2", ",", " ", "l3M", ",", " ", "l3V", 
           ",", " ", "l2M", ",", " ", "l1M", ",", " ", "l2V", ",", " ", 
           "l1V"}], "}"}], " ", "=", " ", 
         RowBox[{"backProp", "[", 
          RowBox[{
          "fullnet", ",", " ", "w0", ",", " ", "w1", ",", " ", "w2", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"target", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "l3M", ",", " ", "l3V", ",", "  ", "l2M", ",", " ", "l1M", 
           ",", " ", "l2V", ",", " ", "l1V", ",", " ", "iteration", ",", " ", 
           "lr"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7395883114802604`*^9, 3.7395883309322195`*^9}, 
   3.739635047330617*^9, {3.7396352259870825`*^9, 3.739635232073212*^9}, 
   3.7396506186339207`*^9, 3.7396509241638713`*^9, {3.7396509824558277`*^9, 
   3.739650982586478*^9}, {3.7396511271825304`*^9, 3.739651131663402*^9}, {
   3.7396518486385636`*^9, 3.7396518490046077`*^9}, 3.7396730474382486`*^9, 
   3.73973225453891*^9, {3.739732420978218*^9, 3.7397324374720917`*^9}, {
   3.7397335232031846`*^9, 
   3.73973354913492*^9}},ExpressionUUID->"ed0d687e-ead2-4ae8-8b3a-\
260e037d746f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{"runNet", "[", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar", 
     ",", " ", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7396350786257167`*^9, 3.7396350963609495`*^9}, {
  3.739635235949365*^9, 3.7396352372462893`*^9}, {3.739637167289872*^9, 
  3.739637169325842*^9}, {3.7396398258011045`*^9, 3.7396398261502857`*^9}, {
  3.7396509496632586`*^9, 3.7396509527788234`*^9}, {3.7397321615576773`*^9, 
  3.7397321907924604`*^9}, {3.7397322647456064`*^9, 3.7397322662555623`*^9}, {
  3.7397332527436795`*^9, 3.739733252853386*^9}, {3.7397332835831704`*^9, 
  3.739733284331173*^9}},ExpressionUUID->"f9bd6f44-03e8-4d90-82aa-\
d964092f46b3"],

Cell[BoxData["\<\"started\"\>"], "Print",
 CellChangeTimes->{
  3.7397321669422703`*^9, 3.739732260568776*^9, 3.7397324408460655`*^9, 
   3.7397331385129633`*^9, 3.7397334819034815`*^9, {3.7397335328006115`*^9, 
   3.7397335526966133`*^9}},ExpressionUUID->"16895f02-2080-4f09-b35e-\
8a9b6d14c181"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.739733529643321*^9, 3.739733543773143*^9}, 
   3.7397339875966434`*^9},ExpressionUUID->"1b5e00c5-a66d-45f4-acf6-\
cca68453f2e0"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7397339902215843`*^9, 
  3.7397339938887715`*^9}},ExpressionUUID->"325287a2-dbbe-436b-b6e0-\
fc6adc845a96"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"accTest", "[", 
   RowBox[{
   "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", "10000"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7396512392802887`*^9, 3.739651264451926*^9}, {
  3.739651385366021*^9, 3.7396513903237567`*^9}, {3.73965159372058*^9, 
  3.739651629504842*^9}, {3.739667505717419*^9, 
  3.7396675069870234`*^9}},ExpressionUUID->"475e5c3d-2fa2-4d36-b3f8-\
9d5f89b84137"],

Cell[BoxData["0.8532`"], "Output",
 CellChangeTimes->{{3.7396516300084934`*^9, 3.7396516349702187`*^9}, 
   3.7396678099125633`*^9},ExpressionUUID->"0aa585b9-f775-487f-bd8b-\
b675ba7c7d35"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<HBNNamaze6464.dat\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7396674894718833`*^9, 3.7396675024631267`*^9}, {
  3.7396778372758837`*^9, 
  3.7396778375441513`*^9}},ExpressionUUID->"13f927e5-ac8e-494f-a479-\
a7f06d427340"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
    RowBox[{"Import", "[", "\"\<HBNNamaze.dat\>\"", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w0", " ", "=", " ", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"784", ",", " ", "hiddennodes1"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w1", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"hiddennodes1", ",", " ", "hiddennodes2"}], "]"}]}], ";", " ", 
  RowBox[{"w2", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"hiddennodes2", ",", " ", "outputnodes"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7397322895402675`*^9, 3.739732301221526*^9}, {
  3.739732395615076*^9, 
  3.739732411325048*^9}},ExpressionUUID->"d1ebd015-e7c5-41dc-a5d7-\
ed132d2afdf0"],

Cell[BoxData[
 TemplateBox[{
  "ArrayReshape","listrp",
   "\"List or SparseArray or StructuredArray expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"ArrayReshape\\\", \
\\\"[\\\", RowBox[{\\\"784\\\", \\\",\\\", \\\"128\\\"}], \\\"]\\\"}]\\).\"",
   2,988,105,30268070378384777510,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.739732399738047*^9},ExpressionUUID->"5d44c1d0-9706-45d7-83fc-\
aa488b2f3f69"],

Cell[BoxData[
 TemplateBox[{
  "ArrayReshape","listrp",
   "\"List or SparseArray or StructuredArray expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"ArrayReshape\\\", \
\\\"[\\\", RowBox[{\\\"128\\\", \\\",\\\", \\\"128\\\"}], \\\"]\\\"}]\\).\"",
   2,988,106,30268070378384777510,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.739732399774949*^9},ExpressionUUID->"a7d31531-77bb-4766-a1e7-\
41adf4a304a0"],

Cell[BoxData[
 TemplateBox[{
  "ArrayReshape","listrp",
   "\"List or SparseArray or StructuredArray expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"ArrayReshape\\\", \
\\\"[\\\", RowBox[{\\\"128\\\", \\\",\\\", \\\"10\\\"}], \\\"]\\\"}]\\).\"",2,
   988,107,30268070378384777510,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73973239980886*^9},ExpressionUUID->"21fcd52d-864f-41ce-a6b5-da715408ef45"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ArrayReshape\\\", \
\\\"::\\\", \\\"listrp\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,988,108,30268070378384777510,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7397323998457565`*^9},ExpressionUUID->"0dbdaecc-329b-44fa-96fc-\
2a64e840c882"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArrayReshape", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"784", ",", " ", "128"}], "}"}]}], "]"}], "//", 
  "Dimensions"}]], "Input",
 CellChangeTimes->{{3.739732303838529*^9, 
  3.7397323330858526`*^9}},ExpressionUUID->"11eeac4d-0bae-4c4e-b8c1-\
1d32c9f7c993"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"784", ",", "128"}], "}"}]], "Output",
 CellChangeTimes->{{3.739732310576501*^9, 
  3.73973233313871*^9}},ExpressionUUID->"68fdc680-19cd-40a3-9e2a-\
acc3ec0eccd1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Redefine", " ", "net", " ", "weights"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
     RowBox[{"Import", "[", "\"\<HBNNamaze.dat\>\"", "]"}]}], ";", " ", 
    RowBox[{"w0", " ", "=", " ", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"w0", ",", " ", 
       RowBox[{"{", 
        RowBox[{"784", ",", " ", "hiddennodes1"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"w1", " ", "=", " ", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"w1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"hiddennodes1", ",", " ", "hiddennodes2"}], "}"}]}], "]"}]}], 
    ";", " ", 
    RowBox[{"w2", " ", "=", " ", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"w2", ",", " ", 
       RowBox[{"{", 
        RowBox[{"hiddennodes2", ",", " ", "outputnodes"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"net", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",",
          " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], "|>"}]}]}],
         "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
        "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
         " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
         " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}],
       "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.739734025547075*^9, {3.739734107023088*^9, 3.7397341088162947`*^9}, {
   3.739734336322613*^9, 
   3.739734337746801*^9}},ExpressionUUID->"8dfb1ffe-9545-491b-b75a-\
36b2470cff30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"accTest", "[", 
   RowBox[{"net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", "10"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.73973402830669*^9, 3.739734066786738*^9}, {
   3.7397341163391633`*^9, 3.7397341188205247`*^9}, 
   3.73973493447435*^9},ExpressionUUID->"cd9434f5-b8c6-4d57-a97b-\
3128168e77a5"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.7397340322082872`*^9, 3.739734064725254*^9}, {
  3.739734097280154*^9, 
  3.7397341144222927`*^9}},ExpressionUUID->"5c79c82a-7fc0-4e40-9a55-\
e3343eb2c06a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"impoz", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<data.wxf\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739734061781131*^9, 3.739734062683715*^9}, {
  3.7402540277500525`*^9, 
  3.7402540378524375`*^9}},ExpressionUUID->"c60cadb4-2451-41ef-b435-\
833acf0701b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w0", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"impoz", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"784", "*", "128"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"784", ",", " ", "128"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7402540395310197`*^9, 
  3.740254076571605*^9}},ExpressionUUID->"9c75e0f3-4361-4382-9f68-\
048a8c4c5fba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w1", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"impoz", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"784", "*", "128"}], "+", "1"}], ")"}], ";;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"784", "*", "128"}], "+", "1", "+", 
          RowBox[{"128", "*", "128"}]}], ")"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"128", ",", " ", "128"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7402540785010595`*^9, 
  3.7402541236411767`*^9}},ExpressionUUID->"6331c8e1-087d-4983-9572-\
8a1be238d0e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"impoz", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"784", "*", "128"}], "+", "1", "+", 
          RowBox[{"128", "*", "128"}]}], ")"}], ";;"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"128", ",", " ", "10"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7402541255402627`*^9, 
  3.740254157452506*^9}},ExpressionUUID->"0db43dd4-6b51-4aff-8e43-\
903691459d46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"8", ",", "8"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbWForward", "[", 
    RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", " ",
        "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x2", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"col", " ", "\[LessEqual]", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"col", "++"}], ",", 
        RowBox[{
         RowBox[{"matCreate", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
               "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempMat", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", " ", 
            RowBox[{"matCreate", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
            " ", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
            "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"matCreate", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}], 
              "/", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}]}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{"Mean", "[", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"row", " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
              RowBox[{"tempMat", "[", 
               RowBox[{"[", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "x2", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.740238309593739*^9, 
  3.740238357368127*^9}},ExpressionUUID->"99920214-c94a-4cee-aaba-\
e4da3f622110"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"256", ",", " ", "256"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectorFP", " ", "=", " ", 
   RowBox[{"Flatten", "@", "k"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectorHBNN", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"hbWForward", "[", 
     RowBox[{"k", ",", " ", 
      RowBox[{"512", "*", "16"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VectorAngle", "[", 
   RowBox[{"vectorFP", ",", " ", "vectorHBNN"}], "]"}], "/", 
  "Degree"}]}], "Input",
 CellChangeTimes->{{3.7402650292232666`*^9, 3.7402650755708575`*^9}, {
  3.740265113894371*^9, 3.740265164312202*^9}, {3.740265200751277*^9, 
  3.7402652812145667`*^9}, {3.7402653973263087`*^9, 3.740265404184577*^9}, {
  3.7402655162339973`*^9, 
  3.7402655180475187`*^9}},ExpressionUUID->"7a8f509a-eb8b-40c3-b8e3-\
2ea38f4abb7e"],

Cell[BoxData["36.84368153232048`"], "Output",
 CellChangeTimes->{
  3.7402655194818287`*^9},ExpressionUUID->"9c9f7813-61ee-4c76-99a5-\
71d5ee40b250"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.740265437149267*^9, 
  3.7402654380623894`*^9}},ExpressionUUID->"4ddd2553-040d-47f7-bbdc-\
142b58950499"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "5", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbActForward", "[", 
    RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", " ",
        "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x2", " ", "=", " ", 
       RowBox[{"Transpose", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"col", " ", "\[LessEqual]", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"col", "++"}], ",", 
        RowBox[{
         RowBox[{"matCreate", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
               "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempMat", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", " ", 
            RowBox[{"matCreate", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
            " ", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
            "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"matCreate", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}], 
              "/", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}]}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{"Mean", "[", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"row", " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
              RowBox[{"tempMat", "[", 
               RowBox[{"[", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Transpose", "[", "x2", "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"256", ",", " ", "256"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], " ", ":=", "  ", 
   RowBox[{
    RowBox[{"VectorAngle", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", "matrix"}], ",", " ", 
      RowBox[{"Flatten", "@", 
       RowBox[{"hbWForward", "[", 
        RowBox[{"matrix", ",", " ", "x"}], "]"}]}]}], "]"}], "/", 
    "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Range", "@", "10"}], " ", "-", " ", "1"}], ")"}]}], ",", 
      " ", 
      RowBox[{"Map", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Range", "@", "10"}], " ", "-", " ", "1"}], ")"}]}]}], 
       "]"}]}], "}"}], "]"}], ",", " ", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Log\>\"", ",", " ", "\"\<Linear\>\""}], "}"}]}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Binarization Aggression\>\"", ",", " ", "\"\<Angle\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7402654222841206`*^9, 
  3.740265810756692*^9}},ExpressionUUID->"b6a55cf7-5257-46e3-962c-\
8f8903a01576"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     LineBox[{{0., 0.}, {0.6931471805599453, 25.20144202197493}, {
      1.3862943611198906`, 31.434935715462156`}, {2.0794415416798357`, 
      34.29653768499112}, {2.772588722239781, 35.658324254189885`}, {
      3.4657359027997265`, 36.31171681074954}, {4.1588830833596715`, 
      36.66633100219883}, {4.852030263919617, 36.83096730537163}, {
      5.545177444479562, 36.9212748337701}, {6.238324625039508, 
      36.921274833770106`}}]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Binarization Aggression\"", TraditionalForm], 
    FormBox["\"Angle\"", TraditionalForm]},
  AxesOrigin->{-0.12996509635498976`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Exp[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Exp[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-0.12996509635498976`, 6.238324625039508}, {
    0, 36.921274833770106`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , {{-5, 
       FormBox[
        RowBox[{"-", "5"}], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {0, 
       FormBox["0", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {5, 
       FormBox["5", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {10, 
       FormBox["10", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {15, 
       FormBox["15", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {20, 
       FormBox["20", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {25, 
       FormBox["25", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {30, 
       FormBox["30", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {35, 
       FormBox["35", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {40, 
       FormBox["40", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-5., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-4., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-3., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-1., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {2., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {3., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {7., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {9., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {10., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {12., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {13., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {14., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {15., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {16., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {17., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {18., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {19., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {20., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {21., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {22., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {23., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {24., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {25., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {26., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {27., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {28., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {29., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {30., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {31., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {32., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {33., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {34., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {35., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {36., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {37., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {38., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {39., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {40., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}}}, {{{0., 
       FormBox["1", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
       FormBox["5", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {3.912023005428146, 
       FormBox["50", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {4.605170185988092, 
       FormBox["100", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {6.214608098422191, 
       FormBox["500", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {0.6931471805599453, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.791759469228055, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {2.0794415416798357`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {2.1972245773362196`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {2.995732273553991, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {3.4011973816621555`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {3.6888794541139363`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4.0943445622221, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4.248495242049359, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4.382026634673881, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4.499809670330265, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.298317366548036, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.703782474656201, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.991464547107982, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.396929655216146, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.551080335043404, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.684611727667927, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.802394763324311, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {7.313220387090301, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {7.600902459542082, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}}, {{-5., 
       FormBox[
        RowBox[{"-", "5"}], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {0., 
       FormBox["0", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {5., 
       FormBox["5", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {10., 
       FormBox["10", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {15., 
       FormBox["15", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {20., 
       FormBox["20", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {25., 
       FormBox["25", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {30., 
       FormBox["30", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {35., 
       FormBox["35", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {40., 
       FormBox["40", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-5., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-4., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-3., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-1., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {2., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {3., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {4., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {7., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {9., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {10., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {12., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {13., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {14., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {15., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {16., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {17., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {18., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {19., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {20., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {21., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {22., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {23., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {24., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {25., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {26., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {27., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {28., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {29., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {30., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {31., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {32., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {33., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {34., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {35., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {36., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {37., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {38., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {39., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {40., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}}}]]], "Output",
 CellChangeTimes->{{3.74026572443894*^9, 
  3.7402658145063267`*^9}},ExpressionUUID->"d368647d-ab68-4656-a14f-\
13aad80229b7"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7402656275042768`*^9, 
  3.740265628506734*^9}},ExpressionUUID->"3b774120-6907-4f3a-a711-\
9586c5b093b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vectorHBNN", "//", "Dimensions"}]], "Input",
 CellChangeTimes->{{3.7402651831736364`*^9, 
  3.740265192145799*^9}},ExpressionUUID->"159cb67c-c52a-4a51-8676-\
0021cd6c70b6"],

Cell[BoxData[
 RowBox[{"{", "256", "}"}]], "Output",
 CellChangeTimes->{{3.740265186274205*^9, 
  3.7402651924380493`*^9}},ExpressionUUID->"7698de74-475e-4e1f-a81b-\
b9651ae1ce6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "^", 
  RowBox[{"Range", "@", "5"}]}]], "Input",
 CellChangeTimes->{{3.740265167221034*^9, 3.740265174608252*^9}, {
  3.7402652395915723`*^9, 3.7402652714011407`*^9}, {3.740265475790378*^9, 
  3.740265478064083*^9}},ExpressionUUID->"e560346f-c494-4938-a39b-\
76d5df3a1bd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "8", ",", "16", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7402651752501183`*^9, {3.7402652060677476`*^9, 3.7402652084318757`*^9}, {
   3.7402652409438024`*^9, 3.740265269814108*^9}, 
   3.7402654783812413`*^9},ExpressionUUID->"60293d41-90d7-4625-879c-\
f15b4c20fd04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", "x"}]], "Input",
 CellChangeTimes->{{3.740240049652214*^9, 
  3.7402400552762403`*^9}},ExpressionUUID->"7f6b486d-62c7-4f7f-8eee-\
10492d5afd35"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.2364128763773778`"}], "0.6173927206316732`", 
      "0.4615472325474502`", 
      RowBox[{"-", "0.3786575860941712`"}], "0.3984990863895783`", 
      RowBox[{"-", "0.4017689982729067`"}], 
      RowBox[{"-", "0.06168834250130127`"}], "0.6148504250721212`"},
     {"1.0848004500845636`", "1.2893263270111117`", "0.5784666076912043`", 
      RowBox[{"-", "0.4417320521729047`"}], 
      RowBox[{"-", "0.4363874602391835`"}], "1.4803965255270186`", 
      RowBox[{"-", "0.4988076478290233`"}], "0.9167603276389777`"},
     {
      RowBox[{"-", "0.747106391104156`"}], 
      RowBox[{"-", "0.5674435970843081`"}], 
      RowBox[{"-", "0.04301381401462767`"}], "0.09883407983584801`", 
      RowBox[{"-", "1.773303676514748`"}], "0.038325809746323394`", 
      "0.295998183844801`", 
      RowBox[{"-", "1.0801823180048333`"}]},
     {"0.8756102178470675`", 
      RowBox[{"-", "1.9559677342080521`"}], 
      RowBox[{"-", "1.1845886146332336`"}], 
      RowBox[{"-", "1.1716990845186501`"}], "0.7326963240548475`", 
      "0.6455605388866987`", "1.1156300115753888`", "0.31898619186618643`"},
     {"0.3637199965895952`", "0.2939222479079313`", "0.6336550096098187`", 
      RowBox[{"-", "0.5174896681036392`"}], "2.529251557540651`", 
      RowBox[{"-", "0.19229084773797517`"}], 
      RowBox[{"-", "1.3909381099964198`"}], "1.164832113770791`"},
     {
      RowBox[{"-", "2.007022818254686`"}], 
      RowBox[{"-", "0.5304082227598396`"}], "0.006583341847340743`", 
      RowBox[{"-", "3.1666801226028847`"}], "0.3192875909326496`", 
      RowBox[{"-", "0.825422600350346`"}], "0.23127433863013494`", 
      RowBox[{"-", "0.34978208255019866`"}]},
     {
      RowBox[{"-", "0.27057137386112773`"}], "0.8417504461194801`", 
      RowBox[{"-", "0.3736481151079818`"}], 
      RowBox[{"-", "0.5116428940157959`"}], 
      RowBox[{"-", "0.6639751268962892`"}], 
      RowBox[{"-", "0.44899061926251715`"}], 
      RowBox[{"-", "1.380021543052434`"}], "0.1362712787944137`"},
     {"0.5715438060878627`", "1.4964049278363774`", "0.05635824929509967`", 
      "1.495211473297225`", "0.5343487548502357`", 
      RowBox[{"-", "0.13558056443457847`"}], 
      RowBox[{"-", "2.3447418721776434`"}], "1.0243374236002565`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.740240055547515*^9},ExpressionUUID->"cdeb7940-0de8-4dfa-8fed-\
cf4cdd7e0e18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"hbWForward", "[", 
   RowBox[{"x", ",", " ", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7402400571821823`*^9, 
  3.7402400712183905`*^9}},ExpressionUUID->"d8e6b5f8-1a45-494c-805d-\
b1adefc447e8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.6904357949530306`"}], "0.8331449019874602`", 
      RowBox[{"-", "1.5383972153673966`"}], 
      RowBox[{"-", "0.8177250397318042`"}], "0.6438259633709631`", 
      "1.0467828986728547`", 
      RowBox[{"-", "0.7490079622730499`"}], "0.39209258850280077`"},
     {
      RowBox[{"-", "0.6904357949530306`"}], 
      RowBox[{"-", "0.8331449019874602`"}], 
      RowBox[{"-", "1.5383972153673966`"}], "0.8177250397318042`", 
      "0.6438259633709631`", "1.0467828986728547`", "0.7490079622730499`", 
      "0.39209258850280077`"},
     {"0.6904357949530306`", 
      RowBox[{"-", "0.8331449019874602`"}], "1.5383972153673966`", 
      "0.8177250397318042`", 
      RowBox[{"-", "0.6438259633709631`"}], "1.0467828986728547`", 
      RowBox[{"-", "0.7490079622730499`"}], 
      RowBox[{"-", "0.39209258850280077`"}]},
     {
      RowBox[{"-", "0.6904357949530306`"}], "0.8331449019874602`", 
      RowBox[{"-", "1.5383972153673966`"}], 
      RowBox[{"-", "0.8177250397318042`"}], "0.6438259633709631`", 
      "1.0467828986728547`", "0.7490079622730499`", "0.39209258850280077`"},
     {
      RowBox[{"-", "0.6144267037150408`"}], 
      RowBox[{"-", "0.7333385866820687`"}], "1.1637255972806604`", 
      RowBox[{"-", "0.5878604691489152`"}], 
      RowBox[{"-", "0.9170648462418345`"}], 
      RowBox[{"-", "1.583463595143626`"}], "0.8956530048768481`", 
      RowBox[{"-", "0.7169666735698783`"}]},
     {"0.6144267037150408`", 
      RowBox[{"-", "0.7333385866820687`"}], "1.1637255972806604`", 
      "0.5878604691489152`", 
      RowBox[{"-", "0.9170648462418345`"}], 
      RowBox[{"-", "1.583463595143626`"}], "0.8956530048768481`", 
      "0.7169666735698783`"},
     {"0.6144267037150408`", 
      RowBox[{"-", "0.7333385866820687`"}], "1.1637255972806604`", 
      "0.5878604691489152`", "0.9170648462418345`", "1.583463595143626`", 
      RowBox[{"-", "0.8956530048768481`"}], "0.7169666735698783`"},
     {
      RowBox[{"-", "0.6144267037150408`"}], "0.7333385866820687`", 
      "1.1637255972806604`", 
      RowBox[{"-", "0.5878604691489152`"}], "0.9170648462418345`", 
      "1.583463595143626`", 
      RowBox[{"-", "0.8956530048768481`"}], 
      RowBox[{"-", "0.7169666735698783`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.740240063819655*^9, 
  3.740240071606392*^9}},ExpressionUUID->"59026439-4bfa-440d-8084-\
b6edb0c8f4de"]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 16, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 147, 3, 45, "Input",ExpressionUUID->"15eb761f-cbea-4d70-86a6-89af875bb7de"],
Cell[711, 25, 252, 6, 40, "Input",ExpressionUUID->"6333c42e-87f7-4bf2-9c52-ef4b9536a477"],
Cell[966, 33, 4357, 114, 225, "Input",ExpressionUUID->"8229eef7-ddc5-47a6-a2f7-97999efcea5e"],
Cell[5326, 149, 224, 4, 26, "Input",ExpressionUUID->"16595a9d-7c8e-4ee3-b2be-71badbaafc40"],
Cell[5553, 155, 277, 7, 40, "Input",ExpressionUUID->"2d85b99e-e859-45fe-aa2a-950054761b9e"],
Cell[5833, 164, 2543, 63, 135, "Input",ExpressionUUID->"2981b838-8492-4e60-a8e1-78f57677bf64"],
Cell[8379, 229, 154, 3, 26, "Input",ExpressionUUID->"9eaa1ee8-58ef-4f58-85af-66d828901335"],
Cell[8536, 234, 253, 6, 40, "Input",ExpressionUUID->"05e424f5-5bc8-4626-b94a-30e25d2d6108"],
Cell[8792, 242, 2115, 45, 225, "Input",ExpressionUUID->"a3598894-949b-4a67-b2de-57863b0c499b"],
Cell[10910, 289, 454, 13, 40, "Input",ExpressionUUID->"343c3ee5-345a-40f1-8669-79e0ae084770"],
Cell[11367, 304, 23946, 566, 945, "Input",ExpressionUUID->"f6633890-c759-4ccb-88de-5f880763ddc6"],
Cell[35316, 872, 1895, 43, 153, "Input",ExpressionUUID->"0c819410-cf50-4d93-9f66-11fa5c112620"],
Cell[37214, 917, 170, 4, 40, "Input",ExpressionUUID->"53fda235-5223-4e36-9c0b-ec505edc1d68"],
Cell[37387, 923, 544, 15, 45, "Input",ExpressionUUID->"408f5822-b3e1-499a-a1db-fd9de3c7095f"],
Cell[37934, 940, 182, 4, 40, "Input",ExpressionUUID->"18e0cb9c-f3b5-4b17-ac12-f994bd644d9a"],
Cell[38119, 946, 2808, 79, 153, "Input",ExpressionUUID->"b8b92af7-5dbe-417a-a655-801b6a2f9623"],
Cell[40930, 1027, 409, 11, 26, "Input",ExpressionUUID->"afe9369f-9a6d-4c96-803e-1aa7f11c50a9"],
Cell[41342, 1040, 1608, 39, 153, "Input",ExpressionUUID->"9807674e-f639-4051-b7a3-30bdf8348839"],
Cell[CellGroupData[{
Cell[42975, 1083, 430, 11, 26, "Input",ExpressionUUID->"3c931bdf-f65d-4006-8c4a-52a47693008b"],
Cell[43408, 1096, 1517, 32, 70, "Output",ExpressionUUID->"04ec23fc-0b93-44a7-887f-6e386e2139c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44962, 1133, 154, 3, 26, "Input",ExpressionUUID->"172787d8-63e3-4217-aa80-90430516d281"],
Cell[45119, 1138, 1745, 39, 49, "Output",ExpressionUUID->"ee46ae1b-a99c-4e7f-b17b-8ba2f7227a8f"]
}, Open  ]],
Cell[46879, 1180, 234, 6, 40, "Input",ExpressionUUID->"0a449b43-c3d4-4daf-b7b4-33579ede53ba"],
Cell[47116, 1188, 10003, 229, 729, "Input",ExpressionUUID->"de1e4a2d-a305-4f3e-b1c0-5ecad2be69f7"],
Cell[CellGroupData[{
Cell[57144, 1421, 554, 14, 45, "Input",ExpressionUUID->"28e6a493-2a32-48c8-bc7a-4efaec9e36d0"],
Cell[57701, 1437, 181, 5, 30, "Output",ExpressionUUID->"f02b2f89-2882-42d1-b4dc-61eefac76a63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57919, 1447, 352, 7, 26, "Input",ExpressionUUID->"6b20eb6d-f711-4723-9040-0a4a52ec41b2"],
Cell[58274, 1456, 380, 9, 20, "Message",ExpressionUUID->"33874020-da51-4b5e-94fb-bbf0b01ca2cc"]
}, Open  ]],
Cell[58669, 1468, 254, 6, 40, "Input",ExpressionUUID->"42fed18f-ef9b-49b9-8fe0-6fc993c0c59e"],
Cell[58926, 1476, 3456, 90, 135, "Input",ExpressionUUID->"277b590c-4871-469f-93ef-a7ddbc9cdee3"],
Cell[62385, 1568, 291, 7, 52, "Input",ExpressionUUID->"2e022dc5-dbec-46fa-a7dd-e38d1d7f6e93"],
Cell[62679, 1577, 11207, 250, 711, "Input",ExpressionUUID->"ed0d687e-ead2-4ae8-8b3a-260e037d746f"],
Cell[CellGroupData[{
Cell[73911, 1831, 825, 16, 26, "Input",ExpressionUUID->"f9bd6f44-03e8-4d90-82aa-d964092f46b3"],
Cell[74739, 1849, 297, 5, 21, "Print",ExpressionUUID->"16895f02-2080-4f09-b35e-8a9b6d14c181"],
Cell[75039, 1856, 186, 3, 30, "Output",ExpressionUUID->"1b5e00c5-a66d-45f4-acf6-cca68453f2e0"]
}, Open  ]],
Cell[75240, 1862, 156, 3, 26, "Input",ExpressionUUID->"325287a2-dbbe-436b-b6e0-fc6adc845a96"],
Cell[CellGroupData[{
Cell[75421, 1869, 448, 10, 26, "Input",ExpressionUUID->"475e5c3d-2fa2-4d36-b3f8-9d5f89b84137"],
Cell[75872, 1881, 189, 3, 30, "Output",ExpressionUUID->"0aa585b9-f775-487f-bd8b-b675ba7c7d35"]
}, Open  ]],
Cell[76076, 1887, 390, 10, 26, "Input",ExpressionUUID->"13f927e5-ac8e-494f-a479-a7f06d427340"],
Cell[CellGroupData[{
Cell[76491, 1901, 907, 25, 63, "Input",ExpressionUUID->"d1ebd015-e7c5-41dc-a5d7-ed132d2afdf0"],
Cell[77401, 1928, 464, 10, 20, "Message",ExpressionUUID->"5d44c1d0-9706-45d7-83fc-aa488b2f3f69"],
Cell[77868, 1940, 464, 10, 20, "Message",ExpressionUUID->"a7d31531-77bb-4766-a1e7-41adf4a304a0"],
Cell[78335, 1952, 460, 9, 20, "Message",ExpressionUUID->"21fcd52d-864f-41ce-a6b5-da715408ef45"],
Cell[78798, 1963, 411, 9, 20, "Message",ExpressionUUID->"0dbdaecc-329b-44fa-96fc-2a64e840c882"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79246, 1977, 374, 11, 26, "Input",ExpressionUUID->"11eeac4d-0bae-4c4e-b8c1-1d32c9f7c993"],
Cell[79623, 1990, 202, 5, 30, "Output",ExpressionUUID->"68fdc680-19cd-40a3-9e2a-acc3ec0eccd1"]
}, Open  ]],
Cell[79840, 1998, 2862, 73, 207, "Input",ExpressionUUID->"8dfb1ffe-9545-491b-b75a-36b2470cff30"],
Cell[CellGroupData[{
Cell[82727, 2075, 367, 8, 26, "Input",ExpressionUUID->"cd9434f5-b8c6-4d57-a97b-3128168e77a5"],
Cell[83097, 2085, 214, 4, 30, "Output",ExpressionUUID->"5c79c82a-7fc0-4e40-9a55-e3343eb2c06a"]
}, Open  ]],
Cell[83326, 2092, 309, 7, 26, "Input",ExpressionUUID->"c60cadb4-2451-41ef-b435-833acf0701b1"],
Cell[83638, 2101, 462, 13, 26, "Input",ExpressionUUID->"9c75e0f3-4361-4382-9f68-048a8c4c5fba"],
Cell[84103, 2116, 664, 19, 26, "Input",ExpressionUUID->"6331c8e1-087d-4983-9572-8a1be238d0e8"],
Cell[84770, 2137, 568, 17, 26, "Input",ExpressionUUID->"0db43dd4-6b51-4aff-8e43-903691459d46"],
Cell[85341, 2156, 4633, 114, 243, "Input",ExpressionUUID->"99920214-c94a-4cee-aaba-e4da3f622110"],
Cell[CellGroupData[{
Cell[89999, 2274, 1062, 27, 81, "Input",ExpressionUUID->"7a8f509a-eb8b-40c3-b8e3-2ea38f4abb7e"],
Cell[91064, 2303, 149, 3, 30, "Output",ExpressionUUID->"9c9f7813-61ee-4c76-99a5-71d5ee40b250"]
}, Open  ]],
Cell[91228, 2309, 154, 3, 26, "Input",ExpressionUUID->"4ddd2553-040d-47f7-bbdc-142b58950499"],
Cell[CellGroupData[{
Cell[91407, 2316, 6004, 155, 297, "Input",ExpressionUUID->"b6a55cf7-5257-46e3-962c-8f8903a01576"],
Cell[97414, 2473, 20905, 465, 176, "Output",ExpressionUUID->"d368647d-ab68-4656-a14f-13aad80229b7"]
}, Open  ]],
Cell[118334, 2941, 154, 3, 26, "Input",ExpressionUUID->"3b774120-6907-4f3a-a711-9586c5b093b5"],
Cell[CellGroupData[{
Cell[118513, 2948, 196, 4, 26, "Input",ExpressionUUID->"159cb67c-c52a-4a51-8676-0021cd6c70b6"],
Cell[118712, 2954, 180, 4, 30, "Output",ExpressionUUID->"7698de74-475e-4e1f-a81b-b9651ae1ce6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118929, 2963, 301, 6, 26, "Input",ExpressionUUID->"e560346f-c494-4938-a39b-76d5df3a1bd5"],
Cell[119233, 2971, 339, 7, 30, "Output",ExpressionUUID->"60293d41-90d7-4625-879c-f15b4c20fd04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119609, 2983, 186, 4, 26, "Input",ExpressionUUID->"7f6b486d-62c7-4f7f-8eee-10492d5afd35"],
Cell[119798, 2989, 2897, 61, 145, "Output",ExpressionUUID->"cdeb7940-0de8-4dfa-8fed-cf4cdd7e0e18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122732, 3055, 254, 6, 26, "Input",ExpressionUUID->"d8e6b5f8-1a45-494c-805d-b1adefc447e8"],
Cell[122989, 3063, 2913, 65, 145, "Output",ExpressionUUID->"59026439-4bfa-440d-8084-b6edb0c8f4de"]
}, Open  ]]
}
]
*)

