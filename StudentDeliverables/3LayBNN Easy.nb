(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    146318,       3500]
NotebookOptionsPosition[    134831,       3351]
NotebookOutlinePosition[    135210,       3367]
CellTagsIndexPosition[    135167,       3364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "Data", " ", "fetch", " "}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395617607210855`*^9, 
  3.7395617659792604`*^9}},ExpressionUUID->"4a199865-ad68-48b2-81f8-\
86651ddafa89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prepareData", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tx", ",", " ", "tt", ",", " ", "ty", ",", "txT", ",", " ", "ttT", ",", 
       " ", "tyT", ",", " ", "i", ",", " ", "training", ",", " ", "testing"}],
       "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"training", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], 
          ",", "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testing", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", " ", "\"\<MNIST\>\""}], 
           "}"}], ",", " ", "\"\<TestData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"txT", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"testing", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ttT", " ", "=", " ", 
       RowBox[{"testing", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tyT", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "10000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"tyT", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"ttT", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tx", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"training", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "  ", "=", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ty", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ty", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"tt", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"tx", ",", " ", "ty", ",", " ", "txT", ",", " ", "tyT"}], 
        "}"}], "]"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "}"}], " ", "=", " ", 
   RowBox[{"prepareData", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7395617677082987`*^9, 3.7395617699307814`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"529ea0e3-52f7-42db-8042-f3e86c514a8f"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Xavier", " ", "Initialization", " ", "of", " ", "network", " "}], 
  "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561781963962*^9, 
  3.7395617819659567`*^9}},ExpressionUUID->"48868ed5-26c5-4f8b-96a7-\
b27fd0a1a145"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initializeWeights", "[", 
    RowBox[{
    "hiddennodes1_", ",", " ", "hiddennodes2_", ",", " ", "outputnodes_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mininet", ",", " ", "netinit", ",", " ", "w0", ",", " ", "w1", ",", 
       " ", "w2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mininet", " ", "=", " ", 
       RowBox[{"NetChain", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LinearLayer", "[", "hiddennodes1", "]"}], ",", " ", 
           "Ramp", ",", 
           RowBox[{"LinearLayer", "[", "hiddennodes2", "]"}], ",", " ", 
           "Ramp", ",", " ", 
           RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
           "LogisticSigmoid"}], "}"}], ",", " ", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "784"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"netinit", " ", "=", " ", 
       RowBox[{"NetInitialize", "[", 
        RowBox[{"mininet", ",", " ", 
         RowBox[{"Method", " ", "\[Rule]", 
          RowBox[{"{", "\"\<Xavier\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}],
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"a7d24f0e-bf08-4162-809b-f7d4b2ad4eb3"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Define", " ", "network", " ", "variables"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561787772089*^9, 
  3.7395617877750673`*^9}},ExpressionUUID->"51044e44-a945-4edf-b266-\
3587b70a19d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningrate", " ", "=", " ", "0.0003"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes1", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes2", " ", "=", " ", "128"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputnodes", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchsize", " ", "=", " ", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"60000", "/", "batchsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", " ", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilon", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputdim", "  ", "=", " ", "784"}], ";"}]}], "Input",
 CellChangeTimes->{{3.739565612420392*^9, 3.7395656140133944`*^9}, {
  3.73956711748967*^9, 3.7395671254374027`*^9}, {3.7396389249101477`*^9, 
  3.739638927205014*^9}, {3.740187547988028*^9, 3.740187550407053*^9}, {
  3.7401876070824842`*^9, 3.7401876073551564`*^9}, {3.740187637712367*^9, 
  3.740187637884182*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"dc1c30b2-a0d7-468c-8efe-2cbccefe6d17"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Binarization", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561826627942*^9, 
  3.7395618309775496`*^9}},ExpressionUUID->"f95bcc4f-6bfe-464a-a552-\
a4e43ce86171"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bGradForward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "*", 
     RowBox[{"Sign", "[", "x", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bForward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "*", 
     RowBox[{"Sign", "[", "x", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bBackward", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"Clip", "[", 
     RowBox[{"x", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0"}], "}"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7395618323377304`*^9, 3.7395618540661335`*^9}, {
  3.73956188930412*^9, 3.7395619082766542`*^9}, {3.739561960447143*^9, 
  3.7395619785341015`*^9}, {3.7395620336076946`*^9, 3.739562042142571*^9}, {
  3.7395621821157913`*^9, 3.739562212240314*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"2b04c139-2f94-48b8-8d61-34d9b95dd5aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kk", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"784", ",", " ", "128"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7396716441673517`*^9, 3.73967167265884*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"dad5abd7-25a0-4507-8d71-b55ab8f4fec6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"bBackward", "[", "kk", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.739671622651755*^9, 3.7396716430539017`*^9}, {
  3.7396716889416437`*^9, 3.7396717164924107`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"fdc30bcd-b368-44a6-a608-d31db046cc6e"],

Cell[BoxData["0.015625`"], "Output",
 CellChangeTimes->{{3.739671695747178*^9, 3.7396717167276263`*^9}},
 CellLabel->
  "Out[274]=",ExpressionUUID->"b4a69258-5f2c-464a-8233-b0e1bf5afc26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"5", ",", " ", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"bForward", "[", 
   RowBox[{"bForward", "[", "k", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"bBackward", "@", "k"}], "]"}]}], "Input",
 CellChangeTimes->{{3.73956221459525*^9, 3.739562267032261*^9}, {
  3.7395623936666355`*^9, 3.7395624086265697`*^9}, {3.7395650396950006`*^9, 
  3.739565051160205*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"96a91b3d-cbf7-437a-8ff9-c72ba8eb071f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7388207232026572`", "0.7388207232026572`", "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}]},
     {
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}]},
     {"0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}]},
     {
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}]},
     {"0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], 
      RowBox[{"-", "0.7388207232026572`"}], "0.7388207232026572`", 
      RowBox[{"-", "0.7388207232026572`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395622299331093`*^9, 3.739562233698399*^9}, 
   3.739562267338441*^9, {3.739562394591077*^9, 3.739562408983615*^9}, {
   3.7395650257531652`*^9, 3.739565054514078*^9}, 3.7395659168070574`*^9, 
   3.739638942614799*^9},
 CellLabel->
  "Out[261]//MatrixForm=",ExpressionUUID->"4f1cd137-2318-4844-aa2c-\
3561eae3e713"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0832885481141736`", "0.19909734521753134`", "0.36182750745256875`", 
      RowBox[{"-", "0.47787555846322394`"}], "0.5062360555084089`", "0.`"},
     {"0.`", 
      RowBox[{"-", "0.6969168402947977`"}], 
      RowBox[{"-", "0.1278328295241001`"}], "0.5356134554564902`", 
      RowBox[{"-", "0.1558364038031532`"}], 
      RowBox[{"-", "0.4962120946121015`"}]},
     {"0.3514850519996148`", "0.`", 
      RowBox[{"-", "0.970228683162023`"}], 
      RowBox[{"-", "0.375509999621847`"}], "0.7757160676220674`", "0.`"},
     {
      RowBox[{"-", "0.7933137382756923`"}], 
      RowBox[{"-", "0.06774841145441067`"}], "0.5338733807850728`", "0.`", 
      "0.8433097375754836`", "0.`"},
     {"0.684809118910085`", "0.`", "0.`", 
      RowBox[{"-", "0.046662494371083954`"}], "0.8710401065439799`", 
      RowBox[{"-", "0.019833067918767655`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7395622299331093`*^9, 3.739562233698399*^9}, 
   3.739562267338441*^9, {3.739562394591077*^9, 3.739562408983615*^9}, {
   3.7395650257531652`*^9, 3.739565054514078*^9}, 3.7395659168070574`*^9, 
   3.7396389426237555`*^9},
 CellLabel->
  "Out[262]//MatrixForm=",ExpressionUUID->"f8cbcad7-760f-492f-8109-\
c6be0bfd48df"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Derivative", " ", "functions"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739561793934884*^9, 
  3.7395617939369063`*^9}},ExpressionUUID->"870bd94f-dc36-421d-9319-\
812fabbde2e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sigmDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"x", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"UnitStep", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"1c58304f-276a-4fff-a464-3fb29f6917c0"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Layer", " ", "evaluator", " ", "function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395618014661584`*^9, 
  3.7395618014681544`*^9}},ExpressionUUID->"1df6e341-2d38-4c91-826a-\
3c1d1eea106e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "layer_Association"}], "]"}], ":=", 
   RowBox[{"layerEval", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", " ", "\"\<LayerType\>\""}], "]"}], ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Sigmoid\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Ramp\>\"", ",", " ", "param_"}], "]"}], " ", 
   ":=", " ", 
   RowBox[{
    RowBox[{"Abs", "[", "x", "]"}], "*", 
    RowBox[{"UnitStep", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<LinearLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<BinLayer\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"bForward", "[", "x", "]"}], ",", " ", 
     RowBox[{"bForward", "[", 
      RowBox[{"param", "[", "\"\<Weights\>\"", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<BinarizeLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"bForward", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Training\>\""}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"FoldList", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Test\>\""}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Fold", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.739561809908105*^9, 3.7395618154083767`*^9}, {
   3.7395623342328377`*^9, 3.7395623869812956`*^9}, 3.739562722525852*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"eaece362-9924-4902-ad27-cb64d3b2e085"],

Cell[BoxData[
 RowBox[{"Test", " ", "network", " ", "unrolling"}]], "Input",
 CellChangeTimes->{{3.7395651673457117`*^9, 
  3.739565170036276*^9}},ExpressionUUID->"da419ad2-19a0-47b3-b179-\
9a0e53f16796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "net", " ", "weights"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"net", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",",
          " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], "|>"}]}]}],
         "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}], 
        "|>"}], ",", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], ",", 
         " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",",
          " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
       ",", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}],
       "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iteration", " ", "=", " ", "5"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.739565102836887*^9, 3.7395651321725073`*^9}, 
   3.7395662300642824`*^9, {3.739566281546957*^9, 3.7395662842627215`*^9}, 
   3.7395664499434237`*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"2dc1f03b-9776-42d0-af25-a5cb88f80a28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullnet", " ", "=", " ", 
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net", ",", " ", 
     RowBox[{"input", "[", 
      RowBox[{"[", 
       RowBox[{"iteration", ";;", 
        RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", " ", 
     "\"\<Training\>\""}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[275]:=",ExpressionUUID->"b3bf015d-c58c-402b-8f4d-3d8bb0dad5b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l3Error", " ", "=", " ", 
   RowBox[{
    RowBox[{"fullnet", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"target", "[", 
     RowBox[{"[", 
      RowBox[{"iteration", ";;", 
       RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l3Delta", " ", "=", " ", 
   RowBox[{"l3Error", "*", 
    RowBox[{"sigmDeriv", "[", 
     RowBox[{"fullnet", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2Error", " ", "=", " ", 
   RowBox[{"hbBackward", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"l3Delta", ",", " ", 
      RowBox[{"Transpose", "@", 
       RowBox[{"hbWForward", "[", "w2", "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2Delta", " ", "=", " ", 
   RowBox[{"l2Error", "*", 
    RowBox[{"rampDeriv", "[", 
     RowBox[{"fullnet", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1Error", " ", "=", " ", 
   RowBox[{"hbBackward", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"l2Delta", ",", " ", 
      RowBox[{"Transpose", "@", 
       RowBox[{"hbWForward", "[", "w1", "]"}]}]}], "]"}], "]"}]}], ";", 
  RowBox[{"l1Delta", " ", "=", " ", 
   RowBox[{"l1Error", "*", 
    RowBox[{"rampDeriv", "[", 
     RowBox[{"fullnet", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[276]:=",ExpressionUUID->"62aa9500-ec2e-49af-8899-6222bf18aff3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"l2Delta", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7396389893226175`*^9, 3.7396389981246376`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"67613d99-03bc-4c6a-b5e4-35048a52d45a"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          TemplateBox[{"1"},
           "OutputSizeLimit`Skeleton"], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{76., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{62., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 283, 30267483524308328435, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{74., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 283, 30267483524308328435, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{54., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 283, 30267483524308328435, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{94., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[30267483524308328435 === $SessionID, 
   Out[283], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{
  3.739638964814188*^9, {3.7396389960721292`*^9, 3.7396389986213446`*^9}},
 CellLabel->
  "Out[283]=",ExpressionUUID->"a9e05fd0-0913-49f9-b882-88a3726714aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "@", "fullnet"}]], "Input",
 CellChangeTimes->{{3.739565135971985*^9, 3.7395651496759014`*^9}, {
  3.739565214148263*^9, 3.7395652661566544`*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"94e6e790-6ca4-45ca-8e79-dd56f00a7dd1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "17"}], "}"}]], "Output",
 CellChangeTimes->{{3.7395652424706345`*^9, 3.7395652664100184`*^9}, 
   3.739565926114134*^9, 3.739566233816877*^9},
 CellLabel->
  "Out[322]=",ExpressionUUID->"975d8765-3c8e-4b65-a898-94cb020f18ad"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Back", " ", "Propagation", " ", 
   RowBox[{"algorithm", " ", ":", " ", 
    StyleBox[
     RowBox[{
      StyleBox["EA", "Subtitle",
       FontWeight->"Bold"], "S", 
      StyleBox["Y", "Subtitle",
       FontWeight->"Bold"]}]], " "}]}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395624454383483`*^9, 3.7395624454403872`*^9}, {
  3.739565576577035*^9, 3.739565580333019*^9}, {3.7395657068570814`*^9, 
  3.7395657084718647`*^9}},ExpressionUUID->"61c9a279-14aa-4315-be02-\
34ce40644024"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"backProp", "[", 
    RowBox[{
    "fullnet_", ",", " ", "w0_", ",", " ", "w1_", ",", " ", "w2_", ",", " ", 
     "input_", ",", " ", "target_", ",", " ", "l3M_", ",", " ", "l3V_", ",", 
     "  ", "l2M_", ",", " ", "l1M_", ",", " ", "l2V_", ",", " ", "l1V_", " ", 
     ",", " ", "iteration_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l3Error", ",", " ", "l3Delta", ",", " ", "l2Error", ",", " ", 
       "l2Delta", ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g2", 
       ",", " ", "g1", ",", " ", "g0", ",", " ", "l0", ",", " ", "l1", ",", 
       " ", "l2", ",", " ", "l3", ",", " ", "l1MC", ",", " ", "l1VC", ",", 
       " ", "l2MC", ",", " ", "l2VC", ",", " ", "l3MC", ",", " ", "l3VC", ",",
        " ", "l3MT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l3VT", 
       ",", " ", "l2VT", ",", " ", "l1VT", ",", " ", "w2T", ",", " ", "w1T", 
       ",", " ", "w0T", ",", " ", "w2UDT", ",", "  ", "w1UDT", ",", " ", 
       "w0UDT"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l3MT", " ", "=", " ", "l3M"}], ";", " ", 
      RowBox[{"l3VT", " ", "=", " ", "l3V"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", "l2M"}], ";", " ", 
      RowBox[{"l2VT", " ", "=", " ", "l2V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", "l1M"}], ";", " ", 
      RowBox[{"l1VT", " ", "=", " ", "l1V"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "=", " ", "w2"}], ";", " ", 
      RowBox[{"w1T", " ", "=", " ", "w1"}], ";", " ", 
      RowBox[{"w0T", " ", "=", " ", "w0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"l3Error", " ", "=", " ", 
         RowBox[{
          RowBox[{"fullnet", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", "target"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"l3Delta", " ", "=", " ", 
         RowBox[{"l3Error", "*", 
          RowBox[{"sigmDeriv", "[", 
           RowBox[{"fullnet", "[", 
            RowBox[{"[", "9", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l2Error", " ", "=", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"bGradForward", "[", "l3Delta", "]"}], ",", " ", 
           RowBox[{"Transpose", "@", 
            RowBox[{"bForward", "[", "w2", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l2Delta", " ", "=", " ", 
         RowBox[{"l2Error", "*", 
          RowBox[{"rampDeriv", "[", 
           RowBox[{"fullnet", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l1Error", " ", "=", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"bGradForward", "[", "l2Delta", "]"}], ",", " ", 
           RowBox[{"Transpose", "@", 
            RowBox[{"bForward", "[", "w1", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l1Delta", " ", "=", " ", 
         RowBox[{"l1Error", "*", 
          RowBox[{"rampDeriv", "[", 
           RowBox[{"fullnet", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"g2", " ", "=", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"fullnet", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"bGradForward", "[", "l3Delta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g1", " ", "=", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"fullnet", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"bGradForward", "[", "l2Delta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g0", " ", "=", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "input", "]"}], ",", " ", "l1Delta"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l3MT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l3MT", "*", "b1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b1"}], ")"}], "*", "g2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l3VT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l3VT", "*", "b2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"g2", "*", "g2"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l2MT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l2MT", "*", "b1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l2VT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l2VT", "*", "b2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l1MT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l1MT", "*", "b1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b1"}], ")"}], "*", "g0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l1VT", " ", "=", " ", 
         RowBox[{
          RowBox[{"l1VT", "*", "b2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "b2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l1MC", " ", "=", " ", 
         RowBox[{"l1MT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"l1VC", " ", "=", " ", 
         RowBox[{"l1VT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"l2MC", " ", "=", " ", 
         RowBox[{"l2MT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"l2VC", " ", "=", " ", 
         RowBox[{"l2VT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"l3MC", " ", "=", " ", 
         RowBox[{"l3MT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"l3VC", " ", "=", " ", 
         RowBox[{"l3VT", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"w2UDT", " ", "=", " ", 
         RowBox[{"l3MC", "/", 
          RowBox[{"(", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"l3VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"w1UDT", " ", "=", " ", 
         RowBox[{"l2MC", "/", 
          RowBox[{"(", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"w0UDT", " ", "=", " ", 
         RowBox[{"l1MC", "/", 
          RowBox[{"(", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";",
         " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"w2T", " ", "-=", " ", 
         RowBox[{"learningrate", "*", "w2UDT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w1T", " ", "-=", " ", 
         RowBox[{"learningrate", "*", "w1UDT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w0T", " ", "-=", " ", 
         RowBox[{"learningrate", "*", "w0UDT"}]}], ";"}], " ", 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Error", " ", "=", " ", 
       RowBox[{
        RowBox[{"fullnet", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", "target"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3Delta", " ", "=", " ", 
       RowBox[{"l3Error", "*", 
        RowBox[{"sigmDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2Error", " ", "=", 
       RowBox[{"Dot", "[", 
        RowBox[{"l3Delta", ",", " ", 
         RowBox[{"Transpose", "[", "w2", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2Delta", " ", "=", " ", 
       RowBox[{"l2Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1Error", " ", "=", 
       RowBox[{"Dot", "[", 
        RowBox[{"l2Delta", ",", " ", 
         RowBox[{"Transpose", "[", "w1", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1Delta", " ", "=", " ", 
       RowBox[{"l1Error", "*", 
        RowBox[{"rampDeriv", "[", 
         RowBox[{"fullnet", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", " ", "l3Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", " ", "l2Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g0", " ", "=", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "input", "]"}], ",", " ", "l1Delta"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l3MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l3VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g2", "*", "g2"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l2MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
      "\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"l2VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l2VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l1MT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1MT", "*", "b1"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b1"}], ")"}], "*", "g0"}]}]}], ";", 
      "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"l1VT", " ", "=", " ", 
       RowBox[{
        RowBox[{"l1VT", "*", "b2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "b2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", 
      "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"l1MC", " ", "=", " ", 
       RowBox[{"l1MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l1VC", " ", "=", " ", 
       RowBox[{"l1VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
      "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"l2MC", " ", "=", " ", 
       RowBox[{"l2MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l2VC", " ", "=", " ", 
       RowBox[{"l2VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l3MC", " ", "=", " ", 
       RowBox[{"l3MT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"l3VC", " ", "=", " ", 
       RowBox[{"l3VT", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w2UDT", " ", "=", " ", 
       RowBox[{"l3MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l3VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w1UDT", " ", "=", 
       RowBox[{"l2MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      " ", 
      RowBox[{"w0UDT", " ", "=", " ", 
       RowBox[{"l1MC", "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
      "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"w2T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w2UDT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w1UDT"}]}], ";", 
      "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"w0T", " ", "-=", " ", 
       RowBox[{"learningrate", "*", "w0UDT"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "w0T", ",", " ", "w1T", ",", " ", "w2T", ",", " ", "l3MT", ",", " ", 
         "l3VT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l2VT", ",", 
         " ", "l1VT"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7395624500862284`*^9, 3.739562554732466*^9}, {
  3.739564362084696*^9, 3.7395646830462513`*^9}, {3.7395647383609943`*^9, 
  3.7395648889763565`*^9}, {3.7395649336872797`*^9, 3.73956496497505*^9}, {
  3.7395653560975943`*^9, 3.7395653586654463`*^9}, {3.7395654534098997`*^9, 
  3.739565453684158*^9}, {3.739565494539566*^9, 3.739565497811923*^9}, {
  3.739565756940077*^9, 3.7395657770062895`*^9}, {3.739566260619569*^9, 
  3.7395662607851515`*^9}, {3.7395664231632805`*^9, 3.7395664304688787`*^9}, {
  3.739566514354723*^9, 3.739566514491357*^9}, {3.739567146258696*^9, 
  3.7395671463464675`*^9}, {3.7395674325457816`*^9, 3.739567432655471*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"c6adda7b-8a80-4281-beaf-7c3c90b47bdc"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Accuracy", " ", "Testing", " ", "Function"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739562563352662*^9, 
  3.7395625633546567`*^9}},ExpressionUUID->"a41b5cfc-5af9-496c-8ed5-\
4384788014ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "testnum_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
          "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"netEvaluate", "[", 
           RowBox[{"net", ",", " ", 
            RowBox[{"input", "[", 
             RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}],
            "]"}], "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"target", "[", 
          RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "1"}], "]"}], " ", 
       "-", " ", "1"}]}], "}"}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"accTest", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "numTest_"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"y", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", " ", 
        RowBox[{"x", "\[LessEqual]", "numTest"}], ",", " ", 
        RowBox[{"x", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"netEvaluate", "[", 
              RowBox[{"net", ",", " ", 
               RowBox[{"input", "[", 
                RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
              "]"}], ",", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"netEvaluate", "[", 
               RowBox[{"net", ",", " ", 
                RowBox[{"input", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
               "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"target", "[", 
              RowBox[{"[", "x", "]"}], "]"}], ",", " ", "1"}], "]"}]}], " ", 
          ",", 
          RowBox[{"y", "++"}]}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"y", "/", "numTest"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.7395625622936754`*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"bd95f968-bfba-4ab0-ba08-0476279d678a"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Network", " ", "run", " ", "function", " "}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.739562565606951*^9, 3.739562567423723*^9}, 
   3.7395669131228967`*^9},ExpressionUUID->"218e8cea-5e9c-4471-b73e-\
c9c738235ee3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runNet", "[", 
   RowBox[{
   "input_", ",", " ", "target_", ",", " ", "testinp_", ",", " ", 
    "testtar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iteration", ",", " ", "fullnet", ",", " ", "w0", ",", " ", "w1", ",", 
      " ", "w2", ",", "l3M", ",", " ", "l3V", ",", " ", "l2M", ",", " ", 
      "l1M", ",", " ", "l2V", ",", " ", "l1V", ",", "\[IndentingNewLine]", 
      "l3Error", ",", " ", "l3Delta", ",", "l2Error", ",", " ", "l2Delta", 
      ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g1", ",", " ", 
      "g0", ",", " ", "l0", ",", " ", "l1", ",", " ", "l2", ",", "l3", ",", 
      " ", "l1MC", ",", " ", "l1VC", ",", " ", "l2MC", ",", " ", "l2VC", ",", 
      " ", "l3MC", ",", " ", "l3VC", ",", " ", "w2UDT", ",", " ", "w1UDT", 
      ",", " ", "w0UDT", ",", " ", "epoch"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
      RowBox[{"initializeWeights", "[", 
       RowBox[{"hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "10"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"epoch", " ", "=", " ", "epochs"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"l3M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l3V", " ", "=", " ", "0"}], ";", 
     RowBox[{"l2M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l2V", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1V", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Iterator", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iteration", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"iteration", "\[LessEqual]", " ", "iterations"}], ",", " ", 
       RowBox[{"iteration", "+=", "batchsize"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "iteration", " ", "ends", " ", "and", " ", "epoch", " ", 
          "isnt", " ", "0"}], ",", " ", 
         RowBox[{"reset", " ", "iteration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"iteration", " ", "\[GreaterEqual]", " ", 
             RowBox[{"iterations", " ", "-", " ", "32"}]}], ",", " ", 
            RowBox[{"epoch", "\[GreaterEqual]", "1"}]}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"iteration", "=", "1"}], ";", " ", 
           RowBox[{"epoch", "-=", "1"}], ";", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<epoch \>\"", "epoch"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Training acc\>\"", " ", 
             StyleBox[
              RowBox[{"N", "[", 
               RowBox[{"accTest", "[", 
                RowBox[{
                "net", ",", " ", "input", ",", " ", "target", ",", " ", 
                 "600"}], "]"}], "]"}],
              FontWeight->"Bold"]}], 
            StyleBox["]",
             FontWeight->"Bold"]}], 
           StyleBox[";",
            FontWeight->"Bold"], 
           StyleBox["\[IndentingNewLine]",
            FontWeight->"Bold"], 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Test acc\>\"", " ", 
             RowBox[{"N", "[", 
              RowBox[{"accTest", "[", 
               RowBox[{
               "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", 
                "100"}], "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "net", " ", "weights"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Define", " ", "net", " ", "weights"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"net", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", " ", "\[Rule]", " ", "w0"}], 
               "|>"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinarizeLayer\>\""}],
             "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<BinLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", " ", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], 
            "|>"}], ",", " ", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], 
            "|>"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Evaluate", " ", "the", " ", "net"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"fullnet", " ", "=", " ", 
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "\"\<Training\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Back", " ", "prop"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "w0", ",", " ", "w1", ",", "w2", ",", " ", "l3M", ",", " ", "l3V", 
           ",", " ", "l2M", ",", " ", "l1M", ",", " ", "l2V", ",", " ", 
           "l1V"}], "}"}], " ", "=", " ", 
         RowBox[{"backProp", "[", 
          RowBox[{
          "fullnet", ",", " ", "w0", ",", " ", "w1", ",", " ", "w2", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"target", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "l3M", ",", " ", "l3V", ",", "  ", "l2M", ",", " ", "l1M", 
           ",", " ", "l2V", ",", " ", "l1V", ",", " ", "iteration"}], "]"}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7395625861297393`*^9, 3.73956263052021*^9}, {
   3.739562661362663*^9, 3.7395626648009043`*^9}, {3.739562698886861*^9, 
   3.7395628175642104`*^9}, {3.7395628580197864`*^9, 
   3.7395628830116644`*^9}, {3.739565287707942*^9, 3.7395653136146135`*^9}, {
   3.7395653694401464`*^9, 3.7395653712669187`*^9}, {3.739566127683996*^9, 
   3.7395661623634005`*^9}, {3.7395662011704745`*^9, 3.7395662056562295`*^9}, 
   3.7395662929895897`*^9, {3.7395671603460045`*^9, 3.7395671616884146`*^9}, 
   3.7395674270584335`*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"36468c58-a035-49a6-a4de-3bb47bc777bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{"runNet", "[", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7395661238579464`*^9, 3.73956612412424*^9}, {
  3.739566171510495*^9, 3.739566195923069*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"05937a87-855a-463a-a9dc-a1521677c725"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"19", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{
  3.7395672222094936`*^9, 3.7395674626930933`*^9, {3.7401876185014553`*^9, 
   3.7401876453926315`*^9}},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"61079260-81d5-4227-9cc7-265b68ea35b6"],

Cell[BoxData[
 RowBox[{"0.165`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{
  3.7395672222094936`*^9, 3.7395674626930933`*^9, {3.7401876185014553`*^9, 
   3.7401876459706154`*^9}},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"dcfcfa46-60a2-400c-923a-1cd14fb84876"],

Cell[BoxData[
 RowBox[{"0.2`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{
  3.7395672222094936`*^9, 3.7395674626930933`*^9, {3.7401876185014553`*^9, 
   3.7401876460643425`*^9}},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"960714e9-a4a2-4c98-9b9f-e4b06f21e1d5"],

Cell[BoxData[
 RowBox[{"18", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{
  3.7395672222094936`*^9, 3.7395674626930933`*^9, {3.7401876185014553`*^9, 
   3.740187648408105*^9}},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"8391a38d-54eb-4cf6-b317-fae069eec68e"],

Cell[BoxData[
 RowBox[{"0.495`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187649017331*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"c63813cf-b073-42bc-b044-7aa0fc12261d"],

Cell[BoxData[
 RowBox[{"0.52`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876491266794`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"6b6a3cd9-f795-4e60-9098-b999ac1fe66d"],

Cell[BoxData[
 RowBox[{"17", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.74018765141367*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"97134b9c-3465-4909-8bbf-7624a8c4132e"],

Cell[BoxData[
 RowBox[{"0.6416666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187652012947*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"987f681c-7ece-4c71-b4c2-986f82cf5413"],

Cell[BoxData[
 RowBox[{"0.54`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876521222963`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"45cb0645-6a7e-4a15-a486-134ff410252d"],

Cell[BoxData[
 RowBox[{"16", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187654380332*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"6ddcbe65-7061-4e5c-9ec0-b34c6f9e713e"],

Cell[BoxData[
 RowBox[{"0.6516666666666666`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187654967707*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"b771810f-9550-4d33-a377-59ec6150502f"],

Cell[BoxData[
 RowBox[{"0.54`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187655077056*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"e65e4937-5e44-4cf2-b34d-5ee19e158564"],

Cell[BoxData[
 RowBox[{"15", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876573603287`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a33047a6-257b-4c60-8660-8d422fbadc25"],

Cell[BoxData[
 RowBox[{"0.745`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876580164194`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"2e5b9277-194f-4ff9-a716-75210a6f69b2"],

Cell[BoxData[
 RowBox[{"0.67`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876581101465`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a7efa945-2dcb-4759-a227-1ec671556b7d"],

Cell[BoxData[
 RowBox[{"14", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187660492929*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"afcd7a3c-5d3b-415e-8774-bb66510d4077"],

Cell[BoxData[
 RowBox[{"0.7883333333333333`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876611490197`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"c5f0644c-e494-4a8c-909a-66ea2cafbf79"],

Cell[BoxData[
 RowBox[{"0.72`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876612427464`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"8e539250-503f-4a43-b899-df81f6c9d16d"],

Cell[BoxData[
 RowBox[{"13", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187663376193*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"8f58b532-d82b-424e-baa2-6a518507a334"],

Cell[BoxData[
 RowBox[{"0.7933333333333333`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.74018766400104*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"50e79fc0-d529-494d-a2a5-571f4be2487e"],

Cell[BoxData[
 RowBox[{"0.78`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876641189194`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"8eefad5b-f824-412c-8c75-9dbaee1402df"],

Cell[BoxData[
 RowBox[{"12", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187666350632*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"51e7ab37-657f-4952-a6d5-dfcc0ceb8b88"],

Cell[BoxData[
 RowBox[{"0.83`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876669503207`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"eff4d5df-8f20-4bdd-9380-636d50b7747c"],

Cell[BoxData[
 RowBox[{"0.75`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187667055189*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"fbcddce7-efef-4232-8611-1859d6d34be1"],

Cell[BoxData[
 RowBox[{"11", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876693173914`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"9924beee-5688-4654-8312-59df9a935fd9"],

Cell[BoxData[
 RowBox[{"0.8366666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876698971767`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"86310782-76fd-4e1b-81dc-1a50929be818"],

Cell[BoxData[
 RowBox[{"0.78`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187669999257*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"b880acb1-7876-4f3d-b9d6-c3a990820e5e"],

Cell[BoxData[
 RowBox[{"10", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876721988463`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"0f23a898-529a-4e7d-822a-b711ed5f6ed2"],

Cell[BoxData[
 RowBox[{"0.8483333333333334`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187672792451*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"0ae8925a-99d3-4506-a54c-cc97456f7e6a"],

Cell[BoxData[
 RowBox[{"0.81`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187672917424*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"2c72cb2c-3c91-4176-a9f0-92b3f24f9f2f"],

Cell[BoxData[
 RowBox[{"9", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876751847286`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"52d8db46-7369-401f-9cf3-f821f55a15ce"],

Cell[BoxData[
 RowBox[{"0.8616666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876757567587`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"0cc3dcd6-092f-46ff-abc8-62b08f800a4a"],

Cell[BoxData[
 RowBox[{"0.81`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187675850486*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"2e088f1c-2110-4e9f-b1b5-b30594433559"],

Cell[BoxData[
 RowBox[{"8", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876781649027`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"f1d99fbe-be1b-4c56-ad88-0178b669cac5"],

Cell[BoxData[
 RowBox[{"0.8633333333333333`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187678758507*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"9a840d2a-e44f-4e25-b9e1-b99bab01cfe9"],

Cell[BoxData[
 RowBox[{"0.82`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187678867856*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"826edf43-c4db-40a9-a26a-8d20ff36fd44"],

Cell[BoxData[
 RowBox[{"7", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876810768805`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a9db6bc1-018f-4fd1-9fe4-82ca0a96e407"],

Cell[BoxData[
 RowBox[{"0.865`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876816548634`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"78e06796-7d4b-4bb2-a6ea-9476d30652c4"],

Cell[BoxData[
 RowBox[{"0.82`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876817642174`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"eb2c233c-67c9-4fe1-abca-75dd9356e274"],

Cell[BoxData[
 RowBox[{"6", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187683960429*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"6506a094-c7aa-4495-a13f-5f5ec06f28e5"],

Cell[BoxData[
 RowBox[{"0.8666666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187684538414*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"1d6d9e18-e232-4282-aabc-01da271b71fd"],

Cell[BoxData[
 RowBox[{"0.84`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876846439557`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"80e9b945-4795-4cd7-be17-37e33b77b419"],

Cell[BoxData[
 RowBox[{"5", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876868725843`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"7d237194-5b52-4050-a7f9-ec687c1afd8e"],

Cell[BoxData[
 RowBox[{"0.8583333333333333`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187687463081*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"7db817ac-1bb2-4635-af6b-58c029607d42"],

Cell[BoxData[
 RowBox[{"0.83`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876875724287`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"7291b17e-6092-48cb-ac54-239f88406fa4"],

Cell[BoxData[
 RowBox[{"4", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876897956944`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"db268ac0-8cdc-482f-869f-ff22bdce490a"],

Cell[BoxData[
 RowBox[{"0.8716666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876903761215`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"e87f22b8-179e-47d1-8b02-e43099a319c0"],

Cell[BoxData[
 RowBox[{"0.83`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876904854693`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a84e2795-f72c-4ff9-b3cb-d0b18257c3a5"],

Cell[BoxData[
 RowBox[{"3", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876926890273`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a2d04ffa-923d-4c82-b7c5-a9d9cb8b8639"],

Cell[BoxData[
 RowBox[{"0.875`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187693276746*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"213076da-3bec-4168-b7f8-1b7fc989a0cc"],

Cell[BoxData[
 RowBox[{"0.81`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187693386095*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"4e92e670-1b4c-4b70-8b48-5fc5cb10dc2f"],

Cell[BoxData[
 RowBox[{"2", " ", "\<\"epoch \"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876956086864`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"2d46766c-30f7-4b43-9b33-b09ae850f202"],

Cell[BoxData[
 RowBox[{"0.875`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401876961874847`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"57697769-801a-476b-bedd-6ba5acc058a6"],

Cell[BoxData[
 RowBox[{"0.82`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187696281211*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"3c1d89ee-2de2-4b0d-9858-667b205c04ec"],

Cell[BoxData["\<\"epoch \"\>"], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187698492446*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"422b300a-fd83-4aaa-9b6c-9e965243e440"],

Cell[BoxData[
 RowBox[{"0.885`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.74018769907043*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"c6a36ac1-54ff-44d3-a2cf-af37b6a4bf4e"],

Cell[BoxData[
 RowBox[{"0.82`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.740187699164157*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"1cf9b0bd-e91c-4bd4-8941-a541e39e657c"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401877013730717`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"b44e7126-5c2a-49cf-badd-cf85e0c662db"],

Cell[BoxData[
 RowBox[{"0.8766666666666667`", " ", "\<\"Training acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.7401877019421935`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"a1c361b9-cdea-4413-8cd1-eb85456f973e"],

Cell[BoxData[
 RowBox[{"0.81`", " ", "\<\"Test acc\"\>"}]], "Print",
 CellChangeTimes->{3.7395672222094936`*^9, 3.7395674626930933`*^9, 
  3.7401876185014553`*^9, 3.74018770203592*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"d06a5bfb-c489-4b7d-9ec2-da45da09d478"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bForward", "[", "w1", "]"}], ",", " ", 
       RowBox[{"bForward", "[", "w0", "]"}], ",", " ", 
       RowBox[{"bForward", "[", "w2", "]"}]}], "}"}], "]"}], "]"}], ",", " ", 
   RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.74018770946145*^9, 3.740187744822958*^9}, {
  3.740187776194269*^9, 3.7401877781717305`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"f1fb3501-5696-42c5-8faf-edb0a9dcebc6"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.574], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.574], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          
          RectangleBox[{-0.16, 5.309918278226516}, {-0.14, 6.593044534142437},
            "RoundingRadius" -> 0]},
         ImageSizeCache->{{43.86701361088869, 68.11393114491591}, {
          54.4499398279678, 107.60511316484626`}}],
        StatusArea[#, 730]& ,
        TagBoxNote->"730"],
       StyleBox["730", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[730, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          
          RectangleBox[{-0.14, 5.309918278226516}, {-0.12, 9.015298250772847},
            "RoundingRadius" -> 0]},
         ImageSizeCache->{{67.5139311449159, 
          91.76084867894315}, {-44.76240451965735, 107.60511316484626`}}],
        StatusArea[#, 8228]& ,
        TagBoxNote->"8228"],
       StyleBox["8228", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[8228, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          RectangleBox[{-0.1, 5.309918278226516}, {-0.08, 
           10.840521645548183`}, "RoundingRadius" -> 0]},
         ImageSizeCache->{{114.80776621297034`, 
          139.0546837469976}, {-119.52116769567112`, 107.60511316484627`}}],
        StatusArea[#, 51048]& ,
        TagBoxNote->"51048"],
       StyleBox["51048", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[51048, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          
          RectangleBox[{0.08, 5.309918278226516}, {0.1, 10.80576049264208}, 
           "RoundingRadius" -> 0]},
         ImageSizeCache->{{327.63002401921534`, 
          351.8769415532426}, {-118.09739633416473`, 107.60511316484627`}}],
        StatusArea[#, 49304]& ,
        TagBoxNote->"49304"],
       StyleBox["49304", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[49304, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          
          RectangleBox[{0.12, 5.309918278226516}, {0.14, 9.006509131694346}, 
           "RoundingRadius" -> 0]},
         ImageSizeCache->{{374.9238590872698, 
          399.1707766212971}, {-44.40241369683736, 107.60511316484627`}}],
        StatusArea[#, 8156]& ,
        TagBoxNote->"8156"],
       StyleBox["8156", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[8156, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        DynamicBox[{
          FEPrivate`If[
           CurrentValue["MouseOver"], 
           EdgeForm[{
             GrayLevel[0.5], 
             AbsoluteThickness[1.5], 
             Opacity[0.66]}], {}, {}], 
          
          RectangleBox[{0.14, 5.309918278226516}, {0.16, 6.309918278226516}, 
           "RoundingRadius" -> 0]},
         ImageSizeCache->{{398.57077662129706`, 422.8176941553243}, {
          66.04642099050243, 107.60511316484627`}}],
        StatusArea[#, 550]& ,
        TagBoxNote->"550"],
       StyleBox["550", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[550, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-0.1664, 5.309918278226516},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{-0.16, 0.16}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Automatic, 
     Charting`ScaledTicks[{Log, Exp}]}, {Automatic, {{6.214608098422191, 
       FormBox["500", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {6.907755278982137, 
       FormBox["1000", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {8.517193191416238, 
       FormBox["5000", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {9.210340371976184, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "1", 
          
          TemplateBox[{"10", "4"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}, {
        AbsoluteThickness[0.1]}}, {10.819778284410283`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "5", 
          
          TemplateBox[{"10", "4"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}, {
        AbsoluteThickness[0.1]}}, {4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.298317366548036, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.703782474656201, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {5.991464547107982, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.396929655216146, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.551080335043404, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.684611727667927, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {6.802394763324311, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {7.600902459542082, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8.006367567650246, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8.294049640102028, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8.699514748210191, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8.85366542803745, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {8.987196820661973, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {9.104979856318357, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {9.903487552536127, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {10.308952660644293`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {10.596634733096073`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.002099841204238`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.156250521031495`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.289781913656018`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.407564949312402`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.608235644774552`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.695247021764184`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.77528972943772, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.84939770159144, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.918390573078392`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {11.982929094215963`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}}}]]], "Output",
 CellChangeTimes->{3.740187745216976*^9, 3.7401877784809723`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"dad8bba5-5e35-4d4d-afb3-6f6af8a08b00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mininet", " ", "=", " ", 
  RowBox[{"NetChain", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LinearLayer", "[", "hiddennodes1", "]"}], ",", " ", "Ramp", 
      ",", 
      RowBox[{"LinearLayer", "[", "hiddennodes2", "]"}], ",", " ", "Ramp", 
      ",", " ", 
      RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
      "LogisticSigmoid"}], "}"}], ",", " ", 
    RowBox[{"\"\<Input\>\"", "\[Rule]", "784"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.73956691999152*^9, 3.7395669271117334`*^9}, {
  3.7395690842267723`*^9, 3.7395690855339384`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"bec6f0a9-ff80-47a5-a541-52db5953acb2"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["NetChain", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = True}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"], 
                 ImageSizeCache -> {11., {0., 11.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = True), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              OverlayBox[{
                GraphicsBox[{
                  Thickness[0.014925373134328358`], {
                   GrayLevel[0.6], 
                   Thickness[0.018686567164179105`], 
                   Opacity[1.], 
                   JoinForm[{"Miter", 10.}], 
                   
                   JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}},
                     CurveClosed -> {0}]}, {
                   GrayLevel[0.6], 
                   Thickness[0.018686567164179105`], 
                   Opacity[1.], 
                   JoinForm[{"Miter", 10.}], 
                   
                   JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}},
                     CurveClosed -> {0}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                    15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                    103.}, {23., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    29.5, 103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                    29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                    103.}, {37., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    43.5, 103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                    43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                    103.}, {51., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {
                    25., 95.}, {25., 88.}}}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {
                    39., 95.}, {39., 88.}}}]}}, BaseStyle -> GrayLevel[0.6], 
                 ImageMargins -> 0, ImageSize -> {36, Automatic}, 
                 PlotRangePadding -> 0], 
                StyleBox[
                "uninitialized", LineColor -> RGBColor[0.66, 0, 0], 
                 FrontFaceColor -> RGBColor[0.66, 0, 0], BackFaceColor -> 
                 RGBColor[0.66, 0, 0], GraphicsColor -> RGBColor[0.66, 0, 0], 
                 FontFamily -> "Roboto", FontSize -> 8, FontColor -> 
                 RGBColor[0.66, 0, 0], Background -> GrayLevel[1, 0.65]]}, 
               Alignment -> {Center, 
                 Scaled[0.0001]}], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Input\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"784\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Output\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"10\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}, {
                 StyleBox[
                  
                  TemplateBox[{"\"Number of layers\"", "\":\""}, 
                   "RowDefault"], "SummaryItemAnnotation"], 
                 StyleBox["6", "SummaryItem"]}}, BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 3}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}, "RowsIndexed" -> {}}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"], 
                 ImageSizeCache -> {14., {0., 14.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = False), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              OverlayBox[{
                GraphicsBox[{
                  Thickness[0.014925373134328358`], {
                   GrayLevel[0.6], 
                   Thickness[0.018686567164179105`], 
                   Opacity[1.], 
                   JoinForm[{"Miter", 10.}], 
                   
                   JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}},
                     CurveClosed -> {0}]}, {
                   GrayLevel[0.6], 
                   Thickness[0.018686567164179105`], 
                   Opacity[1.], 
                   JoinForm[{"Miter", 10.}], 
                   
                   JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}},
                     CurveClosed -> {0}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                    15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                    103.}, {23., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    29.5, 103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                    29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                    103.}, {37., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.9], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    43.5, 103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 
                    79.5}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                    0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                    43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                    103.}, {51., 103.}}}]}, {
                   FaceForm[{
                    GrayLevel[0.6], 
                    Opacity[1.]}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {
                    25., 95.}, {25., 88.}}}], 
                   
                   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {
                    39., 95.}, {39., 88.}}}]}}, BaseStyle -> GrayLevel[0.6], 
                 ImageMargins -> 0, ImageSize -> {36, Automatic}, 
                 PlotRangePadding -> 0], 
                StyleBox[
                "uninitialized", LineColor -> RGBColor[0.66, 0, 0], 
                 FrontFaceColor -> RGBColor[0.66, 0, 0], BackFaceColor -> 
                 RGBColor[0.66, 0, 0], GraphicsColor -> RGBColor[0.66, 0, 0], 
                 FontFamily -> "Roboto", FontSize -> 8, FontColor -> 
                 RGBColor[0.66, 0, 0], Background -> GrayLevel[1, 0.65]]}, 
               Alignment -> {Center, 
                 Scaled[0.0001]}], 
              GridBox[{{
                 
                 DynamicModuleBox[{
                  NeuralNetworks`Private`NetChain`assoc3 = 
                   Association[
                    "Type" -> "Chain", "Nodes" -> 
                    Association[
                    "1" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`TensorT[{256, 784}, NeuralNetworks`RealT], 
                    "Biases" -> NeuralNetworks`Nullable[
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {256}, "$OutputSize" -> 256, 
                    "$InputSize" -> 784, "$InputDimensions" -> {784}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{784}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]]], 
                    "2" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {256}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]]], 
                    "3" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`TensorT[{2048, 256}, NeuralNetworks`RealT],
                     "Biases" -> NeuralNetworks`Nullable[
                    NeuralNetworks`TensorT[{2048}, NeuralNetworks`RealT]]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {2048}, "$OutputSize" -> 2048, 
                    "$InputSize" -> 256, "$InputDimensions" -> {256}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{2048}, NeuralNetworks`RealT]]], 
                    "4" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {2048}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{2048}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{2048}, NeuralNetworks`RealT]]], 
                    "5" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`TensorT[{10, 2048}, NeuralNetworks`RealT], 
                    "Biases" -> NeuralNetworks`Nullable[
                    NeuralNetworks`TensorT[{10}, NeuralNetworks`RealT]]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {10}, "$OutputSize" -> 10, 
                    "$InputSize" -> 2048, "$InputDimensions" -> {2048}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{2048}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{10}, NeuralNetworks`RealT]]], "6" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> 
                    NeuralNetworks`ValidatedParameter[LogisticSigmoid], 
                    "$Dimensions" -> {10}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{10}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{10}, NeuralNetworks`RealT]]]], 
                    "Edges" -> {
                    NeuralNetworks`NetPath["Nodes", "1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath["Nodes", "2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "1", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "2", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "4", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "3", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "5", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "4", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "6", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "5", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "6", "Outputs", "Output"]}, "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{784}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{10}, NeuralNetworks`RealT]]], 
                   NeuralNetworks`Private`NetChain`opart = {"Nodes", "1"}, 
                   NeuralNetworks`Private`NetChain`part = {"Nodes", "1"}, 
                   NeuralNetworks`Private`NetChain`selected = 
                   Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`TensorT[{256, 784}, NeuralNetworks`RealT], 
                    "Biases" -> NeuralNetworks`Nullable[
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {256}, "$OutputSize" -> 256, 
                    "$InputSize" -> 784, "$InputDimensions" -> {784}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{784}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{256}, NeuralNetworks`RealT]]]}, 
                  DynamicBox[
                   GridBox[{{
                    NeuralNetworks`Private`NetChain`MouseClickBoxes[
                    TagBox[
                    GridBox[{{
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Input\"", 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"784\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"1\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    RGBColor[0.66, 0, 0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"256\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"2\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Ramp", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"256\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"3\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    RGBColor[0.66, 0, 0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"2048\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"4\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Ramp", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"2048\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"5\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    RGBColor[0.66, 0, 0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"10\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"6\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LogisticSigmoid", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"10\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Output\"", 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"10\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{1.1}}}], "Grid"], 
                    If[
                    ListQ[
                    NeuralNetworks`Private`NetChain`part = MouseAnnotation[]],
                     If[NeuralNetworks`Private`NetChain`opart === 
                    NeuralNetworks`Private`NetChain`part, 
                    NeuralNetworks`Private`NetChain`selected = Null; 
                    NeuralNetworks`Private`NetChain`opart = Null, 
                    NeuralNetworks`Private`NetChain`selected = 
                    Part[NeuralNetworks`Private`NetChain`assoc3, 
                    Apply[Sequence, NeuralNetworks`Private`NetChain`part]]; 
                    NeuralNetworks`Private`NetChain`opart = 
                    NeuralNetworks`Private`NetChain`part; Null]; Null]]}, 
                    NeuralNetworks`Private`NetChain`fmtSelected[
                    NeuralNetworks`Private`NetChain`selected, 
                    NeuralNetworks`Private`NetChain`part, 
                    NeuralNetworks`Private`GetSharedArrays[
                    NeuralNetworks`Private`NetChain`assoc3]]}, 
                    GridBoxSpacings -> {"Columns" -> {{1}}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridFrameMargins -> {{0, 0}, {0, 0}}], 
                   ImageSizeCache -> {288., {164., 170.}}, 
                   TrackedSymbols :> {
                    NeuralNetworks`Private`NetChain`selected}], 
                  Initialization :> {NetChain}]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 1}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}, "RowsIndexed" -> {}}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}, BaselinePosition -> Baseline]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("NetChain[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.7395690916934595`*^9, 3.7395690954115114`*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"31cb4171-b91a-4b56-9063-276449f45675"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Net", " ", "accuracy", " ", "testing"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395660841464415`*^9, 
  3.7395660841484365`*^9}},ExpressionUUID->"9dbd8f18-9102-4c39-aea9-\
a2e36684a3a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"net", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w0"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}], 
    "}"}]}], ";", 
  StyleBox[
   RowBox[{"N", "[", 
    RowBox[{"accTest", "[", 
     RowBox[{
     "net", ",", " ", "input", ",", " ", "target", ",", " ", "60000"}], "]"}],
     "]"}],
   FontWeight->"Bold"]}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"accTest", "[", 
   RowBox[{
   "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", "10000"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.739566091021245*^9, 
  3.739566092125001*^9}},ExpressionUUID->"d7bbe0fc-c30e-43da-8619-\
4fd09b6b5050"],

Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "weight", " ", "saver"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7395660953908577`*^9, 
  3.7395660953938513`*^9}},ExpressionUUID->"3851b0a8-0e1e-4b57-9afc-\
915f6b250ded"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<MNISTweightsAggressive.dat\>\"", ",", " ", 
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73956610191183*^9, 
  3.73956610347484*^9}},ExpressionUUID->"9a6737a3-d6c1-4391-af9b-\
7a12864944c3"],

Cell[BoxData[
 StyleBox[
  RowBox[{"MNIST", " ", "weight", " ", "importer"}], "Subtitle",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.73956610744728*^9, 
  3.7395661074493027`*^9}},ExpressionUUID->"419071fb-458a-46f0-b8e7-\
d939f9948d24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
  RowBox[{"Import", "[", "\"\<MNISTweights2.dat\>\"", "]"}]}]], "Input",Expres\
sionUUID->"d8445121-6850-4f62-bf3e-55693350d400"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7396717601494875`*^9, 
  3.7396717603018684`*^9}},ExpressionUUID->"5da33ff1-65ba-463e-9a03-\
f5eaa392b3f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hbActForward", "[", 
    RowBox[{"x_", ",", " ", "hBL_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "row", ",", " ", "col", ",", "tempMat", ",", " ", "matCreate", ",", " ",
        "joinerMat", ",", " ", "x2"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x2", " ", "=", " ", 
       RowBox[{"Transpose", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"col", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"col", " ", "\[LessEqual]", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"col", "++"}], ",", 
        RowBox[{
         RowBox[{"matCreate", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "col"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", "hBL"}], "]"}], ",", 
               "hBL"}], "}"}], ",", " ", "0"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempMat", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", " ", 
            RowBox[{"matCreate", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], ",", " ", ";;"}], "]"}], "]"}], ",", 
            " ", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}], 
            "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"matCreate", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}], 
              "/", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hBL"}], "]"}]}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tempMat", ",", " ", 
             RowBox[{"Mean", "[", 
              RowBox[{"matCreate", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", ";;"}], "]"}], "]"}], "]"}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"row", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"row", " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "x2", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "[", 
              RowBox[{"[", 
               RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"x2", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], "]"}], "*", 
              RowBox[{"tempMat", "[", 
               RowBox[{"[", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"row", "/", "hBL"}], "]"}], "]"}], "]"}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Transpose", "[", "x2", "]"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7396717882263412`*^9, 3.739671862442727*^9}, 
   3.7396720530079436`*^9, {3.73967214330937*^9, 3.739672145728471*^9}, 
   3.739672192023875*^9},
 CellLabel->
  "In[308]:=",ExpressionUUID->"04486ff6-43cc-4d96-8e5b-a26ebc910320"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kk", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"784", ",", " ", "128"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"hbActForward", "[", 
    RowBox[{"kk", ",", " ", "4"}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellLabel->
  "In[309]:=",ExpressionUUID->"aca7298e-1763-45c7-9b24-5193ff4c5816"],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.7396717715806923`*^9, {3.7396718295855274`*^9, 3.7396718811086693`*^9}, 
   3.7396719132095222`*^9, {3.7396720490880976`*^9, 3.739672063658683*^9}, {
   3.7396721720384235`*^9, 3.739672194450941*^9}},
 CellLabel->
  "Out[310]=",ExpressionUUID->"cfc4ac88-7ee8-474c-b10a-3e6c54ce4a1f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.739672306144264*^9, 3.7396723097073307`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"37d9ef2f-9cf9-4b95-9f77-789558f64578"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kk", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"7840", ",", " ", "256"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"CUDADot", "[", 
    RowBox[{"kk", ",", " ", 
     RowBox[{"CUDATranspose", "[", "kk", "]"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"kk", ",", " ", 
     RowBox[{"Transpose", "@", "kk"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7396723580200577`*^9, 3.739672380567937*^9}, {
  3.7396724247038946`*^9, 3.73967244857524*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"a2fa1287-c08f-4b08-a026-911f5a75927d"],

Cell[BoxData["0.265625`"], "Output",
 CellChangeTimes->{{3.739672383334852*^9, 3.739672459065934*^9}},
 CellLabel->
  "Out[343]=",ExpressionUUID->"18ef1955-8715-4a82-8c2f-966fe34a62f1"],

Cell[BoxData["0.390625`"], "Output",
 CellChangeTimes->{{3.739672383334852*^9, 3.7396724595855465`*^9}},
 CellLabel->
  "Out[344]=",ExpressionUUID->"0a327dd1-ce27-4c7e-a4d3-6ddfcbd32e0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"kk", ",", " ", 
     RowBox[{"Transpose", "@", "kk"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7396723860630145`*^9, 3.739672398761142*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"cfddfe93-4748-4d60-ad02-060e06e2d504"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.7396723939531956`*^9, 3.7396724076032543`*^9}},
 CellLabel->
  "Out[316]=",ExpressionUUID->"d1594f23-4b2a-448e-abe8-2ad89efedd5f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739672400509838*^9, 
  3.7396724006831264`*^9}},ExpressionUUID->"84415daa-f2da-4588-a0b2-\
d6798b7245da"]
},
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 7, 2018)",
StyleDefinitions->"ReverseColor.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 252, 6, 53, "Input",ExpressionUUID->"4a199865-ad68-48b2-81f8-86651ddafa89"],
Cell[816, 28, 4325, 112, 300, "Input",ExpressionUUID->"529ea0e3-52f7-42db-8042-f3e86c514a8f"],
Cell[5144, 142, 277, 7, 53, "Input",ExpressionUUID->"48868ed5-26c5-4f8b-96a7-b27fd0a1a145"],
Cell[5424, 151, 2494, 61, 180, "Input",ExpressionUUID->"a7d24f0e-bf08-4162-809b-f7d4b2ad4eb3"],
Cell[7921, 214, 253, 6, 53, "Input",ExpressionUUID->"51044e44-a945-4edf-b266-3587b70a19d6"],
Cell[8177, 222, 1454, 36, 276, "Input",ExpressionUUID->"dc1c30b2-a0d7-468c-8efe-2cbccefe6d17"],
Cell[9634, 260, 243, 6, 53, "Input",ExpressionUUID->"f95bcc4f-6bfe-464a-a552-a4e43ce86171"],
Cell[9880, 268, 1359, 34, 84, "Input",ExpressionUUID->"2b04c139-2f94-48b8-8d61-34d9b95dd5aa"],
Cell[11242, 304, 404, 10, 35, "Input",ExpressionUUID->"dad5abd7-25a0-4507-8d71-b55ab8f4fec6"],
Cell[CellGroupData[{
Cell[11671, 318, 352, 8, 35, "Input",ExpressionUUID->"fdc30bcd-b368-44a6-a608-d31db046cc6e"],
Cell[12026, 328, 187, 3, 39, "Output",ExpressionUUID->"b4a69258-5f2c-464a-8233-b0e1bf5afc26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12250, 336, 736, 18, 84, "Input",ExpressionUUID->"96a91b3d-cbf7-437a-8ff9-c72ba8eb071f"],
Cell[12989, 356, 2033, 46, 133, "Output",ExpressionUUID->"4f1cd137-2318-4844-aa2c-3561eae3e713"],
Cell[15025, 404, 1743, 39, 133, "Output",ExpressionUUID->"f8cbcad7-760f-492f-8109-c6be0bfd48df"]
}, Open  ]],
Cell[16783, 446, 241, 6, 53, "Input",ExpressionUUID->"870bd94f-dc36-421d-9319-812fabbde2e2"],
Cell[17027, 454, 497, 13, 60, "Input",ExpressionUUID->"1c58304f-276a-4fff-a464-3fb29f6917c0"],
Cell[17527, 469, 255, 6, 53, "Input",ExpressionUUID->"1df6e341-2d38-4c91-826a-3c1d1eea106e"],
Cell[17785, 477, 2675, 74, 204, "Input",ExpressionUUID->"eaece362-9924-4902-ad27-cb64d3b2e085"],
Cell[20463, 553, 204, 4, 35, "Input",ExpressionUUID->"da419ad2-19a0-47b3-b179-9a0e53f16796"],
Cell[20670, 559, 2129, 51, 252, "Input",ExpressionUUID->"2dc1f03b-9776-42d0-af25-a5cb88f80a28"],
Cell[22802, 612, 417, 11, 35, "Input",ExpressionUUID->"b3bf015d-c58c-402b-8f4d-3d8bb0dad5b8"],
Cell[23222, 625, 1610, 47, 156, "Input",ExpressionUUID->"62aa9500-ec2e-49af-8899-6222bf18aff3"],
Cell[CellGroupData[{
Cell[24857, 676, 261, 6, 35, "Input",ExpressionUUID->"67613d99-03bc-4c6a-b5e4-35048a52d45a"],
Cell[25121, 684, 7522, 201, 107, "Output",ExpressionUUID->"a9e05fd0-0913-49f9-b882-88a3726714aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32680, 890, 266, 5, 35, "Input",ExpressionUUID->"94e6e790-6ca4-45ca-8e79-dd56f00a7dd1"],
Cell[32949, 897, 275, 6, 39, "Output",ExpressionUUID->"975d8765-3c8e-4b65-a898-94cb020f18ad"]
}, Open  ]],
Cell[33239, 906, 549, 14, 53, "Input",ExpressionUUID->"61c9a279-14aa-4315-be02-34ce40644024"],
Cell[33791, 922, 15696, 376, 1620, "Input",ExpressionUUID->"c6adda7b-8a80-4281-beaf-7c3c90b47bdc"],
Cell[49490, 1300, 254, 6, 53, "Input",ExpressionUUID->"a41b5cfc-5af9-496c-8ed5-4384788014ad"],
Cell[49747, 1308, 2721, 72, 108, "Input",ExpressionUUID->"bd95f968-bfba-4ab0-ba08-0476279d678a"],
Cell[52471, 1382, 277, 6, 53, "Input",ExpressionUUID->"218e8cea-5e9c-4471-b73e-c9c738235ee3"],
Cell[52751, 1390, 8281, 180, 804, "Input",ExpressionUUID->"36468c58-a035-49a6-a4de-3bb47bc777bd"],
Cell[CellGroupData[{
Cell[61057, 1574, 473, 12, 35, "Input",ExpressionUUID->"05937a87-855a-463a-a9dc-a1521677c725"],
Cell[CellGroupData[{
Cell[61555, 1590, 294, 7, 27, "Print",ExpressionUUID->"61079260-81d5-4227-9cc7-265b68ea35b6"],
Cell[61852, 1599, 304, 7, 27, "Print",ExpressionUUID->"dcfcfa46-60a2-400c-923a-1cd14fb84876"],
Cell[62159, 1608, 298, 7, 27, "Print",ExpressionUUID->"960714e9-a4a2-4c98-9b9f-e4b06f21e1d5"],
Cell[62460, 1617, 292, 7, 27, "Print",ExpressionUUID->"8391a38d-54eb-4cf6-b317-fae069eec68e"],
Cell[62755, 1626, 296, 6, 27, "Print",ExpressionUUID->"c63813cf-b073-42bc-b044-7aa0fc12261d"],
Cell[63054, 1634, 293, 6, 27, "Print",ExpressionUUID->"6b6a3cd9-f795-4e60-9098-b999ac1fe66d"],
Cell[63350, 1642, 285, 6, 27, "Print",ExpressionUUID->"97134b9c-3465-4909-8bbf-7624a8c4132e"],
Cell[63638, 1650, 309, 6, 27, "Print",ExpressionUUID->"987f681c-7ece-4c71-b4c2-986f82cf5413"],
Cell[63950, 1658, 293, 6, 27, "Print",ExpressionUUID->"45cb0645-6a7e-4a15-a486-134ff410252d"],
Cell[64246, 1666, 286, 6, 27, "Print",ExpressionUUID->"6ddcbe65-7061-4e5c-9ec0-b34c6f9e713e"],
Cell[64535, 1674, 309, 6, 27, "Print",ExpressionUUID->"b771810f-9550-4d33-a377-59ec6150502f"],
Cell[64847, 1682, 291, 6, 27, "Print",ExpressionUUID->"e65e4937-5e44-4cf2-b34d-5ee19e158564"],
Cell[65141, 1690, 288, 6, 27, "Print",ExpressionUUID->"a33047a6-257b-4c60-8660-8d422fbadc25"],
Cell[65432, 1698, 298, 6, 27, "Print",ExpressionUUID->"2e5b9277-194f-4ff9-a716-75210a6f69b2"],
Cell[65733, 1706, 293, 6, 27, "Print",ExpressionUUID->"a7efa945-2dcb-4759-a227-1ec671556b7d"],
Cell[66029, 1714, 286, 6, 27, "Print",ExpressionUUID->"afcd7a3c-5d3b-415e-8774-bb66510d4077"],
Cell[66318, 1722, 311, 6, 27, "Print",ExpressionUUID->"c5f0644c-e494-4a8c-909a-66ea2cafbf79"],
Cell[66632, 1730, 293, 6, 27, "Print",ExpressionUUID->"8e539250-503f-4a43-b899-df81f6c9d16d"],
Cell[66928, 1738, 286, 6, 27, "Print",ExpressionUUID->"8f58b532-d82b-424e-baa2-6a518507a334"],
Cell[67217, 1746, 308, 6, 27, "Print",ExpressionUUID->"50e79fc0-d529-494d-a2a5-571f4be2487e"],
Cell[67528, 1754, 293, 6, 27, "Print",ExpressionUUID->"8eefad5b-f824-412c-8c75-9dbaee1402df"],
Cell[67824, 1762, 286, 6, 27, "Print",ExpressionUUID->"51e7ab37-657f-4952-a6d5-dfcc0ceb8b88"],
Cell[68113, 1770, 297, 6, 27, "Print",ExpressionUUID->"eff4d5df-8f20-4bdd-9380-636d50b7747c"],
Cell[68413, 1778, 291, 6, 27, "Print",ExpressionUUID->"fbcddce7-efef-4232-8611-1859d6d34be1"],
Cell[68707, 1786, 288, 6, 27, "Print",ExpressionUUID->"9924beee-5688-4654-8312-59df9a935fd9"],
Cell[68998, 1794, 311, 6, 27, "Print",ExpressionUUID->"86310782-76fd-4e1b-81dc-1a50929be818"],
Cell[69312, 1802, 291, 6, 27, "Print",ExpressionUUID->"b880acb1-7876-4f3d-b9d6-c3a990820e5e"],
Cell[69606, 1810, 288, 6, 27, "Print",ExpressionUUID->"0f23a898-529a-4e7d-822a-b711ed5f6ed2"],
Cell[69897, 1818, 309, 6, 27, "Print",ExpressionUUID->"0ae8925a-99d3-4506-a54c-cc97456f7e6a"],
Cell[70209, 1826, 291, 6, 27, "Print",ExpressionUUID->"2c72cb2c-3c91-4176-a9f0-92b3f24f9f2f"],
Cell[70503, 1834, 287, 6, 27, "Print",ExpressionUUID->"52d8db46-7369-401f-9cf3-f821f55a15ce"],
Cell[70793, 1842, 311, 6, 27, "Print",ExpressionUUID->"0cc3dcd6-092f-46ff-abc8-62b08f800a4a"],
Cell[71107, 1850, 291, 6, 27, "Print",ExpressionUUID->"2e088f1c-2110-4e9f-b1b5-b30594433559"],
Cell[71401, 1858, 287, 6, 27, "Print",ExpressionUUID->"f1d99fbe-be1b-4c56-ad88-0178b669cac5"],
Cell[71691, 1866, 309, 6, 27, "Print",ExpressionUUID->"9a840d2a-e44f-4e25-b9e1-b99bab01cfe9"],
Cell[72003, 1874, 291, 6, 27, "Print",ExpressionUUID->"826edf43-c4db-40a9-a26a-8d20ff36fd44"],
Cell[72297, 1882, 287, 6, 27, "Print",ExpressionUUID->"a9db6bc1-018f-4fd1-9fe4-82ca0a96e407"],
Cell[72587, 1890, 298, 6, 27, "Print",ExpressionUUID->"78e06796-7d4b-4bb2-a6ea-9476d30652c4"],
Cell[72888, 1898, 293, 6, 27, "Print",ExpressionUUID->"eb2c233c-67c9-4fe1-abca-75dd9356e274"],
Cell[73184, 1906, 285, 6, 27, "Print",ExpressionUUID->"6506a094-c7aa-4495-a13f-5f5ec06f28e5"],
Cell[73472, 1914, 309, 6, 27, "Print",ExpressionUUID->"1d6d9e18-e232-4282-aabc-01da271b71fd"],
Cell[73784, 1922, 293, 6, 27, "Print",ExpressionUUID->"80e9b945-4795-4cd7-be17-37e33b77b419"],
Cell[74080, 1930, 287, 6, 27, "Print",ExpressionUUID->"7d237194-5b52-4050-a7f9-ec687c1afd8e"],
Cell[74370, 1938, 309, 6, 27, "Print",ExpressionUUID->"7db817ac-1bb2-4635-af6b-58c029607d42"],
Cell[74682, 1946, 293, 6, 27, "Print",ExpressionUUID->"7291b17e-6092-48cb-ac54-239f88406fa4"],
Cell[74978, 1954, 287, 6, 27, "Print",ExpressionUUID->"db268ac0-8cdc-482f-869f-ff22bdce490a"],
Cell[75268, 1962, 311, 6, 27, "Print",ExpressionUUID->"e87f22b8-179e-47d1-8b02-e43099a319c0"],
Cell[75582, 1970, 293, 6, 27, "Print",ExpressionUUID->"a84e2795-f72c-4ff9-b3cb-d0b18257c3a5"],
Cell[75878, 1978, 287, 6, 27, "Print",ExpressionUUID->"a2d04ffa-923d-4c82-b7c5-a9d9cb8b8639"],
Cell[76168, 1986, 296, 6, 27, "Print",ExpressionUUID->"213076da-3bec-4168-b7f8-1b7fc989a0cc"],
Cell[76467, 1994, 291, 6, 27, "Print",ExpressionUUID->"4e92e670-1b4c-4b70-8b48-5fc5cb10dc2f"],
Cell[76761, 2002, 287, 6, 27, "Print",ExpressionUUID->"2d46766c-30f7-4b43-9b33-b09ae850f202"],
Cell[77051, 2010, 298, 6, 27, "Print",ExpressionUUID->"57697769-801a-476b-bedd-6ba5acc058a6"],
Cell[77352, 2018, 291, 6, 27, "Print",ExpressionUUID->"3c1d89ee-2de2-4b0d-9858-667b205c04ec"],
Cell[77646, 2026, 263, 5, 27, "Print",ExpressionUUID->"422b300a-fd83-4aaa-9b6c-9e965243e440"],
Cell[77912, 2033, 295, 6, 27, "Print",ExpressionUUID->"c6a36ac1-54ff-44d3-a2cf-af37b6a4bf4e"],
Cell[78210, 2041, 291, 6, 27, "Print",ExpressionUUID->"1cf9b0bd-e91c-4bd4-8941-a541e39e657c"],
Cell[78504, 2049, 252, 5, 27, "Print",ExpressionUUID->"b44e7126-5c2a-49cf-badd-cf85e0c662db"],
Cell[78759, 2056, 311, 6, 27, "Print",ExpressionUUID->"a1c361b9-cdea-4413-8cd1-eb85456f973e"],
Cell[79073, 2064, 290, 6, 27, "Print",ExpressionUUID->"d06a5bfb-c489-4b7d-9ec2-da45da09d478"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79412, 2076, 611, 14, 35, "Input",ExpressionUUID->"f1fb3501-5696-42c5-8faf-edb0a9dcebc6"],
Cell[80026, 2092, 10378, 253, 278, "Output",ExpressionUUID->"dad8bba5-5e35-4d4d-afb3-6f6af8a08b00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90441, 2350, 683, 15, 35, "Input",ExpressionUUID->"bec6f0a9-ff80-47a5-a541-52db5953acb2"],
Cell[91127, 2367, 32649, 675, 382, "Output",ExpressionUUID->"31cb4171-b91a-4b56-9063-276449f45675"]
}, Open  ]],
Cell[123791, 3045, 251, 6, 53, "Input",ExpressionUUID->"9dbd8f18-9102-4c39-aea9-a2e36684a3a7"],
Cell[124045, 3053, 1726, 47, 108, "Input",ExpressionUUID->"d7bbe0fc-c30e-43da-8619-4fd09b6b5050"],
Cell[125774, 3102, 249, 6, 53, "Input",ExpressionUUID->"3851b0a8-0e1e-4b57-9afc-915f6b250ded"],
Cell[126026, 3110, 316, 7, 35, "Input",ExpressionUUID->"9a6737a3-d6c1-4391-af9b-7a12864944c3"],
Cell[126345, 3119, 249, 6, 53, "Input",ExpressionUUID->"419071fb-458a-46f0-b8e7-d939f9948d24"],
Cell[126597, 3127, 243, 5, 35, "Input",ExpressionUUID->"d8445121-6850-4f62-bf3e-55693350d400"],
Cell[126843, 3134, 210, 4, 84, "Input",ExpressionUUID->"5da33ff1-65ba-463e-9a03-f5eaa392b3f1"],
Cell[127056, 3140, 4597, 112, 300, "Input",ExpressionUUID->"04486ff6-43cc-4d96-8e5b-a26ebc910320"],
Cell[CellGroupData[{
Cell[131678, 3256, 524, 15, 60, "Input",ExpressionUUID->"aca7298e-1763-45c7-9b24-5193ff4c5816"],
Cell[132205, 3273, 339, 6, 39, "Output",ExpressionUUID->"cfc4ac88-7ee8-474c-b10a-3e6c54ce4a1f"]
}, Open  ]],
Cell[132559, 3282, 225, 4, 35, "Input",ExpressionUUID->"37d9ef2f-9cf9-4b95-9f77-789558f64578"],
Cell[CellGroupData[{
Cell[132809, 3290, 890, 24, 84, "Input",ExpressionUUID->"a2fa1287-c08f-4b08-a026-911f5a75927d"],
Cell[133702, 3316, 185, 3, 39, "Output",ExpressionUUID->"18ef1955-8715-4a82-8c2f-966fe34a62f1"],
Cell[133890, 3321, 187, 3, 39, "Output",ExpressionUUID->"0a327dd1-ce27-4c7e-a4d3-6ddfcbd32e0a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134114, 3329, 358, 9, 35, "Input",ExpressionUUID->"cfddfe93-4748-4d60-ad02-060e06e2d504"],
Cell[134475, 3340, 183, 3, 39, "Output",ExpressionUUID->"d1594f23-4b2a-448e-abe8-2ad89efedd5f"]
}, Open  ]],
Cell[134673, 3346, 154, 3, 35, "Input",ExpressionUUID->"84415daa-f2da-4588-a0b2-d6798b7245da"]
}
]
*)

