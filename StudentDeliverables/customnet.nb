(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     56028,       1322]
NotebookOptionsPosition[     51642,       1255]
NotebookOutlinePosition[     52019,       1271]
CellTagsIndexPosition[     51976,       1268]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["MNIST Data fetch ",
 FontWeight->"Bold"]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.7393044493563933`*^9, 
  3.7393044608745737`*^9}},ExpressionUUID->"77287d3d-7365-4466-95f3-\
f241c698909e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prepareData", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tx", ",", " ", "tt", ",", " ", "ty", ",", "txT", ",", " ", "ttT", ",", 
       " ", "tyT", ",", " ", "i"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"training", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], 
          ",", "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testing", " ", "=", " ", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"ExampleData", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MachineLearning\>\"", ",", " ", "\"\<MNIST\>\""}], 
           "}"}], ",", " ", "\"\<TestData\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"txT", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"testing", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ttT", " ", "=", " ", 
       RowBox[{"testing", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tyT", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"10000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "10000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"tyT", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"ttT", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tx", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"ImageData", ",", " ", 
           RowBox[{"training", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "784"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "  ", "=", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ty", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ty", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", "+", 
              RowBox[{"tt", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", 
          " ", "1"}], ";"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"tx", ",", " ", "ty", ",", " ", "txT", ",", " ", "tyT"}], 
        "}"}], "]"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "}"}], " ", "=", " ", 
   RowBox[{"prepareData", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739233148086295*^9, 3.739233190809897*^9}, {
   3.739233320772684*^9, 3.739233354574588*^9}, {3.73923340938995*^9, 
   3.739233433527355*^9}, 3.739233982125271*^9, {3.7392347358936076`*^9, 
   3.739234736025262*^9}, {3.7392385254695683`*^9, 3.7392385396287127`*^9}, {
   3.7392442558268337`*^9, 3.7392442560701942`*^9}, {3.7393073113536806`*^9, 
   3.7393074115076714`*^9}, {3.7393075102241383`*^9, 3.73930753001728*^9}, {
   3.739313462189762*^9, 3.7393134633536477`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7829bba4-9f62-4f5f-b7cb-a2e4b0bba986"],

Cell[TextData[StyleBox["Xavier Initialization of network ",
 FontWeight->"Bold"]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.7393044300460234`*^9, 
  3.7393044413019094`*^9}},ExpressionUUID->"2fe03ec4-bfa0-4631-8431-\
2718c2566419"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initializeWeights", "[", 
     RowBox[{
     "hiddennodes1_", ",", " ", "hiddennodes2_", ",", " ", "outputnodes_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mininet", ",", " ", "netinit", ",", " ", "w0", ",", " ", "w1", ",", 
        " ", "w2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mininet", " ", "=", " ", 
        RowBox[{"NetChain", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LinearLayer", "[", "hiddennodes1", "]"}], ",", " ", 
            "Ramp", ",", 
            RowBox[{"LinearLayer", "[", "hiddennodes2", "]"}], ",", " ", 
            "Ramp", ",", " ", 
            RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
            "LogisticSigmoid"}], "}"}], ",", " ", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "784"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"netinit", " ", "=", " ", 
        RowBox[{"NetInitialize", "[", 
         RowBox[{"mininet", ",", " ", 
          RowBox[{"Method", " ", "\[Rule]", 
           RowBox[{"{", "\"\<Xavier\>\"", "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"w0", " ", "=", " ", 
        RowBox[{"Transpose", "@", 
         RowBox[{
          RowBox[{"NetExtract", "[", 
           RowBox[{"netinit", ",", " ", 
            RowBox[{"{", 
             RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w1", " ", "=", " ", 
        RowBox[{"Transpose", "@", 
         RowBox[{
          RowBox[{"NetExtract", "[", 
           RowBox[{"netinit", ",", " ", 
            RowBox[{"{", 
             RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], 
          "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w2", " ", "=", " ", 
        RowBox[{"Transpose", "@", 
         RowBox[{
          RowBox[{"NetExtract", "[", 
           RowBox[{"netinit", ",", " ", 
            RowBox[{"{", 
             RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], 
          "[", 
          RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], 
       ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739233449602352*^9, 3.7392334601032667`*^9}, {
   3.739233502199691*^9, 3.739233505746063*^9}, {3.7392339491076083`*^9, 
   3.739233979293847*^9}, {3.739234048255398*^9, 3.739234049121029*^9}, {
   3.739234673211311*^9, 3.7392347839201155`*^9}, 3.7392362495112953`*^9, 
   3.7392366246902523`*^9, {3.739238593796336*^9, 3.7392385976430464`*^9}, {
   3.739317274196908*^9, 3.7393173605221004`*^9}, {3.7393173906607924`*^9, 
   3.7393173911536503`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"9a01a0fc-7e26-4087-a77e-a5c55034816b"],

Cell[TextData[StyleBox["Define network variables",
 FontWeight->"Bold"]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.7393044653924723`*^9, 
  3.739304487406584*^9}},ExpressionUUID->"4074f893-e235-4a02-8fd0-\
a9d7d84d137a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningrate", " ", "=", " ", "0.0003"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes1", " ", "=", " ", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes2", " ", "=", " ", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputnodes", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchsize", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"60000", "/", "batchsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", " ", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.99"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilon", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputdim", "  ", "=", " ", "784"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.739244314985553*^9, {3.739245029145113*^9, 3.739245029440323*^9}, {
   3.7392451876241093`*^9, 3.7392451877368097`*^9}, {3.739247621182054*^9, 
   3.7392476217894278`*^9}, {3.73924769781802*^9, 3.7392476980603724`*^9}, {
   3.7392479973485756`*^9, 3.7392479976527596`*^9}, {3.739305403021764*^9, 
   3.7393054063558435`*^9}, {3.7393076460642633`*^9, 
   3.7393076538444486`*^9}, {3.739307708668769*^9, 3.739307715471583*^9}, 
   3.739307860192522*^9, {3.7393079251337605`*^9, 3.739307952282116*^9}, {
   3.7393081006639977`*^9, 3.739308100799637*^9}, {3.739308632194242*^9, 
   3.7393086413038826`*^9}, {3.739308673495003*^9, 3.7393086738301325`*^9}, 
   3.7393118048005233`*^9, {3.7393120294752574`*^9, 3.7393120616591544`*^9}, {
   3.739312288585075*^9, 3.7393122889860153`*^9}, {3.7393125418315277`*^9, 
   3.739312542233453*^9}, {3.7393127402815332`*^9, 3.739312744965989*^9}, {
   3.7393129535581264`*^9, 3.739312964130865*^9}, {3.739313112308956*^9, 
   3.7393131130499763`*^9}, {3.7393167446179485`*^9, 3.739316746231608*^9}, {
   3.739317379514203*^9, 3.739317387707938*^9}, {3.739317734818823*^9, 
   3.7393177379352336`*^9}, 3.739317819219285*^9, {3.739318274688615*^9, 
   3.73931828073634*^9}, {3.739319166310007*^9, 3.739319168370493*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"77c19d7a-ce8d-427d-81f6-6fcb70a24b02"],

Cell[TextData[StyleBox["Derivative functions",
 FontWeight->"Bold"]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.73930449086331*^9, 
  3.739304495544811*^9}},ExpressionUUID->"15637985-9ebe-4862-bef1-\
39105b6f318b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sigmDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"x", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampDeriv", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"UnitStep", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739238147417404*^9, 3.7392381927251434`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"77d270d1-b953-461c-9bad-eb44c7207587"],

Cell[TextData[StyleBox["Layer evaluator function",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.7393045005005264`*^9, 
  3.7393045092970066`*^9}},ExpressionUUID->"983f4c0f-90e6-47b6-9729-\
192cdc1c771f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "layer_Association"}], "]"}], ":=", 
   RowBox[{"layerEval", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", " ", "\"\<LayerType\>\""}], "]"}], ",", " ", 
     RowBox[{"Lookup", "[", 
      RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Sigmoid\>\"", ",", " ", "param_"}], "]"}], ":=",
    " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Ramp\>\"", ",", " ", "param_"}], "]"}], " ", 
   ":=", " ", 
   RowBox[{
    RowBox[{"Abs", "[", "x", "]"}], "*", 
    RowBox[{"UnitStep", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<LinearLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Training\>\""}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"FoldList", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"netEvaluate", "[", 
    RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Test\>\""}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Fold", "[", 
    RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7392349576463532`*^9, 3.739235053134879*^9}, {
   3.739235191661913*^9, 3.7392352248631043`*^9}, {3.7392356316641345`*^9, 
   3.739235634991685*^9}, 3.739236330471072*^9, {3.739238808971236*^9, 
   3.739238809445966*^9}, {3.7392422776700745`*^9, 3.7392422778007336`*^9}, 
   3.73924248988233*^9, {3.7392439210254965`*^9, 3.7392439266155777`*^9}, {
   3.7392466104574013`*^9, 3.7392466126445513`*^9}, {3.7392864213986025`*^9, 
   3.739286440199184*^9}, {3.7393174018532143`*^9, 3.739317402185772*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"57345bbf-7009-4430-990a-36c88888c09e"],

Cell[TextData[StyleBox["Back Propagation algorithm : ADAM optimizer, \
Out_Error = y - T",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.7393045138169*^9, 3.7393045433768215`*^9}, {
  3.739319957355094*^9, 
  3.7393199721946344`*^9}},ExpressionUUID->"02e73b2e-3618-4197-b4d0-\
e8b6a42d535a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"backProp", "[", 
     RowBox[{
     "fullnet_", ",", " ", "w0_", ",", " ", "w1_", ",", " ", "w2_", ",", " ", 
      "input_", ",", " ", "target_", ",", " ", "l3M_", ",", " ", "l3V_", ",", 
      "  ", "l2M_", ",", " ", "l1M_", ",", " ", "l2V_", ",", " ", "l1V_", " ",
       ",", " ", "iteration_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "l3Error", ",", " ", "l3Delta", ",", " ", "l2Error", ",", " ", 
        "l2Delta", ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g2", 
        ",", " ", "g1", ",", " ", "g0", ",", " ", "l0", ",", " ", "l1", ",", 
        " ", "l2", ",", " ", "l3", ",", " ", "l1MC", ",", " ", "l1VC", ",", 
        " ", "l2MC", ",", " ", "l2VC", ",", " ", "l3MC", ",", " ", "l3VC", 
        ",", " ", "l3MT", ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", 
        "l3VT", ",", " ", "l2VT", ",", " ", "l1VT", ",", " ", "w2T", ",", " ",
         "w1T", ",", " ", "w0T", ",", " ", "w2UDT", ",", "  ", "w1UDT", ",", 
        " ", "w0UDT"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l3MT", " ", "=", " ", "l3M"}], ";", " ", 
       RowBox[{"l3VT", " ", "=", " ", "l3V"}], ";", "\[IndentingNewLine]", 
       RowBox[{"l2MT", " ", "=", " ", "l2M"}], ";", " ", 
       RowBox[{"l1MT", " ", "=", " ", "l1M"}], ";", " ", 
       RowBox[{"l1VT", " ", "=", " ", "l1V"}], ";", " ", 
       RowBox[{"l2VT", " ", "=", " ", "l2V"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"w2T", " ", "=", " ", "w2"}], ";", "  ", 
       RowBox[{"w1T", " ", "=", " ", "w1"}], ";", " ", 
       RowBox[{"w0T", " ", "=", " ", "w0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"l3Error", " ", "=", " ", 
        RowBox[{
         RowBox[{"fullnet", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", "target"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"l3Delta", " ", "=", " ", 
        RowBox[{"l3Error", "*", 
         RowBox[{"sigmDeriv", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l2Error", " ", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"l3Delta", ",", " ", 
          RowBox[{"Transpose", "[", "w2", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l2Delta", " ", "=", " ", 
        RowBox[{"l2Error", "*", 
         RowBox[{"rampDeriv", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l1Error", " ", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"l2Delta", ",", " ", 
          RowBox[{"Transpose", "[", "w1", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l1Delta", " ", "=", " ", 
        RowBox[{"l1Error", "*", 
         RowBox[{"rampDeriv", "[", 
          RowBox[{"fullnet", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g2", " ", "=", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"fullnet", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", " ", "l3Delta"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g1", " ", "=", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"fullnet", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", " ", "l2Delta"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g0", " ", "=", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "input", "]"}], ",", " ", "l1Delta"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l3MT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l3MT", "*", "b1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b1"}], ")"}], "*", "g2"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l3VT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l3VT", "*", "b2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b2"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"g2", "*", "g2"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l2MT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l2MT", "*", "b1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
       "\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"l2VT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l2VT", "*", "b2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b2"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l1MT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l1MT", "*", "b1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b1"}], ")"}], "*", "g0"}]}]}], ";", 
       "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"l1VT", " ", "=", " ", 
        RowBox[{
         RowBox[{"l1VT", "*", "b2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "b2"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", 
       "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"l1MC", " ", "=", " ", 
        RowBox[{"l1MT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"l1VC", " ", "=", " ", 
        RowBox[{"l1VT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
       "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"l2MC", " ", "=", " ", 
        RowBox[{"l2MT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"l2VC", " ", "=", " ", 
        RowBox[{"l2VT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l3MC", " ", "=", " ", 
        RowBox[{"l3MT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"l3VC", " ", "=", " ", 
        RowBox[{"l3VT", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"w2UDT", " ", "=", " ", 
        RowBox[{"l3MC", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"l3VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"w1UDT", " ", "=", 
        RowBox[{"l2MC", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
       " ", 
       RowBox[{"w0UDT", " ", "=", " ", 
        RowBox[{"l1MC", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
       "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"w2T", " ", "-=", " ", 
        RowBox[{"learningrate", "*", "w2UDT"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w1T", " ", "-=", " ", 
        RowBox[{"learningrate", "*", "w1UDT"}]}], ";", 
       "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
       RowBox[{"w0T", " ", "-=", " ", 
        RowBox[{"learningrate", "*", "w0UDT"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "w0T", ",", " ", "w1T", ",", " ", "w2T", ",", "l3MT", ",", "l3VT", 
          ",", " ", "l2MT", ",", " ", "l1MT", ",", " ", "l2VT", ",", " ", 
          "l1VT"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7392376689147177`*^9, 3.739237722262997*^9}, {
   3.7392377653636723`*^9, 3.7392378077757096`*^9}, {3.739238020527505*^9, 
   3.7392381703021355`*^9}, {3.7392382031452656`*^9, 
   3.7392382323061686`*^9}, {3.7392382653208513`*^9, 
   3.7392383310061026`*^9}, {3.7392383703351154`*^9, 
   3.7392383734108877`*^9}, {3.7392384784967346`*^9, 3.739238479541937*^9}, {
   3.739238777573239*^9, 3.7392387942605934`*^9}, {3.739238829341736*^9, 
   3.7392388346315875`*^9}, {3.7392390969168744`*^9, 
   3.7392390983450537`*^9}, {3.7392393092933855`*^9, 
   3.7392393314266148`*^9}, {3.739239760649568*^9, 3.739239761157754*^9}, {
   3.739241116825941*^9, 3.7392411625527315`*^9}, {3.7392412164505405`*^9, 
   3.7392412177188473`*^9}, {3.739241251270969*^9, 3.7392413065848603`*^9}, {
   3.7392415380066566`*^9, 3.73924154443721*^9}, {3.739243071662917*^9, 
   3.739243072133664*^9}, {3.7392447497921605`*^9, 3.7392447542322936`*^9}, {
   3.7392455133839808`*^9, 3.7392455249081564`*^9}, {3.739245569078973*^9, 
   3.73924557068268*^9}, {3.7392458548989077`*^9, 3.7392458730782776`*^9}, {
   3.7392459125404863`*^9, 3.7392459125963383`*^9}, 3.73924605164931*^9, {
   3.739246090985069*^9, 3.739246160681241*^9}, {3.7392463150432415`*^9, 
   3.739246315223758*^9}, {3.739246887418189*^9, 3.739246887634606*^9}, {
   3.7392476320828915`*^9, 3.739247661225918*^9}, {3.7392873350234947`*^9, 
   3.7392874267201457`*^9}, {3.739287484119574*^9, 3.739287526611925*^9}, 
   3.739287824928228*^9, {3.7392881439461975`*^9, 3.7392881564956255`*^9}, 
   3.739312338357911*^9, {3.739317413963086*^9, 3.739317680562377*^9}, {
   3.739317831920632*^9, 3.739317947806733*^9}, 3.7393189757099476`*^9, {
   3.7393190073832064`*^9, 3.739319007925755*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0b01139e-8fc6-46c6-a8b0-a48450a9a150"],

Cell[TextData[StyleBox["Accuracy Testing Function",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.7393123433316035`*^9, 
  3.7393123548059053`*^9}},ExpressionUUID->"6b5ccc40-3340-430e-a62a-\
79f850841281"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "testnum_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
          "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"netEvaluate", "[", 
           RowBox[{"net", ",", " ", 
            RowBox[{"input", "[", 
             RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "\"\<Test\>\""}],
            "]"}], "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"target", "[", 
          RowBox[{"[", "testnum", "]"}], "]"}], ",", " ", "1"}], "]"}], " ", 
       "-", " ", "1"}]}], "}"}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"accTest", "[", 
    RowBox[{
    "net_", ",", " ", "input_", ",", " ", "target_", ",", " ", "numTest_"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"y", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", " ", 
        RowBox[{"x", "\[LessEqual]", "numTest"}], ",", " ", 
        RowBox[{"x", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"netEvaluate", "[", 
              RowBox[{"net", ",", " ", 
               RowBox[{"input", "[", 
                RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
              "]"}], ",", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"netEvaluate", "[", 
               RowBox[{"net", ",", " ", 
                RowBox[{"input", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", " ", "\"\<Test\>\""}], 
               "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"target", "[", 
              RowBox[{"[", "x", "]"}], "]"}], ",", " ", "1"}], "]"}]}], " ", 
          ",", 
          RowBox[{"y", "++"}]}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"y", "/", "numTest"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"aaa9ac0f-a8f4-41b7-9a4a-f2c1a5ced328"],

Cell[TextData[StyleBox["Network run function ",
 FontWeight->"Bold"]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.7393045475686083`*^9, 
  3.7393045572367325`*^9}},ExpressionUUID->"98c1ec76-5d58-410d-bcaa-\
9ece3991bcd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runNet", "[", 
   RowBox[{
   "input_", ",", " ", "target_", ",", " ", "testinp_", ",", " ", 
    "testtar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iteration", ",", " ", "fullnet", ",", " ", "w0", ",", " ", "w1", ",", 
      " ", "w2", ",", "l3M", ",", " ", "l3V", ",", " ", "l2M", ",", " ", 
      "l1M", ",", " ", "l2V", ",", " ", "l1V", ",", "\[IndentingNewLine]", 
      "l3Error", ",", " ", "l3Delta", ",", "l2Error", ",", " ", "l2Delta", 
      ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g1", ",", " ", 
      "g0", ",", " ", "l0", ",", " ", "l1", ",", " ", "l2", ",", "l3", ",", 
      " ", "l1MC", ",", " ", "l1VC", ",", " ", "l2MC", ",", " ", "l2VC", ",", 
      " ", "l3MC", ",", " ", "l3VC", ",", " ", "w2UDT", ",", " ", "w1UDT", 
      ",", " ", "w0UDT", ",", " ", "epoch"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
      RowBox[{"initializeWeights", "[", 
       RowBox[{"hiddennodes1", ",", " ", "hiddennodes2", ",", " ", "10"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"epoch", " ", "=", " ", "epochs"}], ";", "\[IndentingNewLine]", 
     RowBox[{"l3M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l3V", " ", "=", " ", "0"}], ";", 
     RowBox[{"l2M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1M", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l2V", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"l1V", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Iterator", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iteration", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"iteration", "\[LessEqual]", " ", "iterations"}], ",", " ", 
       RowBox[{"iteration", "+=", "batchsize"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "iteration", " ", "ends", " ", "and", " ", "epoch", " ", 
          "isnt", " ", "0"}], ",", " ", 
         RowBox[{"reset", " ", "iteration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"iteration", " ", "\[GreaterEqual]", " ", 
             RowBox[{"iterations", " ", "-", " ", "32"}]}], ",", " ", 
            RowBox[{"epoch", "\[GreaterEqual]", "1"}]}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"iteration", "=", "1"}], ";", " ", 
           RowBox[{"epoch", "-=", "1"}], ";", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Epoch: \>\"", "epoch"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Train Accuracy\>\"", 
             StyleBox[
              RowBox[{"N", "[", 
               RowBox[{"accTest", "[", 
                RowBox[{
                "net", ",", " ", "input", ",", " ", "target", ",", " ", 
                 "600"}], "]"}], "]"}],
              FontWeight->"Bold"]}], 
            StyleBox["]",
             FontWeight->"Bold"]}], 
           StyleBox[";",
            FontWeight->"Bold"], 
           StyleBox["\[IndentingNewLine]",
            FontWeight->"Bold"], 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Test Accuracy\>\"", 
             RowBox[{"N", "[", 
              RowBox[{"accTest", "[", 
               RowBox[{
               "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", 
                "100"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "net", " ", "weights"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"net", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w0"}], "|>"}]}]}], 
            "|>"}], ",", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], 
            "|>"}], ",", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], 
           ",", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], 
             ",", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], 
            "|>"}], ",", " ", 
           RowBox[{"<|", 
            RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], 
            "|>"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Evaluate", " ", "the", " ", "net"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"fullnet", " ", "=", " ", 
         RowBox[{"netEvaluate", "[", 
          RowBox[{"net", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "\"\<Training\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Back", " ", "prop"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "w0", ",", " ", "w1", ",", "w2", ",", " ", "l3M", ",", " ", "l3V", 
           ",", " ", "l2M", ",", " ", "l1M", ",", " ", "l2V", ",", " ", 
           "l1V"}], "}"}], " ", "=", " ", 
         RowBox[{"backProp", "[", 
          RowBox[{
          "fullnet", ",", " ", "w0", ",", " ", "w1", ",", " ", "w2", ",", " ", 
           RowBox[{"input", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"target", "[", 
            RowBox[{"[", 
             RowBox[{"iteration", ";;", 
              RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], ",", 
           " ", "l3M", ",", " ", "l3V", ",", "  ", "l2M", ",", " ", "l1M", 
           ",", " ", "l2V", ",", " ", "l1V", ",", " ", "iteration"}], "]"}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7392363408492002`*^9, 3.7392363867800283`*^9}, {
   3.7392365865210133`*^9, 3.73923658848264*^9}, 3.7392366291642575`*^9, {
   3.739236925745397*^9, 3.739236937152893*^9}, {3.739237607153409*^9, 
   3.739237665379557*^9}, {3.739237733059107*^9, 3.739237767879955*^9}, {
   3.7392380634746037`*^9, 3.739238070878793*^9}, {3.739238257701231*^9, 
   3.739238262335826*^9}, {3.739238742688015*^9, 3.7392387559714756`*^9}, {
   3.739238926006117*^9, 3.7392389302657194`*^9}, 3.7392390215943956`*^9, {
   3.7392390723416424`*^9, 3.7392390836713223`*^9}, {3.739241241916684*^9, 
   3.739241242714183*^9}, {3.7392415185423965`*^9, 3.739241553774172*^9}, {
   3.7392419184089336`*^9, 3.7392419250601397`*^9}, {3.7392422600562005`*^9, 
   3.73924228676873*^9}, {3.739242378189143*^9, 3.73924237875663*^9}, {
   3.739242561888676*^9, 3.7392426180869293`*^9}, {3.739244419722472*^9, 
   3.7392444773060317`*^9}, {3.7392445607000127`*^9, 3.739244613605179*^9}, {
   3.7392450640716686`*^9, 3.73924506911318*^9}, 3.7392458862191114`*^9, {
   3.73924632398831*^9, 3.7392463474824514`*^9}, {3.739246393626996*^9, 
   3.73924641462183*^9}, {3.7392464536992764`*^9, 3.739246476752174*^9}, {
   3.7392466298854237`*^9, 3.739246642339104*^9}, {3.7392467318184905`*^9, 
   3.7392467318913097`*^9}, {3.7392468520757403`*^9, 
   3.7392468860797653`*^9}, {3.7392469542553654`*^9, 
   3.7392469574677696`*^9}, {3.739247075680499*^9, 3.7392470893766675`*^9}, {
   3.7392471659065733`*^9, 3.7392472130578394`*^9}, 3.739247289621503*^9, {
   3.7392473538726034`*^9, 3.7392473638907995`*^9}, {3.7392474319566946`*^9, 
   3.7392474681249437`*^9}, {3.73924752647501*^9, 3.739247537797717*^9}, {
   3.739247676137025*^9, 3.739247681880677*^9}, {3.7392478898182535`*^9, 
   3.739247893832539*^9}, 3.739248013342771*^9, {3.7392864467711277`*^9, 
   3.7392864492529197`*^9}, {3.739287283270381*^9, 3.7392873276172895`*^9}, {
   3.7392875826768913`*^9, 3.7392875942878246`*^9}, {3.73928795490217*^9, 
   3.7392879578014126`*^9}, {3.7392881620058794`*^9, 
   3.7392881624965687`*^9}, {3.7393070205063076`*^9, 
   3.7393071161952796`*^9}, {3.7393081570890365`*^9, 
   3.7393081725407114`*^9}, {3.7393082171084585`*^9, 3.739308282308022*^9}, {
   3.7393083478446856`*^9, 3.739308359737896*^9}, {3.73930850099492*^9, 
   3.739308505946677*^9}, {3.739309021979652*^9, 3.7393090255994763`*^9}, 
   3.7393121251214123`*^9, {3.7393123649038887`*^9, 3.7393124637903233`*^9}, 
   3.7393125652588506`*^9, {3.739312636641865*^9, 3.739312669918379*^9}, {
   3.7393130275392075`*^9, 3.739313028363988*^9}, {3.739313314664566*^9, 
   3.739313359016919*^9}, {3.7393134107593603`*^9, 3.7393134121296935`*^9}, {
   3.7393179716842537`*^9, 3.7393180511657515`*^9}, {3.739318109042345*^9, 
   3.7393181336752887`*^9}, {3.7393181655494156`*^9, 3.73931824355472*^9}, {
   3.7393190662417364`*^9, 3.739319066689536*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"d3dcc3b0-4425-4353-824c-a85d9cc7fa60"],

Cell[TextData[StyleBox["Run the network training",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.7393064598495255`*^9, 
  3.739306473208601*^9}},ExpressionUUID->"ea490282-5365-4727-836e-\
49494aaaa5fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}], " ", "=", " ", 
   RowBox[{"runNet", "[", 
    RowBox[{
    "input", ",", " ", "target", ",", " ", "testinp", ",", " ", "testtar"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739244353617196*^9, 3.7392443690823946`*^9}, {
   3.7392451932281203`*^9, 3.7392452182382045`*^9}, {3.739247896108428*^9, 
   3.7392478980113316`*^9}, {3.739307996298222*^9, 3.739307996563512*^9}, {
   3.739312617518034*^9, 3.7393126344108343`*^9}, {3.7393127949891553`*^9, 
   3.7393128420392756`*^9}, {3.739312888985673*^9, 3.7393129360150614`*^9}, {
   3.739312999542099*^9, 3.7393130115509872`*^9}, {3.739316582112939*^9, 
   3.7393165834398503`*^9}, {3.7393182450393505`*^9, 3.739318245415468*^9}, 
   3.7393189121151857`*^9, {3.7393189651213803`*^9, 3.739318968965992*^9}, 
   3.739319070139306*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"c0210360-d29b-4f55-8ca9-a00c75de4916"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"4", " ", "\<\"Epoch: \"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.739319248517066*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"ba5be226-9bc7-4999-9ffb-f5ed3e4433d5"],

Cell[BoxData[
 RowBox[{"0.9316666666666666`", " ", "\<\"Train Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192485808954`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"00d40b55-f1f2-4f44-bdb8-d7517cc79a96"],

Cell[BoxData[
 RowBox[{"0.91`", " ", "\<\"Test Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192485928626`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"26fd0a1d-f21e-4aef-8ee3-0ba0085b50c0"],

Cell[BoxData[
 RowBox[{"3", " ", "\<\"Epoch: \"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192516277437`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"54ced85e-2f13-4413-bab4-1a45ad8eff20"],

Cell[BoxData[
 RowBox[{"0.9333333333333333`", " ", "\<\"Train Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.739319251700549*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"634bd97b-1ece-429f-877c-a13abc145cd7"],

Cell[BoxData[
 RowBox[{"0.91`", " ", "\<\"Test Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192517424383`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"86e4b433-ffcd-43c8-8fe9-70709ea5176e"],

Cell[BoxData[
 RowBox[{"2", " ", "\<\"Epoch: \"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192552557826`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"3223d045-996f-4005-951f-0f2c41e03c23"],

Cell[BoxData[
 RowBox[{"0.9316666666666666`", " ", "\<\"Train Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192553744645`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"51138c78-21df-4d5d-a6f1-a10653afd3bc"],

Cell[BoxData[
 RowBox[{"0.92`", " ", "\<\"Test Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.739319255427325*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"4ffae6b4-bdf0-46bd-9432-59d1bec4bb06"],

Cell[BoxData["\<\"Epoch: \"\>"], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.739319259791647*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"16677b58-5a9d-463e-b034-09d1221dec58"],

Cell[BoxData[
 RowBox[{"0.9366666666666666`", " ", "\<\"Train Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192599442453`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"7546be9a-a4f2-47aa-b39e-3cdd18df4bbb"],

Cell[BoxData[
 RowBox[{"0.92`", " ", "\<\"Test Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192600030823`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"da1cdcdb-5d60-4c0a-b9d0-199d256f4589"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192637399807`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"c68dbae0-306c-42a0-92fb-c2365fc7618f"],

Cell[BoxData[
 RowBox[{"0.9416666666666667`", " ", "\<\"Train Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.7393192638140526`*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"0492dda0-fe81-46ff-9b70-85d1cb7d0db5"],

Cell[BoxData[
 RowBox[{"0.92`", " ", "\<\"Test Accuracy\"\>"}]], "Print",
 CellChangeTimes->{3.739319024283989*^9, 3.739319263853677*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"90d8682c-44c5-43c8-bf45-5f1f454b1a90"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"net", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w0"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w2"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7393182621915646`*^9, 3.7393182649233074`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"fb80969d-ac6d-40a8-9c66-bda3ee36f278"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"N", "[", 
   RowBox[{"accTest", "[", 
    RowBox[{"net", ",", " ", "input", ",", " ", "target", ",", " ", "60000"}],
     "]"}], "]"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"accTest", "[", 
   RowBox[{
   "net", ",", " ", "testinp", ",", " ", "testtar", ",", " ", "10000"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.739308079939464*^9, 3.7393080905450706`*^9}, {
  3.739308688110899*^9, 3.739308689335622*^9}, {3.739312268907745*^9, 
  3.7393122707039146`*^9}, {3.739312701290409*^9, 3.7393127071916447`*^9}, {
  3.7393167227556887`*^9, 3.7393167282711325`*^9}, {3.739316771227029*^9, 
  3.7393167727201605`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"dc47d267-fc6a-40ba-91c5-9b7943ce64e6"],

Cell[BoxData["0.8996833333333333`"], "Output",
 CellChangeTimes->{3.739319064227123*^9, 3.739319291161935*^9, 
  3.739319991597524*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"6f14772c-6948-4e70-b617-4cf9abdb7a61"],

Cell[BoxData["0.9026`"], "Output",
 CellChangeTimes->{3.739319064227123*^9, 3.739319291161935*^9, 
  3.739319992736494*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"97dd0db3-ebb7-43ff-90d4-1c2f94ac32e4"]
}, Open  ]],

Cell[TextData[StyleBox["MNIST weight saver",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.739316683190319*^9, 
  3.739316690411951*^9}},ExpressionUUID->"4bd00ddd-b685-4546-8e04-\
039346f4467a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<MNISTweights2.dat\>\"", ",", " ", 
   RowBox[{"{", 
    RowBox[{"w0", ",", " ", "w1", ",", " ", "w2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73931435614415*^9, 3.739314375779415*^9}, {
  3.739314427238635*^9, 3.7393144282519317`*^9}, {3.739314469708907*^9, 
  3.739314487170186*^9}, {3.7393146366997824`*^9, 3.7393146430130453`*^9}, {
  3.739314685446518*^9, 3.739314685753707*^9}, {3.7393200155519657`*^9, 
  3.7393200197130423`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"9504277c-5a5b-4938-bb5f-c3e0b929fc2c"],

Cell[BoxData["\<\"MNISTweights2.dat\"\>"], "Output",
 CellChangeTimes->{{3.7393146810553007`*^9, 3.7393146939397945`*^9}, 
   3.7393200224071608`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"ea6c550a-c7fd-4b7a-bedd-07c87e271617"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", "BACKPROP", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"l2Error", " ", "=", " ", 
    RowBox[{
     RowBox[{"fullnet", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], " ", "-", " ", 
     RowBox[{"target", "[", 
      RowBox[{"[", 
       RowBox[{"iteration", ";;", 
        RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"l2Delta", " ", "=", " ", 
    RowBox[{"l2Error", "*", 
     RowBox[{"sigmDeriv", "[", 
      RowBox[{"fullnet", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"l1Error", " ", "=", 
    RowBox[{"Dot", "[", 
     RowBox[{"l2Delta", ",", " ", 
      RowBox[{"Transpose", "[", "w1", "]"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"l1Delta", " ", "=", " ", 
    RowBox[{"l1Error", "*", 
     RowBox[{"rampDeriv", "[", 
      RowBox[{"fullnet", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"g1", " ", "=", " ", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"fullnet", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", " ", "l2Delta"}], "]"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{"g0", " ", "=", " ", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"input", "[", 
        RowBox[{"[", 
         RowBox[{"iteration", ";;", 
          RowBox[{"iteration", "+", "batchsize"}]}], "]"}], "]"}], "]"}], ",",
       " ", "l1Delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"l2M", " ", "=", " ", 
    RowBox[{
     RowBox[{"l2M", "*", "b1"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"l1M", " ", "=", " ", 
    RowBox[{
     RowBox[{"l1M", "*", "b2"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "b2"}], ")"}], "*", "g0"}]}]}], ";", "\t\t\t\t\t\t", 
   "\[IndentingNewLine]", 
   RowBox[{"l2V", " ", "=", " ", 
    RowBox[{
     RowBox[{"l2V", "*", "b2"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "b2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", 
   "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
   RowBox[{"l1V", " ", "=", " ", 
    RowBox[{
     RowBox[{"l1V", "*", "b1"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "b1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", 
   "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
   RowBox[{"l1MC", " ", "=", " ", 
    RowBox[{"l1M", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
   RowBox[{"l1VC", " ", "=", " ", 
    RowBox[{"l1V", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"b1", "^", "iteration"}]}], ")"}]}]}], ";", 
   "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
   RowBox[{"l2MC", " ", "=", " ", 
    RowBox[{"l2M", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", " ", 
   RowBox[{"l2VC", " ", "=", " ", 
    RowBox[{"l2V", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"b2", "^", "iteration"}]}], ")"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"w1UDT", " ", "=", 
    RowBox[{"l2MC", "/", 
     RowBox[{"(", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", " ", 
   RowBox[{"w0UDT", " ", "=", " ", 
    RowBox[{"l1MC", "/", 
     RowBox[{"(", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], ";", 
   "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
   RowBox[{"w1", " ", "-=", " ", 
    RowBox[{"learningrate", "*", "w1UDT"}]}], ";", 
   "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", 
   RowBox[{"w0", " ", "-=", " ", 
    RowBox[{"learningrate", "*", "w0UDT"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7392875871788464`*^9, 
  3.7392875888713193`*^9}},ExpressionUUID->"8da884ae-e129-42e5-857d-\
e538e8403f2d"]
},
WindowSize->{958, 1028},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 7, 2018)",
StyleDefinitions->"ReverseColor.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 231, 5, 29, "Text",ExpressionUUID->"77287d3d-7365-4466-95f3-f241c698909e",
 InitializationCell->True],
Cell[795, 27, 4700, 117, 225, "Input",ExpressionUUID->"7829bba4-9f62-4f5f-b7cb-a2e4b0bba986"],
Cell[5498, 146, 247, 5, 29, "Text",ExpressionUUID->"2fe03ec4-bfa0-4631-8431-2718c2566419",
 InitializationCell->True],
Cell[5748, 153, 3098, 72, 171, "Input",ExpressionUUID->"9a01a0fc-7e26-4087-a77e-a5c55034816b"],
Cell[8849, 227, 236, 5, 29, "Text",ExpressionUUID->"4074f893-e235-4a02-8fd0-a9d7d84d137a",
 InitializationCell->True],
Cell[9088, 234, 2400, 46, 207, "Input",ExpressionUUID->"77c19d7a-ce8d-427d-81f6-6fcb70a24b02"],
Cell[11491, 282, 229, 5, 29, "Text",ExpressionUUID->"15637985-9ebe-4862-bef1-39105b6f318b",
 InitializationCell->True],
Cell[11723, 289, 565, 14, 45, "Input",ExpressionUUID->"77d270d1-b953-461c-9bad-eb44c7207587"],
Cell[12291, 305, 211, 4, 29, "Text",ExpressionUUID->"983f4c0f-90e6-47b6-9729-192cdc1c771f"],
Cell[12505, 311, 2455, 62, 117, "Input",ExpressionUUID->"57345bbf-7009-4430-990a-36c88888c09e"],
Cell[14963, 375, 298, 6, 29, "Text",ExpressionUUID->"02e73b2e-3618-4197-b4d0-e8b6a42d535a"],
Cell[15264, 383, 10202, 227, 657, "Input",ExpressionUUID->"0b01139e-8fc6-46c6-a8b0-a48450a9a150"],
Cell[25469, 612, 212, 4, 29, "Text",ExpressionUUID->"6b5ccc40-3340-430e-a62a-79f850841281"],
Cell[25684, 618, 2677, 71, 153, "Input",ExpressionUUID->"aaa9ac0f-a8f4-41b7-9a4a-f2c1a5ced328"],
Cell[28364, 691, 235, 5, 29, "Text",ExpressionUUID->"98c1ec76-5d58-410d-bcaa-9ece3991bcd4",
 InitializationCell->True],
Cell[28602, 698, 10168, 205, 531, "Input",ExpressionUUID->"d3dcc3b0-4425-4353-824c-a85d9cc7fa60"],
Cell[38773, 905, 209, 4, 29, "Text",ExpressionUUID->"ea490282-5365-4727-836e-49494aaaa5fa"],
Cell[CellGroupData[{
Cell[39007, 913, 981, 18, 26, "Input",ExpressionUUID->"c0210360-d29b-4f55-8ca9-a00c75de4916"],
Cell[CellGroupData[{
Cell[40013, 935, 232, 5, 21, "Print",ExpressionUUID->"ba5be226-9bc7-4999-9ffb-f5ed3e4433d5"],
Cell[40248, 942, 259, 5, 21, "Print",ExpressionUUID->"00d40b55-f1f2-4f44-bdb8-d7517cc79a96"],
Cell[40510, 949, 244, 5, 21, "Print",ExpressionUUID->"26fd0a1d-f21e-4aef-8ee3-0ba0085b50c0"],
Cell[40757, 956, 234, 5, 21, "Print",ExpressionUUID->"54ced85e-2f13-4413-bab4-1a45ad8eff20"],
Cell[40994, 963, 257, 5, 21, "Print",ExpressionUUID->"634bd97b-1ece-429f-877c-a13abc145cd7"],
Cell[41254, 970, 244, 5, 21, "Print",ExpressionUUID->"86e4b433-ffcd-43c8-8fe9-70709ea5176e"],
Cell[41501, 977, 234, 5, 21, "Print",ExpressionUUID->"3223d045-996f-4005-951f-0f2c41e03c23"],
Cell[41738, 984, 259, 5, 21, "Print",ExpressionUUID->"51138c78-21df-4d5d-a6f1-a10653afd3bc"],
Cell[42000, 991, 242, 5, 21, "Print",ExpressionUUID->"4ffae6b4-bdf0-46bd-9432-59d1bec4bb06"],
Cell[42245, 998, 210, 4, 21, "Print",ExpressionUUID->"16677b58-5a9d-463e-b034-09d1221dec58"],
Cell[42458, 1004, 259, 5, 21, "Print",ExpressionUUID->"7546be9a-a4f2-47aa-b39e-3cdd18df4bbb"],
Cell[42720, 1011, 244, 5, 21, "Print",ExpressionUUID->"da1cdcdb-5d60-4c0a-b9d0-199d256f4589"],
Cell[42967, 1018, 198, 4, 21, "Print",ExpressionUUID->"c68dbae0-306c-42a0-92fb-c2365fc7618f"],
Cell[43168, 1024, 259, 5, 21, "Print",ExpressionUUID->"0492dda0-fe81-46ff-9b70-85d1cb7d0db5"],
Cell[43430, 1031, 242, 5, 21, "Print",ExpressionUUID->"90d8682c-44c5-43c8-bf45-5f1f454b1a90"]
}, Open  ]]
}, Open  ]],
Cell[43699, 1040, 1380, 34, 63, "Input",ExpressionUUID->"fb80969d-ac6d-40a8-9c66-bda3ee36f278"],
Cell[CellGroupData[{
Cell[45104, 1078, 779, 17, 45, "Input",ExpressionUUID->"dc47d267-fc6a-40ba-91c5-9b7943ce64e6"],
Cell[45886, 1097, 214, 3, 30, "Output",ExpressionUUID->"6f14772c-6948-4e70-b617-4cf9abdb7a61"],
Cell[46103, 1102, 202, 3, 30, "Output",ExpressionUUID->"97dd0db3-ebb7-43ff-90d4-1c2f94ac32e4"]
}, Open  ]],
Cell[46320, 1108, 201, 4, 29, "Text",ExpressionUUID->"4bd00ddd-b685-4546-8e04-039346f4467a"],
Cell[CellGroupData[{
Cell[46546, 1116, 579, 10, 26, "Input",ExpressionUUID->"9504277c-5a5b-4938-bb5f-c3e0b929fc2c"],
Cell[47128, 1128, 229, 3, 30, "Output",ExpressionUUID->"ea6c550a-c7fd-4b7a-bedd-07c87e271617"]
}, Open  ]],
Cell[47372, 1134, 4266, 119, 297, "Input",ExpressionUUID->"8da884ae-e129-42e5-857d-e538e8403f2d"]
}
]
*)

